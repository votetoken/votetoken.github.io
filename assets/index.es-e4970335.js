import{M as Oi,N as G_,O as Ai,K as sd,_ as Y_}from"./index-6e351ba0.js";import{e as Lr,D as nu}from"./events-b4d182c4.js";import{r as J_,a as Zi}from"./web3-onboard-fe8d8ca3.js";import{r as Vr,s as su,a as au,d as ou,f as Fa,g as cu,c as X_,b as $a,e as ad,h as uu}from"./index-ff129a22.js";import"./chunk-OKULXQAF-9d6395fb.js";import"./tslib.es6-1af2eb8c.js";let Q_=class{};class Z_ extends Q_{constructor(){super()}}class em extends Z_{constructor(t){super()}}const tm="^https?:",rm="^wss?:";function im(n){const t=n.match(new RegExp(/^\w+:/,"gi"));if(!(!t||!t.length))return t[0]}function od(n,t){const r=im(n);return typeof r>"u"?!1:new RegExp(t).test(r)}function Pf(n){return od(n,tm)}function Tf(n){return od(n,rm)}function nm(n){return new RegExp("wss?://localhost(:d{2,5})?").test(n)}function cd(n){return typeof n=="object"&&"id"in n&&"jsonrpc"in n&&n.jsonrpc==="2.0"}function hu(n){return cd(n)&&"method"in n}function La(n){return cd(n)&&(pi(n)||Kr(n))}function pi(n){return"result"in n}function Kr(n){return"error"in n}var fu={},Ma={},$e={},ud={};(function(n){Object.defineProperty(n,"__esModule",{value:!0});function t(l,w){var O=l>>>16&65535,I=l&65535,N=w>>>16&65535,j=w&65535;return I*j+(O*j+I*N<<16>>>0)|0}n.mul=Math.imul||t;function r(l,w){return l+w|0}n.add=r;function s(l,w){return l-w|0}n.sub=s;function o(l,w){return l<<w|l>>>32-w}n.rotl=o;function f(l,w){return l<<32-w|l>>>w}n.rotr=f;function m(l){return typeof l=="number"&&isFinite(l)&&Math.floor(l)===l}n.isInteger=Number.isInteger||m,n.MAX_SAFE_INTEGER=9007199254740991,n.isSafeInteger=function(l){return n.isInteger(l)&&l>=-n.MAX_SAFE_INTEGER&&l<=n.MAX_SAFE_INTEGER}})(ud);Object.defineProperty($e,"__esModule",{value:!0});var hd=ud;function sm(n,t){return t===void 0&&(t=0),(n[t+0]<<8|n[t+1])<<16>>16}$e.readInt16BE=sm;function am(n,t){return t===void 0&&(t=0),(n[t+0]<<8|n[t+1])>>>0}$e.readUint16BE=am;function om(n,t){return t===void 0&&(t=0),(n[t+1]<<8|n[t])<<16>>16}$e.readInt16LE=om;function cm(n,t){return t===void 0&&(t=0),(n[t+1]<<8|n[t])>>>0}$e.readUint16LE=cm;function fd(n,t,r){return t===void 0&&(t=new Uint8Array(2)),r===void 0&&(r=0),t[r+0]=n>>>8,t[r+1]=n>>>0,t}$e.writeUint16BE=fd;$e.writeInt16BE=fd;function ld(n,t,r){return t===void 0&&(t=new Uint8Array(2)),r===void 0&&(r=0),t[r+0]=n>>>0,t[r+1]=n>>>8,t}$e.writeUint16LE=ld;$e.writeInt16LE=ld;function jc(n,t){return t===void 0&&(t=0),n[t]<<24|n[t+1]<<16|n[t+2]<<8|n[t+3]}$e.readInt32BE=jc;function qc(n,t){return t===void 0&&(t=0),(n[t]<<24|n[t+1]<<16|n[t+2]<<8|n[t+3])>>>0}$e.readUint32BE=qc;function Bc(n,t){return t===void 0&&(t=0),n[t+3]<<24|n[t+2]<<16|n[t+1]<<8|n[t]}$e.readInt32LE=Bc;function zc(n,t){return t===void 0&&(t=0),(n[t+3]<<24|n[t+2]<<16|n[t+1]<<8|n[t])>>>0}$e.readUint32LE=zc;function Ca(n,t,r){return t===void 0&&(t=new Uint8Array(4)),r===void 0&&(r=0),t[r+0]=n>>>24,t[r+1]=n>>>16,t[r+2]=n>>>8,t[r+3]=n>>>0,t}$e.writeUint32BE=Ca;$e.writeInt32BE=Ca;function Pa(n,t,r){return t===void 0&&(t=new Uint8Array(4)),r===void 0&&(r=0),t[r+0]=n>>>0,t[r+1]=n>>>8,t[r+2]=n>>>16,t[r+3]=n>>>24,t}$e.writeUint32LE=Pa;$e.writeInt32LE=Pa;function um(n,t){t===void 0&&(t=0);var r=jc(n,t),s=jc(n,t+4);return r*4294967296+s-(s>>31)*4294967296}$e.readInt64BE=um;function hm(n,t){t===void 0&&(t=0);var r=qc(n,t),s=qc(n,t+4);return r*4294967296+s}$e.readUint64BE=hm;function fm(n,t){t===void 0&&(t=0);var r=Bc(n,t),s=Bc(n,t+4);return s*4294967296+r-(r>>31)*4294967296}$e.readInt64LE=fm;function lm(n,t){t===void 0&&(t=0);var r=zc(n,t),s=zc(n,t+4);return s*4294967296+r}$e.readUint64LE=lm;function dd(n,t,r){return t===void 0&&(t=new Uint8Array(8)),r===void 0&&(r=0),Ca(n/4294967296>>>0,t,r),Ca(n>>>0,t,r+4),t}$e.writeUint64BE=dd;$e.writeInt64BE=dd;function pd(n,t,r){return t===void 0&&(t=new Uint8Array(8)),r===void 0&&(r=0),Pa(n>>>0,t,r),Pa(n/4294967296>>>0,t,r+4),t}$e.writeUint64LE=pd;$e.writeInt64LE=pd;function dm(n,t,r){if(r===void 0&&(r=0),n%8!==0)throw new Error("readUintBE supports only bitLengths divisible by 8");if(n/8>t.length-r)throw new Error("readUintBE: array is too short for the given bitLength");for(var s=0,o=1,f=n/8+r-1;f>=r;f--)s+=t[f]*o,o*=256;return s}$e.readUintBE=dm;function pm(n,t,r){if(r===void 0&&(r=0),n%8!==0)throw new Error("readUintLE supports only bitLengths divisible by 8");if(n/8>t.length-r)throw new Error("readUintLE: array is too short for the given bitLength");for(var s=0,o=1,f=r;f<r+n/8;f++)s+=t[f]*o,o*=256;return s}$e.readUintLE=pm;function gm(n,t,r,s){if(r===void 0&&(r=new Uint8Array(n/8)),s===void 0&&(s=0),n%8!==0)throw new Error("writeUintBE supports only bitLengths divisible by 8");if(!hd.isSafeInteger(t))throw new Error("writeUintBE value must be an integer");for(var o=1,f=n/8+s-1;f>=s;f--)r[f]=t/o&255,o*=256;return r}$e.writeUintBE=gm;function ym(n,t,r,s){if(r===void 0&&(r=new Uint8Array(n/8)),s===void 0&&(s=0),n%8!==0)throw new Error("writeUintLE supports only bitLengths divisible by 8");if(!hd.isSafeInteger(t))throw new Error("writeUintLE value must be an integer");for(var o=1,f=s;f<s+n/8;f++)r[f]=t/o&255,o*=256;return r}$e.writeUintLE=ym;function vm(n,t){t===void 0&&(t=0);var r=new DataView(n.buffer,n.byteOffset,n.byteLength);return r.getFloat32(t)}$e.readFloat32BE=vm;function _m(n,t){t===void 0&&(t=0);var r=new DataView(n.buffer,n.byteOffset,n.byteLength);return r.getFloat32(t,!0)}$e.readFloat32LE=_m;function mm(n,t){t===void 0&&(t=0);var r=new DataView(n.buffer,n.byteOffset,n.byteLength);return r.getFloat64(t)}$e.readFloat64BE=mm;function bm(n,t){t===void 0&&(t=0);var r=new DataView(n.buffer,n.byteOffset,n.byteLength);return r.getFloat64(t,!0)}$e.readFloat64LE=bm;function wm(n,t,r){t===void 0&&(t=new Uint8Array(4)),r===void 0&&(r=0);var s=new DataView(t.buffer,t.byteOffset,t.byteLength);return s.setFloat32(r,n),t}$e.writeFloat32BE=wm;function Em(n,t,r){t===void 0&&(t=new Uint8Array(4)),r===void 0&&(r=0);var s=new DataView(t.buffer,t.byteOffset,t.byteLength);return s.setFloat32(r,n,!0),t}$e.writeFloat32LE=Em;function Dm(n,t,r){t===void 0&&(t=new Uint8Array(8)),r===void 0&&(r=0);var s=new DataView(t.buffer,t.byteOffset,t.byteLength);return s.setFloat64(r,n),t}$e.writeFloat64BE=Dm;function Sm(n,t,r){t===void 0&&(t=new Uint8Array(8)),r===void 0&&(r=0);var s=new DataView(t.buffer,t.byteOffset,t.byteLength);return s.setFloat64(r,n,!0),t}$e.writeFloat64LE=Sm;var Sr={};Object.defineProperty(Sr,"__esModule",{value:!0});function Im(n){for(var t=0;t<n.length;t++)n[t]=0;return n}Sr.wipe=Im;Object.defineProperty(Ma,"__esModule",{value:!0});var Zt=$e,Hc=Sr,xm=20;function Om(n,t,r){for(var s=1634760805,o=857760878,f=2036477234,m=1797285236,l=r[3]<<24|r[2]<<16|r[1]<<8|r[0],w=r[7]<<24|r[6]<<16|r[5]<<8|r[4],O=r[11]<<24|r[10]<<16|r[9]<<8|r[8],I=r[15]<<24|r[14]<<16|r[13]<<8|r[12],N=r[19]<<24|r[18]<<16|r[17]<<8|r[16],j=r[23]<<24|r[22]<<16|r[21]<<8|r[20],R=r[27]<<24|r[26]<<16|r[25]<<8|r[24],U=r[31]<<24|r[30]<<16|r[29]<<8|r[28],H=t[3]<<24|t[2]<<16|t[1]<<8|t[0],K=t[7]<<24|t[6]<<16|t[5]<<8|t[4],ie=t[11]<<24|t[10]<<16|t[9]<<8|t[8],p=t[15]<<24|t[14]<<16|t[13]<<8|t[12],b=s,y=o,_=f,d=m,c=l,v=w,z=O,G=I,se=N,ce=j,de=R,S=U,C=H,ee=K,X=ie,k=p,W=0;W<xm;W+=2)b=b+c|0,C^=b,C=C>>>32-16|C<<16,se=se+C|0,c^=se,c=c>>>32-12|c<<12,y=y+v|0,ee^=y,ee=ee>>>32-16|ee<<16,ce=ce+ee|0,v^=ce,v=v>>>32-12|v<<12,_=_+z|0,X^=_,X=X>>>32-16|X<<16,de=de+X|0,z^=de,z=z>>>32-12|z<<12,d=d+G|0,k^=d,k=k>>>32-16|k<<16,S=S+k|0,G^=S,G=G>>>32-12|G<<12,_=_+z|0,X^=_,X=X>>>32-8|X<<8,de=de+X|0,z^=de,z=z>>>32-7|z<<7,d=d+G|0,k^=d,k=k>>>32-8|k<<8,S=S+k|0,G^=S,G=G>>>32-7|G<<7,y=y+v|0,ee^=y,ee=ee>>>32-8|ee<<8,ce=ce+ee|0,v^=ce,v=v>>>32-7|v<<7,b=b+c|0,C^=b,C=C>>>32-8|C<<8,se=se+C|0,c^=se,c=c>>>32-7|c<<7,b=b+v|0,k^=b,k=k>>>32-16|k<<16,de=de+k|0,v^=de,v=v>>>32-12|v<<12,y=y+z|0,C^=y,C=C>>>32-16|C<<16,S=S+C|0,z^=S,z=z>>>32-12|z<<12,_=_+G|0,ee^=_,ee=ee>>>32-16|ee<<16,se=se+ee|0,G^=se,G=G>>>32-12|G<<12,d=d+c|0,X^=d,X=X>>>32-16|X<<16,ce=ce+X|0,c^=ce,c=c>>>32-12|c<<12,_=_+G|0,ee^=_,ee=ee>>>32-8|ee<<8,se=se+ee|0,G^=se,G=G>>>32-7|G<<7,d=d+c|0,X^=d,X=X>>>32-8|X<<8,ce=ce+X|0,c^=ce,c=c>>>32-7|c<<7,y=y+z|0,C^=y,C=C>>>32-8|C<<8,S=S+C|0,z^=S,z=z>>>32-7|z<<7,b=b+v|0,k^=b,k=k>>>32-8|k<<8,de=de+k|0,v^=de,v=v>>>32-7|v<<7;Zt.writeUint32LE(b+s|0,n,0),Zt.writeUint32LE(y+o|0,n,4),Zt.writeUint32LE(_+f|0,n,8),Zt.writeUint32LE(d+m|0,n,12),Zt.writeUint32LE(c+l|0,n,16),Zt.writeUint32LE(v+w|0,n,20),Zt.writeUint32LE(z+O|0,n,24),Zt.writeUint32LE(G+I|0,n,28),Zt.writeUint32LE(se+N|0,n,32),Zt.writeUint32LE(ce+j|0,n,36),Zt.writeUint32LE(de+R|0,n,40),Zt.writeUint32LE(S+U|0,n,44),Zt.writeUint32LE(C+H|0,n,48),Zt.writeUint32LE(ee+K|0,n,52),Zt.writeUint32LE(X+ie|0,n,56),Zt.writeUint32LE(k+p|0,n,60)}function gd(n,t,r,s,o){if(o===void 0&&(o=0),n.length!==32)throw new Error("ChaCha: key size must be 32 bytes");if(s.length<r.length)throw new Error("ChaCha: destination is shorter than source");var f,m;if(o===0){if(t.length!==8&&t.length!==12)throw new Error("ChaCha nonce must be 8 or 12 bytes");f=new Uint8Array(16),m=f.length-t.length,f.set(t,m)}else{if(t.length!==16)throw new Error("ChaCha nonce with counter must be 16 bytes");f=t,m=o}for(var l=new Uint8Array(64),w=0;w<r.length;w+=64){Om(l,f,n);for(var O=w;O<w+64&&O<r.length;O++)s[O]=r[O]^l[O-w];Cm(f,0,m)}return Hc.wipe(l),o===0&&Hc.wipe(f),s}Ma.streamXOR=gd;function Am(n,t,r,s){return s===void 0&&(s=0),Hc.wipe(r),gd(n,t,r,r,s)}Ma.stream=Am;function Cm(n,t,r){for(var s=1;r--;)s=s+(n[t]&255)|0,n[t]=s&255,s>>>=8,t++;if(s>0)throw new Error("ChaCha: counter overflow")}var yd={},Pi={};Object.defineProperty(Pi,"__esModule",{value:!0});function Pm(n,t,r){return~(n-1)&t|n-1&r}Pi.select=Pm;function Tm(n,t){return(n|0)-(t|0)-1>>>31&1}Pi.lessOrEqual=Tm;function vd(n,t){if(n.length!==t.length)return 0;for(var r=0,s=0;s<n.length;s++)r|=n[s]^t[s];return 1&r-1>>>8}Pi.compare=vd;function Nm(n,t){return n.length===0||t.length===0?!1:vd(n,t)!==0}Pi.equal=Nm;(function(n){Object.defineProperty(n,"__esModule",{value:!0});var t=Pi,r=Sr;n.DIGEST_LENGTH=16;var s=function(){function m(l){this.digestLength=n.DIGEST_LENGTH,this._buffer=new Uint8Array(16),this._r=new Uint16Array(10),this._h=new Uint16Array(10),this._pad=new Uint16Array(8),this._leftover=0,this._fin=0,this._finished=!1;var w=l[0]|l[1]<<8;this._r[0]=w&8191;var O=l[2]|l[3]<<8;this._r[1]=(w>>>13|O<<3)&8191;var I=l[4]|l[5]<<8;this._r[2]=(O>>>10|I<<6)&7939;var N=l[6]|l[7]<<8;this._r[3]=(I>>>7|N<<9)&8191;var j=l[8]|l[9]<<8;this._r[4]=(N>>>4|j<<12)&255,this._r[5]=j>>>1&8190;var R=l[10]|l[11]<<8;this._r[6]=(j>>>14|R<<2)&8191;var U=l[12]|l[13]<<8;this._r[7]=(R>>>11|U<<5)&8065;var H=l[14]|l[15]<<8;this._r[8]=(U>>>8|H<<8)&8191,this._r[9]=H>>>5&127,this._pad[0]=l[16]|l[17]<<8,this._pad[1]=l[18]|l[19]<<8,this._pad[2]=l[20]|l[21]<<8,this._pad[3]=l[22]|l[23]<<8,this._pad[4]=l[24]|l[25]<<8,this._pad[5]=l[26]|l[27]<<8,this._pad[6]=l[28]|l[29]<<8,this._pad[7]=l[30]|l[31]<<8}return m.prototype._blocks=function(l,w,O){for(var I=this._fin?0:2048,N=this._h[0],j=this._h[1],R=this._h[2],U=this._h[3],H=this._h[4],K=this._h[5],ie=this._h[6],p=this._h[7],b=this._h[8],y=this._h[9],_=this._r[0],d=this._r[1],c=this._r[2],v=this._r[3],z=this._r[4],G=this._r[5],se=this._r[6],ce=this._r[7],de=this._r[8],S=this._r[9];O>=16;){var C=l[w+0]|l[w+1]<<8;N+=C&8191;var ee=l[w+2]|l[w+3]<<8;j+=(C>>>13|ee<<3)&8191;var X=l[w+4]|l[w+5]<<8;R+=(ee>>>10|X<<6)&8191;var k=l[w+6]|l[w+7]<<8;U+=(X>>>7|k<<9)&8191;var W=l[w+8]|l[w+9]<<8;H+=(k>>>4|W<<12)&8191,K+=W>>>1&8191;var J=l[w+10]|l[w+11]<<8;ie+=(W>>>14|J<<2)&8191;var re=l[w+12]|l[w+13]<<8;p+=(J>>>11|re<<5)&8191;var be=l[w+14]|l[w+15]<<8;b+=(re>>>8|be<<8)&8191,y+=be>>>5|I;var ae=0,we=ae;we+=N*_,we+=j*(5*S),we+=R*(5*de),we+=U*(5*ce),we+=H*(5*se),ae=we>>>13,we&=8191,we+=K*(5*G),we+=ie*(5*z),we+=p*(5*v),we+=b*(5*c),we+=y*(5*d),ae+=we>>>13,we&=8191;var fe=ae;fe+=N*d,fe+=j*_,fe+=R*(5*S),fe+=U*(5*de),fe+=H*(5*ce),ae=fe>>>13,fe&=8191,fe+=K*(5*se),fe+=ie*(5*G),fe+=p*(5*z),fe+=b*(5*v),fe+=y*(5*c),ae+=fe>>>13,fe&=8191;var ve=ae;ve+=N*c,ve+=j*d,ve+=R*_,ve+=U*(5*S),ve+=H*(5*de),ae=ve>>>13,ve&=8191,ve+=K*(5*ce),ve+=ie*(5*se),ve+=p*(5*G),ve+=b*(5*z),ve+=y*(5*v),ae+=ve>>>13,ve&=8191;var B=ae;B+=N*v,B+=j*c,B+=R*d,B+=U*_,B+=H*(5*S),ae=B>>>13,B&=8191,B+=K*(5*de),B+=ie*(5*ce),B+=p*(5*se),B+=b*(5*G),B+=y*(5*z),ae+=B>>>13,B&=8191;var q=ae;q+=N*z,q+=j*v,q+=R*c,q+=U*d,q+=H*_,ae=q>>>13,q&=8191,q+=K*(5*S),q+=ie*(5*de),q+=p*(5*ce),q+=b*(5*se),q+=y*(5*G),ae+=q>>>13,q&=8191;var F=ae;F+=N*G,F+=j*z,F+=R*v,F+=U*c,F+=H*d,ae=F>>>13,F&=8191,F+=K*_,F+=ie*(5*S),F+=p*(5*de),F+=b*(5*ce),F+=y*(5*se),ae+=F>>>13,F&=8191;var h=ae;h+=N*se,h+=j*G,h+=R*z,h+=U*v,h+=H*c,ae=h>>>13,h&=8191,h+=K*d,h+=ie*_,h+=p*(5*S),h+=b*(5*de),h+=y*(5*ce),ae+=h>>>13,h&=8191;var P=ae;P+=N*ce,P+=j*se,P+=R*G,P+=U*z,P+=H*v,ae=P>>>13,P&=8191,P+=K*c,P+=ie*d,P+=p*_,P+=b*(5*S),P+=y*(5*de),ae+=P>>>13,P&=8191;var oe=ae;oe+=N*de,oe+=j*ce,oe+=R*se,oe+=U*G,oe+=H*z,ae=oe>>>13,oe&=8191,oe+=K*v,oe+=ie*c,oe+=p*d,oe+=b*_,oe+=y*(5*S),ae+=oe>>>13,oe&=8191;var le=ae;le+=N*S,le+=j*de,le+=R*ce,le+=U*se,le+=H*G,ae=le>>>13,le&=8191,le+=K*z,le+=ie*v,le+=p*c,le+=b*d,le+=y*_,ae+=le>>>13,le&=8191,ae=(ae<<2)+ae|0,ae=ae+we|0,we=ae&8191,ae=ae>>>13,fe+=ae,N=we,j=fe,R=ve,U=B,H=q,K=F,ie=h,p=P,b=oe,y=le,w+=16,O-=16}this._h[0]=N,this._h[1]=j,this._h[2]=R,this._h[3]=U,this._h[4]=H,this._h[5]=K,this._h[6]=ie,this._h[7]=p,this._h[8]=b,this._h[9]=y},m.prototype.finish=function(l,w){w===void 0&&(w=0);var O=new Uint16Array(10),I,N,j,R;if(this._leftover){for(R=this._leftover,this._buffer[R++]=1;R<16;R++)this._buffer[R]=0;this._fin=1,this._blocks(this._buffer,0,16)}for(I=this._h[1]>>>13,this._h[1]&=8191,R=2;R<10;R++)this._h[R]+=I,I=this._h[R]>>>13,this._h[R]&=8191;for(this._h[0]+=I*5,I=this._h[0]>>>13,this._h[0]&=8191,this._h[1]+=I,I=this._h[1]>>>13,this._h[1]&=8191,this._h[2]+=I,O[0]=this._h[0]+5,I=O[0]>>>13,O[0]&=8191,R=1;R<10;R++)O[R]=this._h[R]+I,I=O[R]>>>13,O[R]&=8191;for(O[9]-=8192,N=(I^1)-1,R=0;R<10;R++)O[R]&=N;for(N=~N,R=0;R<10;R++)this._h[R]=this._h[R]&N|O[R];for(this._h[0]=(this._h[0]|this._h[1]<<13)&65535,this._h[1]=(this._h[1]>>>3|this._h[2]<<10)&65535,this._h[2]=(this._h[2]>>>6|this._h[3]<<7)&65535,this._h[3]=(this._h[3]>>>9|this._h[4]<<4)&65535,this._h[4]=(this._h[4]>>>12|this._h[5]<<1|this._h[6]<<14)&65535,this._h[5]=(this._h[6]>>>2|this._h[7]<<11)&65535,this._h[6]=(this._h[7]>>>5|this._h[8]<<8)&65535,this._h[7]=(this._h[8]>>>8|this._h[9]<<5)&65535,j=this._h[0]+this._pad[0],this._h[0]=j&65535,R=1;R<8;R++)j=(this._h[R]+this._pad[R]|0)+(j>>>16)|0,this._h[R]=j&65535;return l[w+0]=this._h[0]>>>0,l[w+1]=this._h[0]>>>8,l[w+2]=this._h[1]>>>0,l[w+3]=this._h[1]>>>8,l[w+4]=this._h[2]>>>0,l[w+5]=this._h[2]>>>8,l[w+6]=this._h[3]>>>0,l[w+7]=this._h[3]>>>8,l[w+8]=this._h[4]>>>0,l[w+9]=this._h[4]>>>8,l[w+10]=this._h[5]>>>0,l[w+11]=this._h[5]>>>8,l[w+12]=this._h[6]>>>0,l[w+13]=this._h[6]>>>8,l[w+14]=this._h[7]>>>0,l[w+15]=this._h[7]>>>8,this._finished=!0,this},m.prototype.update=function(l){var w=0,O=l.length,I;if(this._leftover){I=16-this._leftover,I>O&&(I=O);for(var N=0;N<I;N++)this._buffer[this._leftover+N]=l[w+N];if(O-=I,w+=I,this._leftover+=I,this._leftover<16)return this;this._blocks(this._buffer,0,16),this._leftover=0}if(O>=16&&(I=O-O%16,this._blocks(l,w,I),w+=I,O-=I),O){for(var N=0;N<O;N++)this._buffer[this._leftover+N]=l[w+N];this._leftover+=O}return this},m.prototype.digest=function(){if(this._finished)throw new Error("Poly1305 was finished");var l=new Uint8Array(16);return this.finish(l),l},m.prototype.clean=function(){return r.wipe(this._buffer),r.wipe(this._r),r.wipe(this._h),r.wipe(this._pad),this._leftover=0,this._fin=0,this._finished=!0,this},m}();n.Poly1305=s;function o(m,l){var w=new s(m);w.update(l);var O=w.digest();return w.clean(),O}n.oneTimeAuth=o;function f(m,l){return m.length!==n.DIGEST_LENGTH||l.length!==n.DIGEST_LENGTH?!1:t.equal(m,l)}n.equal=f})(yd);(function(n){Object.defineProperty(n,"__esModule",{value:!0});var t=Ma,r=yd,s=Sr,o=$e,f=Pi;n.KEY_LENGTH=32,n.NONCE_LENGTH=12,n.TAG_LENGTH=16;var m=new Uint8Array(16),l=function(){function w(O){if(this.nonceLength=n.NONCE_LENGTH,this.tagLength=n.TAG_LENGTH,O.length!==n.KEY_LENGTH)throw new Error("ChaCha20Poly1305 needs 32-byte key");this._key=new Uint8Array(O)}return w.prototype.seal=function(O,I,N,j){if(O.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");var R=new Uint8Array(16);R.set(O,R.length-O.length);var U=new Uint8Array(32);t.stream(this._key,R,U,4);var H=I.length+this.tagLength,K;if(j){if(j.length!==H)throw new Error("ChaCha20Poly1305: incorrect destination length");K=j}else K=new Uint8Array(H);return t.streamXOR(this._key,R,I,K,4),this._authenticate(K.subarray(K.length-this.tagLength,K.length),U,K.subarray(0,K.length-this.tagLength),N),s.wipe(R),K},w.prototype.open=function(O,I,N,j){if(O.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");if(I.length<this.tagLength)return null;var R=new Uint8Array(16);R.set(O,R.length-O.length);var U=new Uint8Array(32);t.stream(this._key,R,U,4);var H=new Uint8Array(this.tagLength);if(this._authenticate(H,U,I.subarray(0,I.length-this.tagLength),N),!f.equal(H,I.subarray(I.length-this.tagLength,I.length)))return null;var K=I.length-this.tagLength,ie;if(j){if(j.length!==K)throw new Error("ChaCha20Poly1305: incorrect destination length");ie=j}else ie=new Uint8Array(K);return t.streamXOR(this._key,R,I.subarray(0,I.length-this.tagLength),ie,4),s.wipe(R),ie},w.prototype.clean=function(){return s.wipe(this._key),this},w.prototype._authenticate=function(O,I,N,j){var R=new r.Poly1305(I);j&&(R.update(j),j.length%16>0&&R.update(m.subarray(j.length%16))),R.update(N),N.length%16>0&&R.update(m.subarray(N.length%16));var U=new Uint8Array(8);j&&o.writeUint64LE(j.length,U),R.update(U),o.writeUint64LE(N.length,U),R.update(U);for(var H=R.digest(),K=0;K<H.length;K++)O[K]=H[K];R.clean(),s.wipe(H),s.wipe(U)},w}();n.ChaCha20Poly1305=l})(fu);var _d={},ls={},lu={};Object.defineProperty(lu,"__esModule",{value:!0});function Um(n){return typeof n.saveState<"u"&&typeof n.restoreState<"u"&&typeof n.cleanSavedState<"u"}lu.isSerializableHash=Um;Object.defineProperty(ls,"__esModule",{value:!0});var Qr=lu,Rm=Pi,Fm=Sr,md=function(){function n(t,r){this._finished=!1,this._inner=new t,this._outer=new t,this.blockSize=this._outer.blockSize,this.digestLength=this._outer.digestLength;var s=new Uint8Array(this.blockSize);r.length>this.blockSize?this._inner.update(r).finish(s).clean():s.set(r);for(var o=0;o<s.length;o++)s[o]^=54;this._inner.update(s);for(var o=0;o<s.length;o++)s[o]^=106;this._outer.update(s),Qr.isSerializableHash(this._inner)&&Qr.isSerializableHash(this._outer)&&(this._innerKeyedState=this._inner.saveState(),this._outerKeyedState=this._outer.saveState()),Fm.wipe(s)}return n.prototype.reset=function(){if(!Qr.isSerializableHash(this._inner)||!Qr.isSerializableHash(this._outer))throw new Error("hmac: can't reset() because hash doesn't implement restoreState()");return this._inner.restoreState(this._innerKeyedState),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},n.prototype.clean=function(){Qr.isSerializableHash(this._inner)&&this._inner.cleanSavedState(this._innerKeyedState),Qr.isSerializableHash(this._outer)&&this._outer.cleanSavedState(this._outerKeyedState),this._inner.clean(),this._outer.clean()},n.prototype.update=function(t){return this._inner.update(t),this},n.prototype.finish=function(t){return this._finished?(this._outer.finish(t),this):(this._inner.finish(t),this._outer.update(t.subarray(0,this.digestLength)).finish(t),this._finished=!0,this)},n.prototype.digest=function(){var t=new Uint8Array(this.digestLength);return this.finish(t),t},n.prototype.saveState=function(){if(!Qr.isSerializableHash(this._inner))throw new Error("hmac: can't saveState() because hash doesn't implement it");return this._inner.saveState()},n.prototype.restoreState=function(t){if(!Qr.isSerializableHash(this._inner)||!Qr.isSerializableHash(this._outer))throw new Error("hmac: can't restoreState() because hash doesn't implement it");return this._inner.restoreState(t),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},n.prototype.cleanSavedState=function(t){if(!Qr.isSerializableHash(this._inner))throw new Error("hmac: can't cleanSavedState() because hash doesn't implement it");this._inner.cleanSavedState(t)},n}();ls.HMAC=md;function $m(n,t,r){var s=new md(n,t);s.update(r);var o=s.digest();return s.clean(),o}ls.hmac=$m;ls.equal=Rm.equal;Object.defineProperty(_d,"__esModule",{value:!0});var Nf=ls,Uf=Sr,Lm=function(){function n(t,r,s,o){s===void 0&&(s=new Uint8Array(0)),this._counter=new Uint8Array(1),this._hash=t,this._info=o;var f=Nf.hmac(this._hash,s,r);this._hmac=new Nf.HMAC(t,f),this._buffer=new Uint8Array(this._hmac.digestLength),this._bufpos=this._buffer.length}return n.prototype._fillBuffer=function(){this._counter[0]++;var t=this._counter[0];if(t===0)throw new Error("hkdf: cannot expand more");this._hmac.reset(),t>1&&this._hmac.update(this._buffer),this._info&&this._hmac.update(this._info),this._hmac.update(this._counter),this._hmac.finish(this._buffer),this._bufpos=0},n.prototype.expand=function(t){for(var r=new Uint8Array(t),s=0;s<r.length;s++)this._bufpos===this._buffer.length&&this._fillBuffer(),r[s]=this._buffer[this._bufpos++];return r},n.prototype.clean=function(){this._hmac.clean(),Uf.wipe(this._buffer),Uf.wipe(this._counter),this._bufpos=0},n}(),Mm=_d.HKDF=Lm,Cn={},ja={},qa={};Object.defineProperty(qa,"__esModule",{value:!0});qa.BrowserRandomSource=void 0;const Rf=65536;class jm{constructor(){this.isAvailable=!1,this.isInstantiated=!1;const t=typeof self<"u"?self.crypto||self.msCrypto:null;t&&t.getRandomValues!==void 0&&(this._crypto=t,this.isAvailable=!0,this.isInstantiated=!0)}randomBytes(t){if(!this.isAvailable||!this._crypto)throw new Error("Browser random byte generator is not available.");const r=new Uint8Array(t);for(let s=0;s<r.length;s+=Rf)this._crypto.getRandomValues(r.subarray(s,s+Math.min(r.length-s,Rf)));return r}}qa.BrowserRandomSource=jm;function qm(n){throw new Error('Could not dynamically require "'+n+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Ba={};Object.defineProperty(Ba,"__esModule",{value:!0});Ba.NodeRandomSource=void 0;const Bm=Sr;class zm{constructor(){if(this.isAvailable=!1,this.isInstantiated=!1,typeof qm<"u"){const t=J_;t&&t.randomBytes&&(this._crypto=t,this.isAvailable=!0,this.isInstantiated=!0)}}randomBytes(t){if(!this.isAvailable||!this._crypto)throw new Error("Node.js random byte generator is not available.");let r=this._crypto.randomBytes(t);if(r.length!==t)throw new Error("NodeRandomSource: got fewer bytes than requested");const s=new Uint8Array(t);for(let o=0;o<s.length;o++)s[o]=r[o];return(0,Bm.wipe)(r),s}}Ba.NodeRandomSource=zm;Object.defineProperty(ja,"__esModule",{value:!0});ja.SystemRandomSource=void 0;const Hm=qa,Km=Ba;class Vm{constructor(){if(this.isAvailable=!1,this.name="",this._source=new Hm.BrowserRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Browser";return}if(this._source=new Km.NodeRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Node";return}}randomBytes(t){if(!this.isAvailable)throw new Error("System random byte generator is not available.");return this._source.randomBytes(t)}}ja.SystemRandomSource=Vm;(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.randomStringForEntropy=n.randomString=n.randomUint32=n.randomBytes=n.defaultRandomSource=void 0;const t=ja,r=$e,s=Sr;n.defaultRandomSource=new t.SystemRandomSource;function o(O,I=n.defaultRandomSource){return I.randomBytes(O)}n.randomBytes=o;function f(O=n.defaultRandomSource){const I=o(4,O),N=(0,r.readUint32LE)(I);return(0,s.wipe)(I),N}n.randomUint32=f;const m="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function l(O,I=m,N=n.defaultRandomSource){if(I.length<2)throw new Error("randomString charset is too short");if(I.length>256)throw new Error("randomString charset is too long");let j="";const R=I.length,U=256-256%R;for(;O>0;){const H=o(Math.ceil(O*256/U),N);for(let K=0;K<H.length&&O>0;K++){const ie=H[K];ie<U&&(j+=I.charAt(ie%R),O--)}(0,s.wipe)(H)}return j}n.randomString=l;function w(O,I=m,N=n.defaultRandomSource){const j=Math.ceil(O/(Math.log(I.length)/Math.LN2));return l(j,I,N)}n.randomStringForEntropy=w})(Cn);var za={};(function(n){Object.defineProperty(n,"__esModule",{value:!0});var t=$e,r=Sr;n.DIGEST_LENGTH=32,n.BLOCK_SIZE=64;var s=function(){function l(){this.digestLength=n.DIGEST_LENGTH,this.blockSize=n.BLOCK_SIZE,this._state=new Int32Array(8),this._temp=new Int32Array(64),this._buffer=new Uint8Array(128),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return l.prototype._initState=function(){this._state[0]=1779033703,this._state[1]=3144134277,this._state[2]=1013904242,this._state[3]=2773480762,this._state[4]=1359893119,this._state[5]=2600822924,this._state[6]=528734635,this._state[7]=1541459225},l.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},l.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._temp),this.reset()},l.prototype.update=function(w,O){if(O===void 0&&(O=w.length),this._finished)throw new Error("SHA256: can't update because hash was finished.");var I=0;if(this._bytesHashed+=O,this._bufferLength>0){for(;this._bufferLength<this.blockSize&&O>0;)this._buffer[this._bufferLength++]=w[I++],O--;this._bufferLength===this.blockSize&&(f(this._temp,this._state,this._buffer,0,this.blockSize),this._bufferLength=0)}for(O>=this.blockSize&&(I=f(this._temp,this._state,w,I,O),O%=this.blockSize);O>0;)this._buffer[this._bufferLength++]=w[I++],O--;return this},l.prototype.finish=function(w){if(!this._finished){var O=this._bytesHashed,I=this._bufferLength,N=O/536870912|0,j=O<<3,R=O%64<56?64:128;this._buffer[I]=128;for(var U=I+1;U<R-8;U++)this._buffer[U]=0;t.writeUint32BE(N,this._buffer,R-8),t.writeUint32BE(j,this._buffer,R-4),f(this._temp,this._state,this._buffer,0,R),this._finished=!0}for(var U=0;U<this.digestLength/4;U++)t.writeUint32BE(this._state[U],w,U*4);return this},l.prototype.digest=function(){var w=new Uint8Array(this.digestLength);return this.finish(w),w},l.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{state:new Int32Array(this._state),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},l.prototype.restoreState=function(w){return this._state.set(w.state),this._bufferLength=w.bufferLength,w.buffer&&this._buffer.set(w.buffer),this._bytesHashed=w.bytesHashed,this._finished=!1,this},l.prototype.cleanSavedState=function(w){r.wipe(w.state),w.buffer&&r.wipe(w.buffer),w.bufferLength=0,w.bytesHashed=0},l}();n.SHA256=s;var o=new Int32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function f(l,w,O,I,N){for(;N>=64;){for(var j=w[0],R=w[1],U=w[2],H=w[3],K=w[4],ie=w[5],p=w[6],b=w[7],y=0;y<16;y++){var _=I+y*4;l[y]=t.readUint32BE(O,_)}for(var y=16;y<64;y++){var d=l[y-2],c=(d>>>17|d<<32-17)^(d>>>19|d<<32-19)^d>>>10;d=l[y-15];var v=(d>>>7|d<<32-7)^(d>>>18|d<<32-18)^d>>>3;l[y]=(c+l[y-7]|0)+(v+l[y-16]|0)}for(var y=0;y<64;y++){var c=(((K>>>6|K<<26)^(K>>>11|K<<21)^(K>>>25|K<<7))+(K&ie^~K&p)|0)+(b+(o[y]+l[y]|0)|0)|0,v=((j>>>2|j<<32-2)^(j>>>13|j<<32-13)^(j>>>22|j<<32-22))+(j&R^j&U^R&U)|0;b=p,p=ie,ie=K,K=H+c|0,H=U,U=R,R=j,j=c+v|0}w[0]+=j,w[1]+=R,w[2]+=U,w[3]+=H,w[4]+=K,w[5]+=ie,w[6]+=p,w[7]+=b,I+=64,N-=64}return I}function m(l){var w=new s;w.update(l);var O=w.digest();return w.clean(),O}n.hash=m})(za);var du={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.sharedKey=n.generateKeyPair=n.generateKeyPairFromSeed=n.scalarMultBase=n.scalarMult=n.SHARED_KEY_LENGTH=n.SECRET_KEY_LENGTH=n.PUBLIC_KEY_LENGTH=void 0;const t=Cn,r=Sr;n.PUBLIC_KEY_LENGTH=32,n.SECRET_KEY_LENGTH=32,n.SHARED_KEY_LENGTH=32;function s(y){const _=new Float64Array(16);if(y)for(let d=0;d<y.length;d++)_[d]=y[d];return _}const o=new Uint8Array(32);o[0]=9;const f=s([56129,1]);function m(y){let _=1;for(let d=0;d<16;d++){let c=y[d]+_+65535;_=Math.floor(c/65536),y[d]=c-_*65536}y[0]+=_-1+37*(_-1)}function l(y,_,d){const c=~(d-1);for(let v=0;v<16;v++){const z=c&(y[v]^_[v]);y[v]^=z,_[v]^=z}}function w(y,_){const d=s(),c=s();for(let v=0;v<16;v++)c[v]=_[v];m(c),m(c),m(c);for(let v=0;v<2;v++){d[0]=c[0]-65517;for(let G=1;G<15;G++)d[G]=c[G]-65535-(d[G-1]>>16&1),d[G-1]&=65535;d[15]=c[15]-32767-(d[14]>>16&1);const z=d[15]>>16&1;d[14]&=65535,l(c,d,1-z)}for(let v=0;v<16;v++)y[2*v]=c[v]&255,y[2*v+1]=c[v]>>8}function O(y,_){for(let d=0;d<16;d++)y[d]=_[2*d]+(_[2*d+1]<<8);y[15]&=32767}function I(y,_,d){for(let c=0;c<16;c++)y[c]=_[c]+d[c]}function N(y,_,d){for(let c=0;c<16;c++)y[c]=_[c]-d[c]}function j(y,_,d){let c,v,z=0,G=0,se=0,ce=0,de=0,S=0,C=0,ee=0,X=0,k=0,W=0,J=0,re=0,be=0,ae=0,we=0,fe=0,ve=0,B=0,q=0,F=0,h=0,P=0,oe=0,le=0,Ie=0,ze=0,Ve=0,Le=0,pt=0,gt=0,je=d[0],xe=d[1],Ue=d[2],Re=d[3],qe=d[4],Ae=d[5],Fe=d[6],Se=d[7],Ce=d[8],He=d[9],Oe=d[10],ke=d[11],Ge=d[12],et=d[13],tt=d[14],Je=d[15];c=_[0],z+=c*je,G+=c*xe,se+=c*Ue,ce+=c*Re,de+=c*qe,S+=c*Ae,C+=c*Fe,ee+=c*Se,X+=c*Ce,k+=c*He,W+=c*Oe,J+=c*ke,re+=c*Ge,be+=c*et,ae+=c*tt,we+=c*Je,c=_[1],G+=c*je,se+=c*xe,ce+=c*Ue,de+=c*Re,S+=c*qe,C+=c*Ae,ee+=c*Fe,X+=c*Se,k+=c*Ce,W+=c*He,J+=c*Oe,re+=c*ke,be+=c*Ge,ae+=c*et,we+=c*tt,fe+=c*Je,c=_[2],se+=c*je,ce+=c*xe,de+=c*Ue,S+=c*Re,C+=c*qe,ee+=c*Ae,X+=c*Fe,k+=c*Se,W+=c*Ce,J+=c*He,re+=c*Oe,be+=c*ke,ae+=c*Ge,we+=c*et,fe+=c*tt,ve+=c*Je,c=_[3],ce+=c*je,de+=c*xe,S+=c*Ue,C+=c*Re,ee+=c*qe,X+=c*Ae,k+=c*Fe,W+=c*Se,J+=c*Ce,re+=c*He,be+=c*Oe,ae+=c*ke,we+=c*Ge,fe+=c*et,ve+=c*tt,B+=c*Je,c=_[4],de+=c*je,S+=c*xe,C+=c*Ue,ee+=c*Re,X+=c*qe,k+=c*Ae,W+=c*Fe,J+=c*Se,re+=c*Ce,be+=c*He,ae+=c*Oe,we+=c*ke,fe+=c*Ge,ve+=c*et,B+=c*tt,q+=c*Je,c=_[5],S+=c*je,C+=c*xe,ee+=c*Ue,X+=c*Re,k+=c*qe,W+=c*Ae,J+=c*Fe,re+=c*Se,be+=c*Ce,ae+=c*He,we+=c*Oe,fe+=c*ke,ve+=c*Ge,B+=c*et,q+=c*tt,F+=c*Je,c=_[6],C+=c*je,ee+=c*xe,X+=c*Ue,k+=c*Re,W+=c*qe,J+=c*Ae,re+=c*Fe,be+=c*Se,ae+=c*Ce,we+=c*He,fe+=c*Oe,ve+=c*ke,B+=c*Ge,q+=c*et,F+=c*tt,h+=c*Je,c=_[7],ee+=c*je,X+=c*xe,k+=c*Ue,W+=c*Re,J+=c*qe,re+=c*Ae,be+=c*Fe,ae+=c*Se,we+=c*Ce,fe+=c*He,ve+=c*Oe,B+=c*ke,q+=c*Ge,F+=c*et,h+=c*tt,P+=c*Je,c=_[8],X+=c*je,k+=c*xe,W+=c*Ue,J+=c*Re,re+=c*qe,be+=c*Ae,ae+=c*Fe,we+=c*Se,fe+=c*Ce,ve+=c*He,B+=c*Oe,q+=c*ke,F+=c*Ge,h+=c*et,P+=c*tt,oe+=c*Je,c=_[9],k+=c*je,W+=c*xe,J+=c*Ue,re+=c*Re,be+=c*qe,ae+=c*Ae,we+=c*Fe,fe+=c*Se,ve+=c*Ce,B+=c*He,q+=c*Oe,F+=c*ke,h+=c*Ge,P+=c*et,oe+=c*tt,le+=c*Je,c=_[10],W+=c*je,J+=c*xe,re+=c*Ue,be+=c*Re,ae+=c*qe,we+=c*Ae,fe+=c*Fe,ve+=c*Se,B+=c*Ce,q+=c*He,F+=c*Oe,h+=c*ke,P+=c*Ge,oe+=c*et,le+=c*tt,Ie+=c*Je,c=_[11],J+=c*je,re+=c*xe,be+=c*Ue,ae+=c*Re,we+=c*qe,fe+=c*Ae,ve+=c*Fe,B+=c*Se,q+=c*Ce,F+=c*He,h+=c*Oe,P+=c*ke,oe+=c*Ge,le+=c*et,Ie+=c*tt,ze+=c*Je,c=_[12],re+=c*je,be+=c*xe,ae+=c*Ue,we+=c*Re,fe+=c*qe,ve+=c*Ae,B+=c*Fe,q+=c*Se,F+=c*Ce,h+=c*He,P+=c*Oe,oe+=c*ke,le+=c*Ge,Ie+=c*et,ze+=c*tt,Ve+=c*Je,c=_[13],be+=c*je,ae+=c*xe,we+=c*Ue,fe+=c*Re,ve+=c*qe,B+=c*Ae,q+=c*Fe,F+=c*Se,h+=c*Ce,P+=c*He,oe+=c*Oe,le+=c*ke,Ie+=c*Ge,ze+=c*et,Ve+=c*tt,Le+=c*Je,c=_[14],ae+=c*je,we+=c*xe,fe+=c*Ue,ve+=c*Re,B+=c*qe,q+=c*Ae,F+=c*Fe,h+=c*Se,P+=c*Ce,oe+=c*He,le+=c*Oe,Ie+=c*ke,ze+=c*Ge,Ve+=c*et,Le+=c*tt,pt+=c*Je,c=_[15],we+=c*je,fe+=c*xe,ve+=c*Ue,B+=c*Re,q+=c*qe,F+=c*Ae,h+=c*Fe,P+=c*Se,oe+=c*Ce,le+=c*He,Ie+=c*Oe,ze+=c*ke,Ve+=c*Ge,Le+=c*et,pt+=c*tt,gt+=c*Je,z+=38*fe,G+=38*ve,se+=38*B,ce+=38*q,de+=38*F,S+=38*h,C+=38*P,ee+=38*oe,X+=38*le,k+=38*Ie,W+=38*ze,J+=38*Ve,re+=38*Le,be+=38*pt,ae+=38*gt,v=1,c=z+v+65535,v=Math.floor(c/65536),z=c-v*65536,c=G+v+65535,v=Math.floor(c/65536),G=c-v*65536,c=se+v+65535,v=Math.floor(c/65536),se=c-v*65536,c=ce+v+65535,v=Math.floor(c/65536),ce=c-v*65536,c=de+v+65535,v=Math.floor(c/65536),de=c-v*65536,c=S+v+65535,v=Math.floor(c/65536),S=c-v*65536,c=C+v+65535,v=Math.floor(c/65536),C=c-v*65536,c=ee+v+65535,v=Math.floor(c/65536),ee=c-v*65536,c=X+v+65535,v=Math.floor(c/65536),X=c-v*65536,c=k+v+65535,v=Math.floor(c/65536),k=c-v*65536,c=W+v+65535,v=Math.floor(c/65536),W=c-v*65536,c=J+v+65535,v=Math.floor(c/65536),J=c-v*65536,c=re+v+65535,v=Math.floor(c/65536),re=c-v*65536,c=be+v+65535,v=Math.floor(c/65536),be=c-v*65536,c=ae+v+65535,v=Math.floor(c/65536),ae=c-v*65536,c=we+v+65535,v=Math.floor(c/65536),we=c-v*65536,z+=v-1+37*(v-1),v=1,c=z+v+65535,v=Math.floor(c/65536),z=c-v*65536,c=G+v+65535,v=Math.floor(c/65536),G=c-v*65536,c=se+v+65535,v=Math.floor(c/65536),se=c-v*65536,c=ce+v+65535,v=Math.floor(c/65536),ce=c-v*65536,c=de+v+65535,v=Math.floor(c/65536),de=c-v*65536,c=S+v+65535,v=Math.floor(c/65536),S=c-v*65536,c=C+v+65535,v=Math.floor(c/65536),C=c-v*65536,c=ee+v+65535,v=Math.floor(c/65536),ee=c-v*65536,c=X+v+65535,v=Math.floor(c/65536),X=c-v*65536,c=k+v+65535,v=Math.floor(c/65536),k=c-v*65536,c=W+v+65535,v=Math.floor(c/65536),W=c-v*65536,c=J+v+65535,v=Math.floor(c/65536),J=c-v*65536,c=re+v+65535,v=Math.floor(c/65536),re=c-v*65536,c=be+v+65535,v=Math.floor(c/65536),be=c-v*65536,c=ae+v+65535,v=Math.floor(c/65536),ae=c-v*65536,c=we+v+65535,v=Math.floor(c/65536),we=c-v*65536,z+=v-1+37*(v-1),y[0]=z,y[1]=G,y[2]=se,y[3]=ce,y[4]=de,y[5]=S,y[6]=C,y[7]=ee,y[8]=X,y[9]=k,y[10]=W,y[11]=J,y[12]=re,y[13]=be,y[14]=ae,y[15]=we}function R(y,_){j(y,_,_)}function U(y,_){const d=s();for(let c=0;c<16;c++)d[c]=_[c];for(let c=253;c>=0;c--)R(d,d),c!==2&&c!==4&&j(d,d,_);for(let c=0;c<16;c++)y[c]=d[c]}function H(y,_){const d=new Uint8Array(32),c=new Float64Array(80),v=s(),z=s(),G=s(),se=s(),ce=s(),de=s();for(let X=0;X<31;X++)d[X]=y[X];d[31]=y[31]&127|64,d[0]&=248,O(c,_);for(let X=0;X<16;X++)z[X]=c[X];v[0]=se[0]=1;for(let X=254;X>=0;--X){const k=d[X>>>3]>>>(X&7)&1;l(v,z,k),l(G,se,k),I(ce,v,G),N(v,v,G),I(G,z,se),N(z,z,se),R(se,ce),R(de,v),j(v,G,v),j(G,z,ce),I(ce,v,G),N(v,v,G),R(z,v),N(G,se,de),j(v,G,f),I(v,v,se),j(G,G,v),j(v,se,de),j(se,z,c),R(z,ce),l(v,z,k),l(G,se,k)}for(let X=0;X<16;X++)c[X+16]=v[X],c[X+32]=G[X],c[X+48]=z[X],c[X+64]=se[X];const S=c.subarray(32),C=c.subarray(16);U(S,S),j(C,C,S);const ee=new Uint8Array(32);return w(ee,C),ee}n.scalarMult=H;function K(y){return H(y,o)}n.scalarMultBase=K;function ie(y){if(y.length!==n.SECRET_KEY_LENGTH)throw new Error(`x25519: seed must be ${n.SECRET_KEY_LENGTH} bytes`);const _=new Uint8Array(y);return{publicKey:K(_),secretKey:_}}n.generateKeyPairFromSeed=ie;function p(y){const _=(0,t.randomBytes)(32,y),d=ie(_);return(0,r.wipe)(_),d}n.generateKeyPair=p;function b(y,_,d=!1){if(y.length!==n.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect secret key length");if(_.length!==n.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect public key length");const c=H(y,_);if(d){let v=0;for(let z=0;z<c.length;z++)v|=c[z];if(v===0)throw new Error("X25519: invalid shared key")}return c}n.sharedKey=b})(du);function pu(n){return globalThis.Buffer!=null?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):n}function bd(n=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?pu(globalThis.Buffer.allocUnsafe(n)):new Uint8Array(n)}function Kc(n,t){t||(t=n.reduce((o,f)=>o+f.length,0));const r=bd(t);let s=0;for(const o of n)r.set(o,s),s+=o.length;return pu(r)}function km(n,t){if(n.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),s=0;s<r.length;s++)r[s]=255;for(var o=0;o<n.length;o++){var f=n.charAt(o),m=f.charCodeAt(0);if(r[m]!==255)throw new TypeError(f+" is ambiguous");r[m]=o}var l=n.length,w=n.charAt(0),O=Math.log(l)/Math.log(256),I=Math.log(256)/Math.log(l);function N(U){if(U instanceof Uint8Array||(ArrayBuffer.isView(U)?U=new Uint8Array(U.buffer,U.byteOffset,U.byteLength):Array.isArray(U)&&(U=Uint8Array.from(U))),!(U instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(U.length===0)return"";for(var H=0,K=0,ie=0,p=U.length;ie!==p&&U[ie]===0;)ie++,H++;for(var b=(p-ie)*I+1>>>0,y=new Uint8Array(b);ie!==p;){for(var _=U[ie],d=0,c=b-1;(_!==0||d<K)&&c!==-1;c--,d++)_+=256*y[c]>>>0,y[c]=_%l>>>0,_=_/l>>>0;if(_!==0)throw new Error("Non-zero carry");K=d,ie++}for(var v=b-K;v!==b&&y[v]===0;)v++;for(var z=w.repeat(H);v<b;++v)z+=n.charAt(y[v]);return z}function j(U){if(typeof U!="string")throw new TypeError("Expected String");if(U.length===0)return new Uint8Array;var H=0;if(U[H]!==" "){for(var K=0,ie=0;U[H]===w;)K++,H++;for(var p=(U.length-H)*O+1>>>0,b=new Uint8Array(p);U[H];){var y=r[U.charCodeAt(H)];if(y===255)return;for(var _=0,d=p-1;(y!==0||_<ie)&&d!==-1;d--,_++)y+=l*b[d]>>>0,b[d]=y%256>>>0,y=y/256>>>0;if(y!==0)throw new Error("Non-zero carry");ie=_,H++}if(U[H]!==" "){for(var c=p-ie;c!==p&&b[c]===0;)c++;for(var v=new Uint8Array(K+(p-c)),z=K;c!==p;)v[z++]=b[c++];return v}}}function R(U){var H=j(U);if(H)return H;throw new Error(`Non-${t} character`)}return{encode:N,decodeUnsafe:j,decode:R}}var Wm=km,Gm=Wm;const Ym=n=>{if(n instanceof Uint8Array&&n.constructor.name==="Uint8Array")return n;if(n instanceof ArrayBuffer)return new Uint8Array(n);if(ArrayBuffer.isView(n))return new Uint8Array(n.buffer,n.byteOffset,n.byteLength);throw new Error("Unknown type, must be binary type")},Jm=n=>new TextEncoder().encode(n),Xm=n=>new TextDecoder().decode(n);class Qm{constructor(t,r,s){this.name=t,this.prefix=r,this.baseEncode=s}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}}class Zm{constructor(t,r,s){if(this.name=t,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=s}decode(t){if(typeof t=="string"){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(t){return wd(this,t)}}class eb{constructor(t){this.decoders=t}or(t){return wd(this,t)}decode(t){const r=t[0],s=this.decoders[r];if(s)return s.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const wd=(n,t)=>new eb({...n.decoders||{[n.prefix]:n},...t.decoders||{[t.prefix]:t}});class tb{constructor(t,r,s,o){this.name=t,this.prefix=r,this.baseEncode=s,this.baseDecode=o,this.encoder=new Qm(t,r,s),this.decoder=new Zm(t,r,o)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}}const Ha=({name:n,prefix:t,encode:r,decode:s})=>new tb(n,t,r,s),ds=({prefix:n,name:t,alphabet:r})=>{const{encode:s,decode:o}=Gm(r,t);return Ha({prefix:n,name:t,encode:s,decode:f=>Ym(o(f))})},rb=(n,t,r,s)=>{const o={};for(let I=0;I<t.length;++I)o[t[I]]=I;let f=n.length;for(;n[f-1]==="=";)--f;const m=new Uint8Array(f*r/8|0);let l=0,w=0,O=0;for(let I=0;I<f;++I){const N=o[n[I]];if(N===void 0)throw new SyntaxError(`Non-${s} character`);w=w<<r|N,l+=r,l>=8&&(l-=8,m[O++]=255&w>>l)}if(l>=r||255&w<<8-l)throw new SyntaxError("Unexpected end of data");return m},ib=(n,t,r)=>{const s=t[t.length-1]==="=",o=(1<<r)-1;let f="",m=0,l=0;for(let w=0;w<n.length;++w)for(l=l<<8|n[w],m+=8;m>r;)m-=r,f+=t[o&l>>m];if(m&&(f+=t[o&l<<r-m]),s)for(;f.length*r&7;)f+="=";return f},Yt=({name:n,prefix:t,bitsPerChar:r,alphabet:s})=>Ha({prefix:t,name:n,encode(o){return ib(o,s,r)},decode(o){return rb(o,s,r,n)}}),nb=Ha({prefix:"\0",name:"identity",encode:n=>Xm(n),decode:n=>Jm(n)}),sb=Object.freeze(Object.defineProperty({__proto__:null,identity:nb},Symbol.toStringTag,{value:"Module"})),ab=Yt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),ob=Object.freeze(Object.defineProperty({__proto__:null,base2:ab},Symbol.toStringTag,{value:"Module"})),cb=Yt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),ub=Object.freeze(Object.defineProperty({__proto__:null,base8:cb},Symbol.toStringTag,{value:"Module"})),hb=ds({prefix:"9",name:"base10",alphabet:"0123456789"}),fb=Object.freeze(Object.defineProperty({__proto__:null,base10:hb},Symbol.toStringTag,{value:"Module"})),lb=Yt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),db=Yt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),pb=Object.freeze(Object.defineProperty({__proto__:null,base16:lb,base16upper:db},Symbol.toStringTag,{value:"Module"})),gb=Yt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),yb=Yt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),vb=Yt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),_b=Yt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),mb=Yt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),bb=Yt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),wb=Yt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Eb=Yt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Db=Yt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),Sb=Object.freeze(Object.defineProperty({__proto__:null,base32:gb,base32hex:mb,base32hexpad:wb,base32hexpadupper:Eb,base32hexupper:bb,base32pad:vb,base32padupper:_b,base32upper:yb,base32z:Db},Symbol.toStringTag,{value:"Module"})),Ib=ds({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),xb=ds({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),Ob=Object.freeze(Object.defineProperty({__proto__:null,base36:Ib,base36upper:xb},Symbol.toStringTag,{value:"Module"})),Ab=ds({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Cb=ds({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),Pb=Object.freeze(Object.defineProperty({__proto__:null,base58btc:Ab,base58flickr:Cb},Symbol.toStringTag,{value:"Module"})),Tb=Yt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Nb=Yt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Ub=Yt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Rb=Yt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),Fb=Object.freeze(Object.defineProperty({__proto__:null,base64:Tb,base64pad:Nb,base64url:Ub,base64urlpad:Rb},Symbol.toStringTag,{value:"Module"})),Ed=Array.from("ðŸš€ðŸªâ˜„ðŸ›°ðŸŒŒðŸŒ‘ðŸŒ’ðŸŒ“ðŸŒ”ðŸŒ•ðŸŒ–ðŸŒ—ðŸŒ˜ðŸŒðŸŒðŸŒŽðŸ‰â˜€ðŸ’»ðŸ–¥ðŸ’¾ðŸ’¿ðŸ˜‚â¤ðŸ˜ðŸ¤£ðŸ˜ŠðŸ™ðŸ’•ðŸ˜­ðŸ˜˜ðŸ‘ðŸ˜…ðŸ‘ðŸ˜ðŸ”¥ðŸ¥°ðŸ’”ðŸ’–ðŸ’™ðŸ˜¢ðŸ¤”ðŸ˜†ðŸ™„ðŸ’ªðŸ˜‰â˜ºðŸ‘ŒðŸ¤—ðŸ’œðŸ˜”ðŸ˜ŽðŸ˜‡ðŸŒ¹ðŸ¤¦ðŸŽ‰ðŸ’žâœŒâœ¨ðŸ¤·ðŸ˜±ðŸ˜ŒðŸŒ¸ðŸ™ŒðŸ˜‹ðŸ’—ðŸ’šðŸ˜ðŸ’›ðŸ™‚ðŸ’“ðŸ¤©ðŸ˜„ðŸ˜€ðŸ–¤ðŸ˜ƒðŸ’¯ðŸ™ˆðŸ‘‡ðŸŽ¶ðŸ˜’ðŸ¤­â£ðŸ˜œðŸ’‹ðŸ‘€ðŸ˜ªðŸ˜‘ðŸ’¥ðŸ™‹ðŸ˜žðŸ˜©ðŸ˜¡ðŸ¤ªðŸ‘ŠðŸ¥³ðŸ˜¥ðŸ¤¤ðŸ‘‰ðŸ’ƒðŸ˜³âœ‹ðŸ˜šðŸ˜ðŸ˜´ðŸŒŸðŸ˜¬ðŸ™ƒðŸ€ðŸŒ·ðŸ˜»ðŸ˜“â­âœ…ðŸ¥ºðŸŒˆðŸ˜ˆðŸ¤˜ðŸ’¦âœ”ðŸ˜£ðŸƒðŸ’â˜¹ðŸŽŠðŸ’˜ðŸ˜ â˜ðŸ˜•ðŸŒºðŸŽ‚ðŸŒ»ðŸ˜ðŸ–•ðŸ’ðŸ™ŠðŸ˜¹ðŸ—£ðŸ’«ðŸ’€ðŸ‘‘ðŸŽµðŸ¤žðŸ˜›ðŸ”´ðŸ˜¤ðŸŒ¼ðŸ˜«âš½ðŸ¤™â˜•ðŸ†ðŸ¤«ðŸ‘ˆðŸ˜®ðŸ™†ðŸ»ðŸƒðŸ¶ðŸ’ðŸ˜²ðŸŒ¿ðŸ§¡ðŸŽâš¡ðŸŒžðŸŽˆâŒâœŠðŸ‘‹ðŸ˜°ðŸ¤¨ðŸ˜¶ðŸ¤ðŸš¶ðŸ’°ðŸ“ðŸ’¢ðŸ¤ŸðŸ™ðŸš¨ðŸ’¨ðŸ¤¬âœˆðŸŽ€ðŸºðŸ¤“ðŸ˜™ðŸ’ŸðŸŒ±ðŸ˜–ðŸ‘¶ðŸ¥´â–¶âž¡â“ðŸ’ŽðŸ’¸â¬‡ðŸ˜¨ðŸŒšðŸ¦‹ðŸ˜·ðŸ•ºâš ðŸ™…ðŸ˜ŸðŸ˜µðŸ‘ŽðŸ¤²ðŸ¤ ðŸ¤§ðŸ“ŒðŸ”µðŸ’…ðŸ§ðŸ¾ðŸ’ðŸ˜—ðŸ¤‘ðŸŒŠðŸ¤¯ðŸ·â˜ŽðŸ’§ðŸ˜¯ðŸ’†ðŸ‘†ðŸŽ¤ðŸ™‡ðŸ‘â„ðŸŒ´ðŸ’£ðŸ¸ðŸ’ŒðŸ“ðŸ¥€ðŸ¤¢ðŸ‘…ðŸ’¡ðŸ’©ðŸ‘ðŸ“¸ðŸ‘»ðŸ¤ðŸ¤®ðŸŽ¼ðŸ¥µðŸš©ðŸŽðŸŠðŸ‘¼ðŸ’ðŸ“£ðŸ¥‚"),$b=Ed.reduce((n,t,r)=>(n[r]=t,n),[]),Lb=Ed.reduce((n,t,r)=>(n[t.codePointAt(0)]=r,n),[]);function Mb(n){return n.reduce((t,r)=>(t+=$b[r],t),"")}function jb(n){const t=[];for(const r of n){const s=Lb[r.codePointAt(0)];if(s===void 0)throw new Error(`Non-base256emoji character: ${r}`);t.push(s)}return new Uint8Array(t)}const qb=Ha({prefix:"ðŸš€",name:"base256emoji",encode:Mb,decode:jb}),Bb=Object.freeze(Object.defineProperty({__proto__:null,base256emoji:qb},Symbol.toStringTag,{value:"Module"}));new TextEncoder;new TextDecoder;const Ff={...sb,...ob,...ub,...fb,...pb,...Sb,...Ob,...Pb,...Fb,...Bb};function Dd(n,t,r,s){return{name:n,prefix:t,encoder:{name:n,prefix:t,encode:r},decoder:{decode:s}}}const $f=Dd("utf8","u",n=>"u"+new TextDecoder("utf8").decode(n),n=>new TextEncoder().encode(n.substring(1))),_c=Dd("ascii","a",n=>{let t="a";for(let r=0;r<n.length;r++)t+=String.fromCharCode(n[r]);return t},n=>{n=n.substring(1);const t=bd(n.length);for(let r=0;r<n.length;r++)t[r]=n.charCodeAt(r);return t}),Sd={utf8:$f,"utf-8":$f,hex:Ff.base16,latin1:_c,ascii:_c,binary:_c,...Ff};function vr(n,t="utf8"){const r=Sd[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?pu(globalThis.Buffer.from(n,"utf-8")):r.decoder.decode(`${r.prefix}${n}`)}function ur(n,t="utf8"){const r=Sd[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(n.buffer,n.byteOffset,n.byteLength).toString("utf8"):r.encoder.encode(n).substring(1)}var Lf=globalThis&&globalThis.__spreadArray||function(n,t,r){if(r||arguments.length===2)for(var s=0,o=t.length,f;s<o;s++)(f||!(s in t))&&(f||(f=Array.prototype.slice.call(t,0,s)),f[s]=t[s]);return n.concat(f||Array.prototype.slice.call(t))},zb=function(){function n(t,r,s){this.name=t,this.version=r,this.os=s,this.type="browser"}return n}(),Hb=function(){function n(t){this.version=t,this.type="node",this.name="node",this.os=Zi.platform}return n}(),Kb=function(){function n(t,r,s,o){this.name=t,this.version=r,this.os=s,this.bot=o,this.type="bot-device"}return n}(),Vb=function(){function n(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}return n}(),kb=function(){function n(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}return n}(),Wb=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,Gb=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,Mf=3,Yb=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",Wb]],jf=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function Jb(n){return n?qf(n):typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"?new kb:typeof navigator<"u"?qf(navigator.userAgent):Zb()}function Xb(n){return n!==""&&Yb.reduce(function(t,r){var s=r[0],o=r[1];if(t)return t;var f=o.exec(n);return!!f&&[s,f]},!1)}function qf(n){var t=Xb(n);if(!t)return null;var r=t[0],s=t[1];if(r==="searchbot")return new Vb;var o=s[1]&&s[1].split(".").join("_").split("_").slice(0,3);o?o.length<Mf&&(o=Lf(Lf([],o,!0),ew(Mf-o.length),!0)):o=[];var f=o.join("."),m=Qb(n),l=Gb.exec(n);return l&&l[1]?new Kb(r,f,m,l[1]):new zb(r,f,m)}function Qb(n){for(var t=0,r=jf.length;t<r;t++){var s=jf[t],o=s[0],f=s[1],m=f.exec(n);if(m)return o}return null}function Zb(){var n=typeof Zi<"u"&&Zi.version;return n?new Hb(Zi.version.slice(1)):null}function ew(n){for(var t=[],r=0;r<n;r++)t.push("0");return t}var _e={},mc={},Xn={},Bf;function tw(){if(Bf)return Xn;Bf=1,Object.defineProperty(Xn,"__esModule",{value:!0}),Xn.delay=void 0;function n(t){return new Promise(r=>{setTimeout(()=>{r(!0)},t)})}return Xn.delay=n,Xn}var Wi={},bc={},Gi={},zf;function rw(){return zf||(zf=1,Object.defineProperty(Gi,"__esModule",{value:!0}),Gi.ONE_THOUSAND=Gi.ONE_HUNDRED=void 0,Gi.ONE_HUNDRED=100,Gi.ONE_THOUSAND=1e3),Gi}var wc={},Hf;function iw(){return Hf||(Hf=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.ONE_YEAR=n.FOUR_WEEKS=n.THREE_WEEKS=n.TWO_WEEKS=n.ONE_WEEK=n.THIRTY_DAYS=n.SEVEN_DAYS=n.FIVE_DAYS=n.THREE_DAYS=n.ONE_DAY=n.TWENTY_FOUR_HOURS=n.TWELVE_HOURS=n.SIX_HOURS=n.THREE_HOURS=n.ONE_HOUR=n.SIXTY_MINUTES=n.THIRTY_MINUTES=n.TEN_MINUTES=n.FIVE_MINUTES=n.ONE_MINUTE=n.SIXTY_SECONDS=n.THIRTY_SECONDS=n.TEN_SECONDS=n.FIVE_SECONDS=n.ONE_SECOND=void 0,n.ONE_SECOND=1,n.FIVE_SECONDS=5,n.TEN_SECONDS=10,n.THIRTY_SECONDS=30,n.SIXTY_SECONDS=60,n.ONE_MINUTE=n.SIXTY_SECONDS,n.FIVE_MINUTES=n.ONE_MINUTE*5,n.TEN_MINUTES=n.ONE_MINUTE*10,n.THIRTY_MINUTES=n.ONE_MINUTE*30,n.SIXTY_MINUTES=n.ONE_MINUTE*60,n.ONE_HOUR=n.SIXTY_MINUTES,n.THREE_HOURS=n.ONE_HOUR*3,n.SIX_HOURS=n.ONE_HOUR*6,n.TWELVE_HOURS=n.ONE_HOUR*12,n.TWENTY_FOUR_HOURS=n.ONE_HOUR*24,n.ONE_DAY=n.TWENTY_FOUR_HOURS,n.THREE_DAYS=n.ONE_DAY*3,n.FIVE_DAYS=n.ONE_DAY*5,n.SEVEN_DAYS=n.ONE_DAY*7,n.THIRTY_DAYS=n.ONE_DAY*30,n.ONE_WEEK=n.SEVEN_DAYS,n.TWO_WEEKS=n.ONE_WEEK*2,n.THREE_WEEKS=n.ONE_WEEK*3,n.FOUR_WEEKS=n.ONE_WEEK*4,n.ONE_YEAR=n.ONE_DAY*365}(wc)),wc}var Kf;function Id(){return Kf||(Kf=1,function(n){Object.defineProperty(n,"__esModule",{value:!0});const t=Vr;t.__exportStar(rw(),n),t.__exportStar(iw(),n)}(bc)),bc}var Vf;function nw(){if(Vf)return Wi;Vf=1,Object.defineProperty(Wi,"__esModule",{value:!0}),Wi.fromMiliseconds=Wi.toMiliseconds=void 0;const n=Id();function t(s){return s*n.ONE_THOUSAND}Wi.toMiliseconds=t;function r(s){return Math.floor(s/n.ONE_THOUSAND)}return Wi.fromMiliseconds=r,Wi}var kf;function sw(){return kf||(kf=1,function(n){Object.defineProperty(n,"__esModule",{value:!0});const t=Vr;t.__exportStar(tw(),n),t.__exportStar(nw(),n)}(mc)),mc}var In={},Wf;function aw(){if(Wf)return In;Wf=1,Object.defineProperty(In,"__esModule",{value:!0}),In.Watch=void 0;class n{constructor(){this.timestamps=new Map}start(r){if(this.timestamps.has(r))throw new Error(`Watch already started for label: ${r}`);this.timestamps.set(r,{started:Date.now()})}stop(r){const s=this.get(r);if(typeof s.elapsed<"u")throw new Error(`Watch already stopped for label: ${r}`);const o=Date.now()-s.started;this.timestamps.set(r,{started:s.started,elapsed:o})}get(r){const s=this.timestamps.get(r);if(typeof s>"u")throw new Error(`No timestamp found for label: ${r}`);return s}elapsed(r){const s=this.get(r);return s.elapsed||Date.now()-s.started}}return In.Watch=n,In.default=n,In}var Ec={},Qn={},Gf;function ow(){if(Gf)return Qn;Gf=1,Object.defineProperty(Qn,"__esModule",{value:!0}),Qn.IWatch=void 0;class n{}return Qn.IWatch=n,Qn}var Yf;function cw(){return Yf||(Yf=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),Vr.__exportStar(ow(),n)}(Ec)),Ec}(function(n){Object.defineProperty(n,"__esModule",{value:!0});const t=Vr;t.__exportStar(sw(),n),t.__exportStar(aw(),n),t.__exportStar(cw(),n),t.__exportStar(Id(),n)})(_e);var ft={};Object.defineProperty(ft,"__esModule",{value:!0});ft.getLocalStorage=ft.getLocalStorageOrThrow=ft.getCrypto=ft.getCryptoOrThrow=Od=ft.getLocation=ft.getLocationOrThrow=gu=ft.getNavigator=ft.getNavigatorOrThrow=xd=ft.getDocument=ft.getDocumentOrThrow=ft.getFromWindowOrThrow=ft.getFromWindow=void 0;function en(n){let t;return typeof window<"u"&&typeof window[n]<"u"&&(t=window[n]),t}ft.getFromWindow=en;function Pn(n){const t=en(n);if(!t)throw new Error(`${n} is not defined in Window`);return t}ft.getFromWindowOrThrow=Pn;function uw(){return Pn("document")}ft.getDocumentOrThrow=uw;function hw(){return en("document")}var xd=ft.getDocument=hw;function fw(){return Pn("navigator")}ft.getNavigatorOrThrow=fw;function lw(){return en("navigator")}var gu=ft.getNavigator=lw;function dw(){return Pn("location")}ft.getLocationOrThrow=dw;function pw(){return en("location")}var Od=ft.getLocation=pw;function gw(){return Pn("crypto")}ft.getCryptoOrThrow=gw;function yw(){return en("crypto")}ft.getCrypto=yw;function vw(){return Pn("localStorage")}ft.getLocalStorageOrThrow=vw;function _w(){return en("localStorage")}ft.getLocalStorage=_w;var yu={};Object.defineProperty(yu,"__esModule",{value:!0});var Ad=yu.getWindowMetadata=void 0;const Jf=ft;function mw(){let n,t;try{n=Jf.getDocumentOrThrow(),t=Jf.getLocationOrThrow()}catch{return null}function r(){const N=n.getElementsByTagName("link"),j=[];for(let R=0;R<N.length;R++){const U=N[R],H=U.getAttribute("rel");if(H&&H.toLowerCase().indexOf("icon")>-1){const K=U.getAttribute("href");if(K)if(K.toLowerCase().indexOf("https:")===-1&&K.toLowerCase().indexOf("http:")===-1&&K.indexOf("//")!==0){let ie=t.protocol+"//"+t.host;if(K.indexOf("/")===0)ie+=K;else{const p=t.pathname.split("/");p.pop();const b=p.join("/");ie+=b+"/"+K}j.push(ie)}else if(K.indexOf("//")===0){const ie=t.protocol+K;j.push(ie)}else j.push(K)}}return j}function s(...N){const j=n.getElementsByTagName("meta");for(let R=0;R<j.length;R++){const U=j[R],H=["itemprop","property","name"].map(K=>U.getAttribute(K)).filter(K=>K?N.includes(K):!1);if(H.length&&H){const K=U.getAttribute("content");if(K)return K}}return""}function o(){let N=s("name","og:site_name","og:title","twitter:title");return N||(N=n.title),N}function f(){return s("description","og:description","twitter:description","keywords")}const m=o(),l=f(),w=t.origin,O=r();return{description:l,url:w,icons:O,name:m}}Ad=yu.getWindowMetadata=mw;var bw={},vu=function(n,t){for(var r={},s=Object.keys(n),o=Array.isArray(t),f=0;f<s.length;f++){var m=s[f],l=n[m];(o?t.indexOf(m)!==-1:t(m,l,n))&&(r[m]=l)}return r};(function(n){const t=au,r=ou,s=su,o=vu,f=p=>p==null,m=Symbol("encodeFragmentIdentifier");function l(p){switch(p.arrayFormat){case"index":return b=>(y,_)=>{const d=y.length;return _===void 0||p.skipNull&&_===null||p.skipEmptyString&&_===""?y:_===null?[...y,[I(b,p),"[",d,"]"].join("")]:[...y,[I(b,p),"[",I(d,p),"]=",I(_,p)].join("")]};case"bracket":return b=>(y,_)=>_===void 0||p.skipNull&&_===null||p.skipEmptyString&&_===""?y:_===null?[...y,[I(b,p),"[]"].join("")]:[...y,[I(b,p),"[]=",I(_,p)].join("")];case"colon-list-separator":return b=>(y,_)=>_===void 0||p.skipNull&&_===null||p.skipEmptyString&&_===""?y:_===null?[...y,[I(b,p),":list="].join("")]:[...y,[I(b,p),":list=",I(_,p)].join("")];case"comma":case"separator":case"bracket-separator":{const b=p.arrayFormat==="bracket-separator"?"[]=":"=";return y=>(_,d)=>d===void 0||p.skipNull&&d===null||p.skipEmptyString&&d===""?_:(d=d===null?"":d,_.length===0?[[I(y,p),b,I(d,p)].join("")]:[[_,I(d,p)].join(p.arrayFormatSeparator)])}default:return b=>(y,_)=>_===void 0||p.skipNull&&_===null||p.skipEmptyString&&_===""?y:_===null?[...y,I(b,p)]:[...y,[I(b,p),"=",I(_,p)].join("")]}}function w(p){let b;switch(p.arrayFormat){case"index":return(y,_,d)=>{if(b=/\[(\d*)\]$/.exec(y),y=y.replace(/\[\d*\]$/,""),!b){d[y]=_;return}d[y]===void 0&&(d[y]={}),d[y][b[1]]=_};case"bracket":return(y,_,d)=>{if(b=/(\[\])$/.exec(y),y=y.replace(/\[\]$/,""),!b){d[y]=_;return}if(d[y]===void 0){d[y]=[_];return}d[y]=[].concat(d[y],_)};case"colon-list-separator":return(y,_,d)=>{if(b=/(:list)$/.exec(y),y=y.replace(/:list$/,""),!b){d[y]=_;return}if(d[y]===void 0){d[y]=[_];return}d[y]=[].concat(d[y],_)};case"comma":case"separator":return(y,_,d)=>{const c=typeof _=="string"&&_.includes(p.arrayFormatSeparator),v=typeof _=="string"&&!c&&N(_,p).includes(p.arrayFormatSeparator);_=v?N(_,p):_;const z=c||v?_.split(p.arrayFormatSeparator).map(G=>N(G,p)):_===null?_:N(_,p);d[y]=z};case"bracket-separator":return(y,_,d)=>{const c=/(\[\])$/.test(y);if(y=y.replace(/\[\]$/,""),!c){d[y]=_&&N(_,p);return}const v=_===null?[]:_.split(p.arrayFormatSeparator).map(z=>N(z,p));if(d[y]===void 0){d[y]=v;return}d[y]=[].concat(d[y],v)};default:return(y,_,d)=>{if(d[y]===void 0){d[y]=_;return}d[y]=[].concat(d[y],_)}}}function O(p){if(typeof p!="string"||p.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function I(p,b){return b.encode?b.strict?t(p):encodeURIComponent(p):p}function N(p,b){return b.decode?r(p):p}function j(p){return Array.isArray(p)?p.sort():typeof p=="object"?j(Object.keys(p)).sort((b,y)=>Number(b)-Number(y)).map(b=>p[b]):p}function R(p){const b=p.indexOf("#");return b!==-1&&(p=p.slice(0,b)),p}function U(p){let b="";const y=p.indexOf("#");return y!==-1&&(b=p.slice(y)),b}function H(p){p=R(p);const b=p.indexOf("?");return b===-1?"":p.slice(b+1)}function K(p,b){return b.parseNumbers&&!Number.isNaN(Number(p))&&typeof p=="string"&&p.trim()!==""?p=Number(p):b.parseBooleans&&p!==null&&(p.toLowerCase()==="true"||p.toLowerCase()==="false")&&(p=p.toLowerCase()==="true"),p}function ie(p,b){b=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},b),O(b.arrayFormatSeparator);const y=w(b),_=Object.create(null);if(typeof p!="string"||(p=p.trim().replace(/^[?#&]/,""),!p))return _;for(const d of p.split("&")){if(d==="")continue;let[c,v]=s(b.decode?d.replace(/\+/g," "):d,"=");v=v===void 0?null:["comma","separator","bracket-separator"].includes(b.arrayFormat)?v:N(v,b),y(N(c,b),v,_)}for(const d of Object.keys(_)){const c=_[d];if(typeof c=="object"&&c!==null)for(const v of Object.keys(c))c[v]=K(c[v],b);else _[d]=K(c,b)}return b.sort===!1?_:(b.sort===!0?Object.keys(_).sort():Object.keys(_).sort(b.sort)).reduce((d,c)=>{const v=_[c];return v&&typeof v=="object"&&!Array.isArray(v)?d[c]=j(v):d[c]=v,d},Object.create(null))}n.extract=H,n.parse=ie,n.stringify=(p,b)=>{if(!p)return"";b=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},b),O(b.arrayFormatSeparator);const y=v=>b.skipNull&&f(p[v])||b.skipEmptyString&&p[v]==="",_=l(b),d={};for(const v of Object.keys(p))y(v)||(d[v]=p[v]);const c=Object.keys(d);return b.sort!==!1&&c.sort(b.sort),c.map(v=>{const z=p[v];return z===void 0?"":z===null?I(v,b):Array.isArray(z)?z.length===0&&b.arrayFormat==="bracket-separator"?I(v,b)+"[]":z.reduce(_(v),[]).join("&"):I(v,b)+"="+I(z,b)}).filter(v=>v.length>0).join("&")},n.parseUrl=(p,b)=>{b=Object.assign({decode:!0},b);const[y,_]=s(p,"#");return Object.assign({url:y.split("?")[0]||"",query:ie(H(p),b)},b&&b.parseFragmentIdentifier&&_?{fragmentIdentifier:N(_,b)}:{})},n.stringifyUrl=(p,b)=>{b=Object.assign({encode:!0,strict:!0,[m]:!0},b);const y=R(p.url).split("?")[0]||"",_=n.extract(p.url),d=n.parse(_,{sort:!1}),c=Object.assign(d,p.query);let v=n.stringify(c,b);v&&(v=`?${v}`);let z=U(p.url);return p.fragmentIdentifier&&(z=`#${b[m]?I(p.fragmentIdentifier,b):p.fragmentIdentifier}`),`${y}${v}${z}`},n.pick=(p,b,y)=>{y=Object.assign({parseFragmentIdentifier:!0,[m]:!1},y);const{url:_,query:d,fragmentIdentifier:c}=n.parseUrl(p,y);return n.stringifyUrl({url:_,query:o(d,b),fragmentIdentifier:c},y)},n.exclude=(p,b,y)=>{const _=Array.isArray(b)?d=>!b.includes(d):(d,c)=>!b(d,c);return n.pick(p,_,y)}})(bw);const ww={waku:{publish:"waku_publish",batchPublish:"waku_batchPublish",subscribe:"waku_subscribe",batchSubscribe:"waku_batchSubscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe",batchUnsubscribe:"waku_batchUnsubscribe"},irn:{publish:"irn_publish",batchPublish:"irn_batchPublish",subscribe:"irn_subscribe",batchSubscribe:"irn_batchSubscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe",batchUnsubscribe:"irn_batchUnsubscribe"},iridium:{publish:"iridium_publish",batchPublish:"iridium_batchPublish",subscribe:"iridium_subscribe",batchSubscribe:"iridium_batchSubscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe",batchUnsubscribe:"iridium_batchUnsubscribe"}};function Ew(n,t=[]){const r=[];return Object.keys(n).forEach(s=>{if(t.length&&!t.includes(s))return;const o=n[s];r.push(...o.accounts)}),r}const Dw={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}};function Sw(n,t){const{message:r,code:s}=Dw[n];return{message:t?`${r} ${t}`:r,code:s}}function Vc(n,t){return Array.isArray(n)?typeof t<"u"&&n.length?n.every(t):!0:!1}var Ka={},ps={};Object.defineProperty(ps,"__esModule",{value:!0});function Iw(n){if(typeof n!="string")throw new Error(`Cannot safe json parse value of type ${typeof n}`);try{return JSON.parse(n)}catch{return n}}ps.safeJsonParse=Iw;function xw(n){return typeof n=="string"?n:JSON.stringify(n,(t,r)=>typeof r>"u"?null:r)}ps.safeJsonStringify=xw;var Zn={exports:{}},Xf;function Ow(){return Xf||(Xf=1,function(){let n;function t(){}n=t,n.prototype.getItem=function(r){return this.hasOwnProperty(r)?String(this[r]):null},n.prototype.setItem=function(r,s){this[r]=String(s)},n.prototype.removeItem=function(r){delete this[r]},n.prototype.clear=function(){const r=this;Object.keys(r).forEach(function(s){r[s]=void 0,delete r[s]})},n.prototype.key=function(r){return r=r||0,Object.keys(this)[r]},n.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof Oi<"u"&&Oi.localStorage?Zn.exports=Oi.localStorage:typeof window<"u"&&window.localStorage?Zn.exports=window.localStorage:Zn.exports=new t}()),Zn.exports}var Dc={},es={},Qf;function Aw(){if(Qf)return es;Qf=1,Object.defineProperty(es,"__esModule",{value:!0}),es.IKeyValueStorage=void 0;class n{}return es.IKeyValueStorage=n,es}var ts={},Zf;function Cw(){if(Zf)return ts;Zf=1,Object.defineProperty(ts,"__esModule",{value:!0}),ts.parseEntry=void 0;const n=ps;function t(r){var s;return[r[0],n.safeJsonParse((s=r[1])!==null&&s!==void 0?s:"")]}return ts.parseEntry=t,ts}var el;function Pw(){return el||(el=1,function(n){Object.defineProperty(n,"__esModule",{value:!0});const t=Vr;t.__exportStar(Aw(),n),t.__exportStar(Cw(),n)}(Dc)),Dc}Object.defineProperty(Ka,"__esModule",{value:!0});Ka.KeyValueStorage=void 0;const xn=Vr,tl=ps,Tw=xn.__importDefault(Ow()),Nw=Pw();class Cd{constructor(){this.localStorage=Tw.default}getKeys(){return xn.__awaiter(this,void 0,void 0,function*(){return Object.keys(this.localStorage)})}getEntries(){return xn.__awaiter(this,void 0,void 0,function*(){return Object.entries(this.localStorage).map(Nw.parseEntry)})}getItem(t){return xn.__awaiter(this,void 0,void 0,function*(){const r=this.localStorage.getItem(t);if(r!==null)return tl.safeJsonParse(r)})}setItem(t,r){return xn.__awaiter(this,void 0,void 0,function*(){this.localStorage.setItem(t,tl.safeJsonStringify(r))})}removeItem(t){return xn.__awaiter(this,void 0,void 0,function*(){this.localStorage.removeItem(t)})}}Ka.KeyValueStorage=Cd;var Uw=Ka.default=Cd,gs={},rs={},Sc={},is={};class tn{}const Rw=Object.freeze(Object.defineProperty({__proto__:null,IEvents:tn},Symbol.toStringTag,{value:"Module"})),Fw=G_(Rw);var rl;function $w(){if(rl)return is;rl=1,Object.defineProperty(is,"__esModule",{value:!0}),is.IHeartBeat=void 0;const n=Fw;class t extends n.IEvents{constructor(s){super()}}return is.IHeartBeat=t,is}var il;function Pd(){return il||(il=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),Vr.__exportStar($w(),n)}(Sc)),Sc}var Ic={},Yi={},nl;function Lw(){if(nl)return Yi;nl=1,Object.defineProperty(Yi,"__esModule",{value:!0}),Yi.HEARTBEAT_EVENTS=Yi.HEARTBEAT_INTERVAL=void 0;const n=_e;return Yi.HEARTBEAT_INTERVAL=n.FIVE_SECONDS,Yi.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"},Yi}var sl;function Td(){return sl||(sl=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),Vr.__exportStar(Lw(),n)}(Ic)),Ic}var al;function Mw(){if(al)return rs;al=1,Object.defineProperty(rs,"__esModule",{value:!0}),rs.HeartBeat=void 0;const n=Vr,t=Lr,r=_e,s=Pd(),o=Td();class f extends s.IHeartBeat{constructor(l){super(l),this.events=new t.EventEmitter,this.interval=o.HEARTBEAT_INTERVAL,this.interval=(l==null?void 0:l.interval)||o.HEARTBEAT_INTERVAL}static init(l){return n.__awaiter(this,void 0,void 0,function*(){const w=new f(l);return yield w.init(),w})}init(){return n.__awaiter(this,void 0,void 0,function*(){yield this.initialize()})}stop(){clearInterval(this.intervalRef)}on(l,w){this.events.on(l,w)}once(l,w){this.events.once(l,w)}off(l,w){this.events.off(l,w)}removeListener(l,w){this.events.removeListener(l,w)}initialize(){return n.__awaiter(this,void 0,void 0,function*(){this.intervalRef=setInterval(()=>this.pulse(),r.toMiliseconds(this.interval))})}pulse(){this.events.emit(o.HEARTBEAT_EVENTS.pulse)}}return rs.HeartBeat=f,rs}(function(n){Object.defineProperty(n,"__esModule",{value:!0});const t=Vr;t.__exportStar(Mw(),n),t.__exportStar(Pd(),n),t.__exportStar(Td(),n)})(gs);var Ze={},xc,ol;function jw(){if(ol)return xc;ol=1;function n(r){try{return JSON.stringify(r)}catch{return'"[Circular]"'}}xc=t;function t(r,s,o){var f=o&&o.stringify||n,m=1;if(typeof r=="object"&&r!==null){var l=s.length+m;if(l===1)return r;var w=new Array(l);w[0]=f(r);for(var O=1;O<l;O++)w[O]=f(s[O]);return w.join(" ")}if(typeof r!="string")return r;var I=s.length;if(I===0)return r;for(var N="",j=1-m,R=-1,U=r&&r.length||0,H=0;H<U;){if(r.charCodeAt(H)===37&&H+1<U){switch(R=R>-1?R:0,r.charCodeAt(H+1)){case 100:case 102:if(j>=I||s[j]==null)break;R<H&&(N+=r.slice(R,H)),N+=Number(s[j]),R=H+2,H++;break;case 105:if(j>=I||s[j]==null)break;R<H&&(N+=r.slice(R,H)),N+=Math.floor(Number(s[j])),R=H+2,H++;break;case 79:case 111:case 106:if(j>=I||s[j]===void 0)break;R<H&&(N+=r.slice(R,H));var K=typeof s[j];if(K==="string"){N+="'"+s[j]+"'",R=H+2,H++;break}if(K==="function"){N+=s[j].name||"<anonymous>",R=H+2,H++;break}N+=f(s[j]),R=H+2,H++;break;case 115:if(j>=I)break;R<H&&(N+=r.slice(R,H)),N+=String(s[j]),R=H+2,H++;break;case 37:R<H&&(N+=r.slice(R,H)),N+="%",R=H+2,H++,j--;break}++j}++H}return R===-1?r:(R<U&&(N+=r.slice(R)),N)}return xc}var Oc,cl;function qw(){if(cl)return Oc;cl=1;const n=jw();Oc=o;const t=_().console||{},r={mapHttpRequest:U,mapHttpResponse:U,wrapRequestSerializer:H,wrapResponseSerializer:H,wrapErrorSerializer:H,req:U,res:U,err:j};function s(d,c){return Array.isArray(d)?d.filter(function(z){return z!=="!stdSerializers.err"}):d===!0?Object.keys(c):!1}function o(d){d=d||{},d.browser=d.browser||{};const c=d.browser.transmit;if(c&&typeof c.send!="function")throw Error("pino: transmit option must have a send function");const v=d.browser.write||t;d.browser.write&&(d.browser.asObject=!0);const z=d.serializers||{},G=s(d.browser.serialize,z);let se=d.browser.serialize;Array.isArray(d.browser.serialize)&&d.browser.serialize.indexOf("!stdSerializers.err")>-1&&(se=!1);const ce=["error","fatal","warn","info","debug","trace"];typeof v=="function"&&(v.error=v.fatal=v.warn=v.info=v.debug=v.trace=v),d.enabled===!1&&(d.level="silent");const de=d.level||"info",S=Object.create(v);S.log||(S.log=K),Object.defineProperty(S,"levelVal",{get:ee}),Object.defineProperty(S,"level",{get:X,set:k});const C={transmit:c,serialize:G,asObject:d.browser.asObject,levels:ce,timestamp:R(d)};S.levels=o.levels,S.level=de,S.setMaxListeners=S.getMaxListeners=S.emit=S.addListener=S.on=S.prependListener=S.once=S.prependOnceListener=S.removeListener=S.removeAllListeners=S.listeners=S.listenerCount=S.eventNames=S.write=S.flush=K,S.serializers=z,S._serialize=G,S._stdErrSerialize=se,S.child=W,c&&(S._logEvent=N());function ee(){return this.level==="silent"?1/0:this.levels.values[this.level]}function X(){return this._level}function k(J){if(J!=="silent"&&!this.levels.values[J])throw Error("unknown level "+J);this._level=J,f(C,S,"error","log"),f(C,S,"fatal","error"),f(C,S,"warn","error"),f(C,S,"info","log"),f(C,S,"debug","log"),f(C,S,"trace","log")}function W(J,re){if(!J)throw new Error("missing bindings for child Pino");re=re||{},G&&J.serializers&&(re.serializers=J.serializers);const be=re.serializers;if(G&&be){var ae=Object.assign({},z,be),we=d.browser.serialize===!0?Object.keys(ae):G;delete J.serializers,w([J],we,ae,this._stdErrSerialize)}function fe(ve){this._childLevel=(ve._childLevel|0)+1,this.error=O(ve,J,"error"),this.fatal=O(ve,J,"fatal"),this.warn=O(ve,J,"warn"),this.info=O(ve,J,"info"),this.debug=O(ve,J,"debug"),this.trace=O(ve,J,"trace"),ae&&(this.serializers=ae,this._serialize=we),c&&(this._logEvent=N([].concat(ve._logEvent.bindings,J)))}return fe.prototype=this,new fe(this)}return S}o.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},o.stdSerializers=r,o.stdTimeFunctions=Object.assign({},{nullTime:ie,epochTime:p,unixTime:b,isoTime:y});function f(d,c,v,z){const G=Object.getPrototypeOf(c);c[v]=c.levelVal>c.levels.values[v]?K:G[v]?G[v]:t[v]||t[z]||K,m(d,c,v)}function m(d,c,v){!d.transmit&&c[v]===K||(c[v]=function(z){return function(){const se=d.timestamp(),ce=new Array(arguments.length),de=Object.getPrototypeOf&&Object.getPrototypeOf(this)===t?t:this;for(var S=0;S<ce.length;S++)ce[S]=arguments[S];if(d.serialize&&!d.asObject&&w(ce,this._serialize,this.serializers,this._stdErrSerialize),d.asObject?z.call(de,l(this,v,ce,se)):z.apply(de,ce),d.transmit){const C=d.transmit.level||c.level,ee=o.levels.values[C],X=o.levels.values[v];if(X<ee)return;I(this,{ts:se,methodLevel:v,methodValue:X,transmitLevel:C,transmitValue:o.levels.values[d.transmit.level||c.level],send:d.transmit.send,val:c.levelVal},ce)}}}(c[v]))}function l(d,c,v,z){d._serialize&&w(v,d._serialize,d.serializers,d._stdErrSerialize);const G=v.slice();let se=G[0];const ce={};z&&(ce.time=z),ce.level=o.levels.values[c];let de=(d._childLevel|0)+1;if(de<1&&(de=1),se!==null&&typeof se=="object"){for(;de--&&typeof G[0]=="object";)Object.assign(ce,G.shift());se=G.length?n(G.shift(),G):void 0}else typeof se=="string"&&(se=n(G.shift(),G));return se!==void 0&&(ce.msg=se),ce}function w(d,c,v,z){for(const G in d)if(z&&d[G]instanceof Error)d[G]=o.stdSerializers.err(d[G]);else if(typeof d[G]=="object"&&!Array.isArray(d[G]))for(const se in d[G])c&&c.indexOf(se)>-1&&se in v&&(d[G][se]=v[se](d[G][se]))}function O(d,c,v){return function(){const z=new Array(1+arguments.length);z[0]=c;for(var G=1;G<z.length;G++)z[G]=arguments[G-1];return d[v].apply(this,z)}}function I(d,c,v){const z=c.send,G=c.ts,se=c.methodLevel,ce=c.methodValue,de=c.val,S=d._logEvent.bindings;w(v,d._serialize||Object.keys(d.serializers),d.serializers,d._stdErrSerialize===void 0?!0:d._stdErrSerialize),d._logEvent.ts=G,d._logEvent.messages=v.filter(function(C){return S.indexOf(C)===-1}),d._logEvent.level.label=se,d._logEvent.level.value=ce,z(se,d._logEvent,de),d._logEvent=N(S)}function N(d){return{ts:0,messages:[],bindings:d||[],level:{label:"",value:0}}}function j(d){const c={type:d.constructor.name,msg:d.message,stack:d.stack};for(const v in d)c[v]===void 0&&(c[v]=d[v]);return c}function R(d){return typeof d.timestamp=="function"?d.timestamp:d.timestamp===!1?ie:p}function U(){return{}}function H(d){return d}function K(){}function ie(){return!1}function p(){return Date.now()}function b(){return Math.round(Date.now()/1e3)}function y(){return new Date(Date.now()).toISOString()}function _(){function d(c){return typeof c<"u"&&c}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return d(self)||d(window)||d(this)||{}}}return Oc}var Ji={},ul;function Nd(){return ul||(ul=1,Object.defineProperty(Ji,"__esModule",{value:!0}),Ji.PINO_CUSTOM_CONTEXT_KEY=Ji.PINO_LOGGER_DEFAULTS=void 0,Ji.PINO_LOGGER_DEFAULTS={level:"info"},Ji.PINO_CUSTOM_CONTEXT_KEY="custom_context"),Ji}var ar={},hl;function Bw(){if(hl)return ar;hl=1,Object.defineProperty(ar,"__esModule",{value:!0}),ar.generateChildLogger=ar.formatChildLoggerContext=ar.getLoggerContext=ar.setBrowserLoggerContext=ar.getBrowserLoggerContext=ar.getDefaultLoggerOptions=void 0;const n=Nd();function t(l){return Object.assign(Object.assign({},l),{level:(l==null?void 0:l.level)||n.PINO_LOGGER_DEFAULTS.level})}ar.getDefaultLoggerOptions=t;function r(l,w=n.PINO_CUSTOM_CONTEXT_KEY){return l[w]||""}ar.getBrowserLoggerContext=r;function s(l,w,O=n.PINO_CUSTOM_CONTEXT_KEY){return l[O]=w,l}ar.setBrowserLoggerContext=s;function o(l,w=n.PINO_CUSTOM_CONTEXT_KEY){let O="";return typeof l.bindings>"u"?O=r(l,w):O=l.bindings().context||"",O}ar.getLoggerContext=o;function f(l,w,O=n.PINO_CUSTOM_CONTEXT_KEY){const I=o(l,O);return I.trim()?`${I}/${w}`:w}ar.formatChildLoggerContext=f;function m(l,w,O=n.PINO_CUSTOM_CONTEXT_KEY){const I=f(l,w,O),N=l.child({context:I});return s(N,I,O)}return ar.generateChildLogger=m,ar}(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.pino=void 0;const t=Vr,r=t.__importDefault(qw());Object.defineProperty(n,"pino",{enumerable:!0,get:function(){return r.default}}),t.__exportStar(Nd(),n),t.__exportStar(Bw(),n)})(Ze);class zw extends tn{constructor(t){super(),this.opts=t,this.protocol="wc",this.version=2}}class Hw extends tn{constructor(t,r){super(),this.core=t,this.logger=r,this.records=new Map}}class Kw{constructor(t,r){this.logger=t,this.core=r}}let Vw=class extends tn{constructor(t,r){super(),this.relayer=t,this.logger=r}},kw=class extends tn{constructor(t){super()}},Ww=class{constructor(t,r,s,o){this.core=t,this.logger=r,this.name=s}};class Gw extends tn{constructor(t,r){super(),this.relayer=t,this.logger=r}}class Yw extends tn{constructor(t,r){super(),this.core=t,this.logger=r}}let Jw=class{constructor(t,r){this.projectId=t,this.logger=r}},Xw=class{constructor(t){this.opts=t,this.protocol="wc",this.version=2}},Qw=class{constructor(t){this.client=t}};const Zw=n=>JSON.stringify(n,(t,r)=>typeof r=="bigint"?r.toString()+"n":r),eE=n=>{const t=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,r=n.replace(t,'$1"$2n"$3');return JSON.parse(r,(s,o)=>typeof o=="string"&&o.match(/^\d+n$/)?BigInt(o.substring(0,o.length-1)):o)};function _u(n){if(typeof n!="string")throw new Error(`Cannot safe json parse value of type ${typeof n}`);try{return eE(n)}catch{return n}}function hs(n){return typeof n=="string"?n:Zw(n)||""}var mu={},Ud={};(function(n){Object.defineProperty(n,"__esModule",{value:!0});var t=$e,r=Sr;n.DIGEST_LENGTH=64,n.BLOCK_SIZE=128;var s=function(){function l(){this.digestLength=n.DIGEST_LENGTH,this.blockSize=n.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return l.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},l.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},l.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._tempHi),r.wipe(this._tempLo),this.reset()},l.prototype.update=function(w,O){if(O===void 0&&(O=w.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var I=0;if(this._bytesHashed+=O,this._bufferLength>0){for(;this._bufferLength<n.BLOCK_SIZE&&O>0;)this._buffer[this._bufferLength++]=w[I++],O--;this._bufferLength===this.blockSize&&(f(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(O>=this.blockSize&&(I=f(this._tempHi,this._tempLo,this._stateHi,this._stateLo,w,I,O),O%=this.blockSize);O>0;)this._buffer[this._bufferLength++]=w[I++],O--;return this},l.prototype.finish=function(w){if(!this._finished){var O=this._bytesHashed,I=this._bufferLength,N=O/536870912|0,j=O<<3,R=O%128<112?128:256;this._buffer[I]=128;for(var U=I+1;U<R-8;U++)this._buffer[U]=0;t.writeUint32BE(N,this._buffer,R-8),t.writeUint32BE(j,this._buffer,R-4),f(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,R),this._finished=!0}for(var U=0;U<this.digestLength/8;U++)t.writeUint32BE(this._stateHi[U],w,U*8),t.writeUint32BE(this._stateLo[U],w,U*8+4);return this},l.prototype.digest=function(){var w=new Uint8Array(this.digestLength);return this.finish(w),w},l.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},l.prototype.restoreState=function(w){return this._stateHi.set(w.stateHi),this._stateLo.set(w.stateLo),this._bufferLength=w.bufferLength,w.buffer&&this._buffer.set(w.buffer),this._bytesHashed=w.bytesHashed,this._finished=!1,this},l.prototype.cleanSavedState=function(w){r.wipe(w.stateHi),r.wipe(w.stateLo),w.buffer&&r.wipe(w.buffer),w.bufferLength=0,w.bytesHashed=0},l}();n.SHA512=s;var o=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function f(l,w,O,I,N,j,R){for(var U=O[0],H=O[1],K=O[2],ie=O[3],p=O[4],b=O[5],y=O[6],_=O[7],d=I[0],c=I[1],v=I[2],z=I[3],G=I[4],se=I[5],ce=I[6],de=I[7],S,C,ee,X,k,W,J,re;R>=128;){for(var be=0;be<16;be++){var ae=8*be+j;l[be]=t.readUint32BE(N,ae),w[be]=t.readUint32BE(N,ae+4)}for(var be=0;be<80;be++){var we=U,fe=H,ve=K,B=ie,q=p,F=b,h=y,P=_,oe=d,le=c,Ie=v,ze=z,Ve=G,Le=se,pt=ce,gt=de;if(S=_,C=de,k=C&65535,W=C>>>16,J=S&65535,re=S>>>16,S=(p>>>14|G<<32-14)^(p>>>18|G<<32-18)^(G>>>41-32|p<<32-(41-32)),C=(G>>>14|p<<32-14)^(G>>>18|p<<32-18)^(p>>>41-32|G<<32-(41-32)),k+=C&65535,W+=C>>>16,J+=S&65535,re+=S>>>16,S=p&b^~p&y,C=G&se^~G&ce,k+=C&65535,W+=C>>>16,J+=S&65535,re+=S>>>16,S=o[be*2],C=o[be*2+1],k+=C&65535,W+=C>>>16,J+=S&65535,re+=S>>>16,S=l[be%16],C=w[be%16],k+=C&65535,W+=C>>>16,J+=S&65535,re+=S>>>16,W+=k>>>16,J+=W>>>16,re+=J>>>16,ee=J&65535|re<<16,X=k&65535|W<<16,S=ee,C=X,k=C&65535,W=C>>>16,J=S&65535,re=S>>>16,S=(U>>>28|d<<32-28)^(d>>>34-32|U<<32-(34-32))^(d>>>39-32|U<<32-(39-32)),C=(d>>>28|U<<32-28)^(U>>>34-32|d<<32-(34-32))^(U>>>39-32|d<<32-(39-32)),k+=C&65535,W+=C>>>16,J+=S&65535,re+=S>>>16,S=U&H^U&K^H&K,C=d&c^d&v^c&v,k+=C&65535,W+=C>>>16,J+=S&65535,re+=S>>>16,W+=k>>>16,J+=W>>>16,re+=J>>>16,P=J&65535|re<<16,gt=k&65535|W<<16,S=B,C=ze,k=C&65535,W=C>>>16,J=S&65535,re=S>>>16,S=ee,C=X,k+=C&65535,W+=C>>>16,J+=S&65535,re+=S>>>16,W+=k>>>16,J+=W>>>16,re+=J>>>16,B=J&65535|re<<16,ze=k&65535|W<<16,H=we,K=fe,ie=ve,p=B,b=q,y=F,_=h,U=P,c=oe,v=le,z=Ie,G=ze,se=Ve,ce=Le,de=pt,d=gt,be%16===15)for(var ae=0;ae<16;ae++)S=l[ae],C=w[ae],k=C&65535,W=C>>>16,J=S&65535,re=S>>>16,S=l[(ae+9)%16],C=w[(ae+9)%16],k+=C&65535,W+=C>>>16,J+=S&65535,re+=S>>>16,ee=l[(ae+1)%16],X=w[(ae+1)%16],S=(ee>>>1|X<<32-1)^(ee>>>8|X<<32-8)^ee>>>7,C=(X>>>1|ee<<32-1)^(X>>>8|ee<<32-8)^(X>>>7|ee<<32-7),k+=C&65535,W+=C>>>16,J+=S&65535,re+=S>>>16,ee=l[(ae+14)%16],X=w[(ae+14)%16],S=(ee>>>19|X<<32-19)^(X>>>61-32|ee<<32-(61-32))^ee>>>6,C=(X>>>19|ee<<32-19)^(ee>>>61-32|X<<32-(61-32))^(X>>>6|ee<<32-6),k+=C&65535,W+=C>>>16,J+=S&65535,re+=S>>>16,W+=k>>>16,J+=W>>>16,re+=J>>>16,l[ae]=J&65535|re<<16,w[ae]=k&65535|W<<16}S=U,C=d,k=C&65535,W=C>>>16,J=S&65535,re=S>>>16,S=O[0],C=I[0],k+=C&65535,W+=C>>>16,J+=S&65535,re+=S>>>16,W+=k>>>16,J+=W>>>16,re+=J>>>16,O[0]=U=J&65535|re<<16,I[0]=d=k&65535|W<<16,S=H,C=c,k=C&65535,W=C>>>16,J=S&65535,re=S>>>16,S=O[1],C=I[1],k+=C&65535,W+=C>>>16,J+=S&65535,re+=S>>>16,W+=k>>>16,J+=W>>>16,re+=J>>>16,O[1]=H=J&65535|re<<16,I[1]=c=k&65535|W<<16,S=K,C=v,k=C&65535,W=C>>>16,J=S&65535,re=S>>>16,S=O[2],C=I[2],k+=C&65535,W+=C>>>16,J+=S&65535,re+=S>>>16,W+=k>>>16,J+=W>>>16,re+=J>>>16,O[2]=K=J&65535|re<<16,I[2]=v=k&65535|W<<16,S=ie,C=z,k=C&65535,W=C>>>16,J=S&65535,re=S>>>16,S=O[3],C=I[3],k+=C&65535,W+=C>>>16,J+=S&65535,re+=S>>>16,W+=k>>>16,J+=W>>>16,re+=J>>>16,O[3]=ie=J&65535|re<<16,I[3]=z=k&65535|W<<16,S=p,C=G,k=C&65535,W=C>>>16,J=S&65535,re=S>>>16,S=O[4],C=I[4],k+=C&65535,W+=C>>>16,J+=S&65535,re+=S>>>16,W+=k>>>16,J+=W>>>16,re+=J>>>16,O[4]=p=J&65535|re<<16,I[4]=G=k&65535|W<<16,S=b,C=se,k=C&65535,W=C>>>16,J=S&65535,re=S>>>16,S=O[5],C=I[5],k+=C&65535,W+=C>>>16,J+=S&65535,re+=S>>>16,W+=k>>>16,J+=W>>>16,re+=J>>>16,O[5]=b=J&65535|re<<16,I[5]=se=k&65535|W<<16,S=y,C=ce,k=C&65535,W=C>>>16,J=S&65535,re=S>>>16,S=O[6],C=I[6],k+=C&65535,W+=C>>>16,J+=S&65535,re+=S>>>16,W+=k>>>16,J+=W>>>16,re+=J>>>16,O[6]=y=J&65535|re<<16,I[6]=ce=k&65535|W<<16,S=_,C=de,k=C&65535,W=C>>>16,J=S&65535,re=S>>>16,S=O[7],C=I[7],k+=C&65535,W+=C>>>16,J+=S&65535,re+=S>>>16,W+=k>>>16,J+=W>>>16,re+=J>>>16,O[7]=_=J&65535|re<<16,I[7]=de=k&65535|W<<16,j+=128,R-=128}return j}function m(l){var w=new s;w.update(l);var O=w.digest();return w.clean(),O}n.hash=m})(Ud);(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.convertSecretKeyToX25519=n.convertPublicKeyToX25519=n.verify=n.sign=n.extractPublicKeyFromSecretKey=n.generateKeyPair=n.generateKeyPairFromSeed=n.SEED_LENGTH=n.SECRET_KEY_LENGTH=n.PUBLIC_KEY_LENGTH=n.SIGNATURE_LENGTH=void 0;const t=Cn,r=Ud,s=Sr;n.SIGNATURE_LENGTH=64,n.PUBLIC_KEY_LENGTH=32,n.SECRET_KEY_LENGTH=64,n.SEED_LENGTH=32;function o(B){const q=new Float64Array(16);if(B)for(let F=0;F<B.length;F++)q[F]=B[F];return q}const f=new Uint8Array(32);f[0]=9;const m=o(),l=o([1]),w=o([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),O=o([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),I=o([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),N=o([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),j=o([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function R(B,q){for(let F=0;F<16;F++)B[F]=q[F]|0}function U(B){let q=1;for(let F=0;F<16;F++){let h=B[F]+q+65535;q=Math.floor(h/65536),B[F]=h-q*65536}B[0]+=q-1+37*(q-1)}function H(B,q,F){const h=~(F-1);for(let P=0;P<16;P++){const oe=h&(B[P]^q[P]);B[P]^=oe,q[P]^=oe}}function K(B,q){const F=o(),h=o();for(let P=0;P<16;P++)h[P]=q[P];U(h),U(h),U(h);for(let P=0;P<2;P++){F[0]=h[0]-65517;for(let le=1;le<15;le++)F[le]=h[le]-65535-(F[le-1]>>16&1),F[le-1]&=65535;F[15]=h[15]-32767-(F[14]>>16&1);const oe=F[15]>>16&1;F[14]&=65535,H(h,F,1-oe)}for(let P=0;P<16;P++)B[2*P]=h[P]&255,B[2*P+1]=h[P]>>8}function ie(B,q){let F=0;for(let h=0;h<32;h++)F|=B[h]^q[h];return(1&F-1>>>8)-1}function p(B,q){const F=new Uint8Array(32),h=new Uint8Array(32);return K(F,B),K(h,q),ie(F,h)}function b(B){const q=new Uint8Array(32);return K(q,B),q[0]&1}function y(B,q){for(let F=0;F<16;F++)B[F]=q[2*F]+(q[2*F+1]<<8);B[15]&=32767}function _(B,q,F){for(let h=0;h<16;h++)B[h]=q[h]+F[h]}function d(B,q,F){for(let h=0;h<16;h++)B[h]=q[h]-F[h]}function c(B,q,F){let h,P,oe=0,le=0,Ie=0,ze=0,Ve=0,Le=0,pt=0,gt=0,je=0,xe=0,Ue=0,Re=0,qe=0,Ae=0,Fe=0,Se=0,Ce=0,He=0,Oe=0,ke=0,Ge=0,et=0,tt=0,Je=0,er=0,hr=0,kr=0,tr=0,ri=0,gi=0,Ui=0,wt=F[0],yt=F[1],Et=F[2],Dt=F[3],mt=F[4],vt=F[5],Rt=F[6],Ft=F[7],St=F[8],$t=F[9],It=F[10],Ct=F[11],xt=F[12],ht=F[13],Lt=F[14],Mt=F[15];h=q[0],oe+=h*wt,le+=h*yt,Ie+=h*Et,ze+=h*Dt,Ve+=h*mt,Le+=h*vt,pt+=h*Rt,gt+=h*Ft,je+=h*St,xe+=h*$t,Ue+=h*It,Re+=h*Ct,qe+=h*xt,Ae+=h*ht,Fe+=h*Lt,Se+=h*Mt,h=q[1],le+=h*wt,Ie+=h*yt,ze+=h*Et,Ve+=h*Dt,Le+=h*mt,pt+=h*vt,gt+=h*Rt,je+=h*Ft,xe+=h*St,Ue+=h*$t,Re+=h*It,qe+=h*Ct,Ae+=h*xt,Fe+=h*ht,Se+=h*Lt,Ce+=h*Mt,h=q[2],Ie+=h*wt,ze+=h*yt,Ve+=h*Et,Le+=h*Dt,pt+=h*mt,gt+=h*vt,je+=h*Rt,xe+=h*Ft,Ue+=h*St,Re+=h*$t,qe+=h*It,Ae+=h*Ct,Fe+=h*xt,Se+=h*ht,Ce+=h*Lt,He+=h*Mt,h=q[3],ze+=h*wt,Ve+=h*yt,Le+=h*Et,pt+=h*Dt,gt+=h*mt,je+=h*vt,xe+=h*Rt,Ue+=h*Ft,Re+=h*St,qe+=h*$t,Ae+=h*It,Fe+=h*Ct,Se+=h*xt,Ce+=h*ht,He+=h*Lt,Oe+=h*Mt,h=q[4],Ve+=h*wt,Le+=h*yt,pt+=h*Et,gt+=h*Dt,je+=h*mt,xe+=h*vt,Ue+=h*Rt,Re+=h*Ft,qe+=h*St,Ae+=h*$t,Fe+=h*It,Se+=h*Ct,Ce+=h*xt,He+=h*ht,Oe+=h*Lt,ke+=h*Mt,h=q[5],Le+=h*wt,pt+=h*yt,gt+=h*Et,je+=h*Dt,xe+=h*mt,Ue+=h*vt,Re+=h*Rt,qe+=h*Ft,Ae+=h*St,Fe+=h*$t,Se+=h*It,Ce+=h*Ct,He+=h*xt,Oe+=h*ht,ke+=h*Lt,Ge+=h*Mt,h=q[6],pt+=h*wt,gt+=h*yt,je+=h*Et,xe+=h*Dt,Ue+=h*mt,Re+=h*vt,qe+=h*Rt,Ae+=h*Ft,Fe+=h*St,Se+=h*$t,Ce+=h*It,He+=h*Ct,Oe+=h*xt,ke+=h*ht,Ge+=h*Lt,et+=h*Mt,h=q[7],gt+=h*wt,je+=h*yt,xe+=h*Et,Ue+=h*Dt,Re+=h*mt,qe+=h*vt,Ae+=h*Rt,Fe+=h*Ft,Se+=h*St,Ce+=h*$t,He+=h*It,Oe+=h*Ct,ke+=h*xt,Ge+=h*ht,et+=h*Lt,tt+=h*Mt,h=q[8],je+=h*wt,xe+=h*yt,Ue+=h*Et,Re+=h*Dt,qe+=h*mt,Ae+=h*vt,Fe+=h*Rt,Se+=h*Ft,Ce+=h*St,He+=h*$t,Oe+=h*It,ke+=h*Ct,Ge+=h*xt,et+=h*ht,tt+=h*Lt,Je+=h*Mt,h=q[9],xe+=h*wt,Ue+=h*yt,Re+=h*Et,qe+=h*Dt,Ae+=h*mt,Fe+=h*vt,Se+=h*Rt,Ce+=h*Ft,He+=h*St,Oe+=h*$t,ke+=h*It,Ge+=h*Ct,et+=h*xt,tt+=h*ht,Je+=h*Lt,er+=h*Mt,h=q[10],Ue+=h*wt,Re+=h*yt,qe+=h*Et,Ae+=h*Dt,Fe+=h*mt,Se+=h*vt,Ce+=h*Rt,He+=h*Ft,Oe+=h*St,ke+=h*$t,Ge+=h*It,et+=h*Ct,tt+=h*xt,Je+=h*ht,er+=h*Lt,hr+=h*Mt,h=q[11],Re+=h*wt,qe+=h*yt,Ae+=h*Et,Fe+=h*Dt,Se+=h*mt,Ce+=h*vt,He+=h*Rt,Oe+=h*Ft,ke+=h*St,Ge+=h*$t,et+=h*It,tt+=h*Ct,Je+=h*xt,er+=h*ht,hr+=h*Lt,kr+=h*Mt,h=q[12],qe+=h*wt,Ae+=h*yt,Fe+=h*Et,Se+=h*Dt,Ce+=h*mt,He+=h*vt,Oe+=h*Rt,ke+=h*Ft,Ge+=h*St,et+=h*$t,tt+=h*It,Je+=h*Ct,er+=h*xt,hr+=h*ht,kr+=h*Lt,tr+=h*Mt,h=q[13],Ae+=h*wt,Fe+=h*yt,Se+=h*Et,Ce+=h*Dt,He+=h*mt,Oe+=h*vt,ke+=h*Rt,Ge+=h*Ft,et+=h*St,tt+=h*$t,Je+=h*It,er+=h*Ct,hr+=h*xt,kr+=h*ht,tr+=h*Lt,ri+=h*Mt,h=q[14],Fe+=h*wt,Se+=h*yt,Ce+=h*Et,He+=h*Dt,Oe+=h*mt,ke+=h*vt,Ge+=h*Rt,et+=h*Ft,tt+=h*St,Je+=h*$t,er+=h*It,hr+=h*Ct,kr+=h*xt,tr+=h*ht,ri+=h*Lt,gi+=h*Mt,h=q[15],Se+=h*wt,Ce+=h*yt,He+=h*Et,Oe+=h*Dt,ke+=h*mt,Ge+=h*vt,et+=h*Rt,tt+=h*Ft,Je+=h*St,er+=h*$t,hr+=h*It,kr+=h*Ct,tr+=h*xt,ri+=h*ht,gi+=h*Lt,Ui+=h*Mt,oe+=38*Ce,le+=38*He,Ie+=38*Oe,ze+=38*ke,Ve+=38*Ge,Le+=38*et,pt+=38*tt,gt+=38*Je,je+=38*er,xe+=38*hr,Ue+=38*kr,Re+=38*tr,qe+=38*ri,Ae+=38*gi,Fe+=38*Ui,P=1,h=oe+P+65535,P=Math.floor(h/65536),oe=h-P*65536,h=le+P+65535,P=Math.floor(h/65536),le=h-P*65536,h=Ie+P+65535,P=Math.floor(h/65536),Ie=h-P*65536,h=ze+P+65535,P=Math.floor(h/65536),ze=h-P*65536,h=Ve+P+65535,P=Math.floor(h/65536),Ve=h-P*65536,h=Le+P+65535,P=Math.floor(h/65536),Le=h-P*65536,h=pt+P+65535,P=Math.floor(h/65536),pt=h-P*65536,h=gt+P+65535,P=Math.floor(h/65536),gt=h-P*65536,h=je+P+65535,P=Math.floor(h/65536),je=h-P*65536,h=xe+P+65535,P=Math.floor(h/65536),xe=h-P*65536,h=Ue+P+65535,P=Math.floor(h/65536),Ue=h-P*65536,h=Re+P+65535,P=Math.floor(h/65536),Re=h-P*65536,h=qe+P+65535,P=Math.floor(h/65536),qe=h-P*65536,h=Ae+P+65535,P=Math.floor(h/65536),Ae=h-P*65536,h=Fe+P+65535,P=Math.floor(h/65536),Fe=h-P*65536,h=Se+P+65535,P=Math.floor(h/65536),Se=h-P*65536,oe+=P-1+37*(P-1),P=1,h=oe+P+65535,P=Math.floor(h/65536),oe=h-P*65536,h=le+P+65535,P=Math.floor(h/65536),le=h-P*65536,h=Ie+P+65535,P=Math.floor(h/65536),Ie=h-P*65536,h=ze+P+65535,P=Math.floor(h/65536),ze=h-P*65536,h=Ve+P+65535,P=Math.floor(h/65536),Ve=h-P*65536,h=Le+P+65535,P=Math.floor(h/65536),Le=h-P*65536,h=pt+P+65535,P=Math.floor(h/65536),pt=h-P*65536,h=gt+P+65535,P=Math.floor(h/65536),gt=h-P*65536,h=je+P+65535,P=Math.floor(h/65536),je=h-P*65536,h=xe+P+65535,P=Math.floor(h/65536),xe=h-P*65536,h=Ue+P+65535,P=Math.floor(h/65536),Ue=h-P*65536,h=Re+P+65535,P=Math.floor(h/65536),Re=h-P*65536,h=qe+P+65535,P=Math.floor(h/65536),qe=h-P*65536,h=Ae+P+65535,P=Math.floor(h/65536),Ae=h-P*65536,h=Fe+P+65535,P=Math.floor(h/65536),Fe=h-P*65536,h=Se+P+65535,P=Math.floor(h/65536),Se=h-P*65536,oe+=P-1+37*(P-1),B[0]=oe,B[1]=le,B[2]=Ie,B[3]=ze,B[4]=Ve,B[5]=Le,B[6]=pt,B[7]=gt,B[8]=je,B[9]=xe,B[10]=Ue,B[11]=Re,B[12]=qe,B[13]=Ae,B[14]=Fe,B[15]=Se}function v(B,q){c(B,q,q)}function z(B,q){const F=o();let h;for(h=0;h<16;h++)F[h]=q[h];for(h=253;h>=0;h--)v(F,F),h!==2&&h!==4&&c(F,F,q);for(h=0;h<16;h++)B[h]=F[h]}function G(B,q){const F=o();let h;for(h=0;h<16;h++)F[h]=q[h];for(h=250;h>=0;h--)v(F,F),h!==1&&c(F,F,q);for(h=0;h<16;h++)B[h]=F[h]}function se(B,q){const F=o(),h=o(),P=o(),oe=o(),le=o(),Ie=o(),ze=o(),Ve=o(),Le=o();d(F,B[1],B[0]),d(Le,q[1],q[0]),c(F,F,Le),_(h,B[0],B[1]),_(Le,q[0],q[1]),c(h,h,Le),c(P,B[3],q[3]),c(P,P,O),c(oe,B[2],q[2]),_(oe,oe,oe),d(le,h,F),d(Ie,oe,P),_(ze,oe,P),_(Ve,h,F),c(B[0],le,Ie),c(B[1],Ve,ze),c(B[2],ze,Ie),c(B[3],le,Ve)}function ce(B,q,F){for(let h=0;h<4;h++)H(B[h],q[h],F)}function de(B,q){const F=o(),h=o(),P=o();z(P,q[2]),c(F,q[0],P),c(h,q[1],P),K(B,h),B[31]^=b(F)<<7}function S(B,q,F){R(B[0],m),R(B[1],l),R(B[2],l),R(B[3],m);for(let h=255;h>=0;--h){const P=F[h/8|0]>>(h&7)&1;ce(B,q,P),se(q,B),se(B,B),ce(B,q,P)}}function C(B,q){const F=[o(),o(),o(),o()];R(F[0],I),R(F[1],N),R(F[2],l),c(F[3],I,N),S(B,F,q)}function ee(B){if(B.length!==n.SEED_LENGTH)throw new Error(`ed25519: seed must be ${n.SEED_LENGTH} bytes`);const q=(0,r.hash)(B);q[0]&=248,q[31]&=127,q[31]|=64;const F=new Uint8Array(32),h=[o(),o(),o(),o()];C(h,q),de(F,h);const P=new Uint8Array(64);return P.set(B),P.set(F,32),{publicKey:F,secretKey:P}}n.generateKeyPairFromSeed=ee;function X(B){const q=(0,t.randomBytes)(32,B),F=ee(q);return(0,s.wipe)(q),F}n.generateKeyPair=X;function k(B){if(B.length!==n.SECRET_KEY_LENGTH)throw new Error(`ed25519: secret key must be ${n.SECRET_KEY_LENGTH} bytes`);return new Uint8Array(B.subarray(32))}n.extractPublicKeyFromSecretKey=k;const W=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function J(B,q){let F,h,P,oe;for(h=63;h>=32;--h){for(F=0,P=h-32,oe=h-12;P<oe;++P)q[P]+=F-16*q[h]*W[P-(h-32)],F=Math.floor((q[P]+128)/256),q[P]-=F*256;q[P]+=F,q[h]=0}for(F=0,P=0;P<32;P++)q[P]+=F-(q[31]>>4)*W[P],F=q[P]>>8,q[P]&=255;for(P=0;P<32;P++)q[P]-=F*W[P];for(h=0;h<32;h++)q[h+1]+=q[h]>>8,B[h]=q[h]&255}function re(B){const q=new Float64Array(64);for(let F=0;F<64;F++)q[F]=B[F];for(let F=0;F<64;F++)B[F]=0;J(B,q)}function be(B,q){const F=new Float64Array(64),h=[o(),o(),o(),o()],P=(0,r.hash)(B.subarray(0,32));P[0]&=248,P[31]&=127,P[31]|=64;const oe=new Uint8Array(64);oe.set(P.subarray(32),32);const le=new r.SHA512;le.update(oe.subarray(32)),le.update(q);const Ie=le.digest();le.clean(),re(Ie),C(h,Ie),de(oe,h),le.reset(),le.update(oe.subarray(0,32)),le.update(B.subarray(32)),le.update(q);const ze=le.digest();re(ze);for(let Ve=0;Ve<32;Ve++)F[Ve]=Ie[Ve];for(let Ve=0;Ve<32;Ve++)for(let Le=0;Le<32;Le++)F[Ve+Le]+=ze[Ve]*P[Le];return J(oe.subarray(32),F),oe}n.sign=be;function ae(B,q){const F=o(),h=o(),P=o(),oe=o(),le=o(),Ie=o(),ze=o();return R(B[2],l),y(B[1],q),v(P,B[1]),c(oe,P,w),d(P,P,B[2]),_(oe,B[2],oe),v(le,oe),v(Ie,le),c(ze,Ie,le),c(F,ze,P),c(F,F,oe),G(F,F),c(F,F,P),c(F,F,oe),c(F,F,oe),c(B[0],F,oe),v(h,B[0]),c(h,h,oe),p(h,P)&&c(B[0],B[0],j),v(h,B[0]),c(h,h,oe),p(h,P)?-1:(b(B[0])===q[31]>>7&&d(B[0],m,B[0]),c(B[3],B[0],B[1]),0)}function we(B,q,F){const h=new Uint8Array(32),P=[o(),o(),o(),o()],oe=[o(),o(),o(),o()];if(F.length!==n.SIGNATURE_LENGTH)throw new Error(`ed25519: signature must be ${n.SIGNATURE_LENGTH} bytes`);if(ae(oe,B))return!1;const le=new r.SHA512;le.update(F.subarray(0,32)),le.update(B),le.update(q);const Ie=le.digest();return re(Ie),S(P,oe,Ie),C(oe,F.subarray(32)),se(P,oe),de(h,P),!ie(F,h)}n.verify=we;function fe(B){let q=[o(),o(),o(),o()];if(ae(q,B))throw new Error("Ed25519: invalid public key");let F=o(),h=o(),P=q[1];_(F,l,P),d(h,l,P),z(h,h),c(F,F,h);let oe=new Uint8Array(32);return K(oe,F),oe}n.convertPublicKeyToX25519=fe;function ve(B){const q=(0,r.hash)(B.subarray(0,32));q[0]&=248,q[31]&=127,q[31]|=64;const F=new Uint8Array(q.subarray(0,32));return(0,s.wipe)(q),F}n.convertSecretKeyToX25519=ve})(mu);const tE="EdDSA",rE="JWT",Rd=".",Fd="base64url",iE="utf8",nE="utf8",sE=":",aE="did",oE="key",fl="base58btc",cE="z",uE="K36",hE=32;function Ta(n){return ur(vr(hs(n),iE),Fd)}function $d(n){const t=vr(uE,fl),r=cE+ur(Kc([t,n]),fl);return[aE,oE,r].join(sE)}function fE(n){return ur(n,Fd)}function lE(n){return vr([Ta(n.header),Ta(n.payload)].join(Rd),nE)}function dE(n){return[Ta(n.header),Ta(n.payload),fE(n.signature)].join(Rd)}function ll(n=Cn.randomBytes(hE)){return mu.generateKeyPairFromSeed(n)}async function pE(n,t,r,s,o=_e.fromMiliseconds(Date.now())){const f={alg:tE,typ:rE},m=$d(s.publicKey),l=o+r,w={iss:m,sub:n,aud:t,iat:o,exp:l},O=lE({header:f,payload:w}),I=mu.sign(s.secretKey,O);return dE({header:f,payload:w,signature:I})}var fs={};(function(n){const t=au,r=ou,s=su,o=vu,f=p=>p==null,m=Symbol("encodeFragmentIdentifier");function l(p){switch(p.arrayFormat){case"index":return b=>(y,_)=>{const d=y.length;return _===void 0||p.skipNull&&_===null||p.skipEmptyString&&_===""?y:_===null?[...y,[I(b,p),"[",d,"]"].join("")]:[...y,[I(b,p),"[",I(d,p),"]=",I(_,p)].join("")]};case"bracket":return b=>(y,_)=>_===void 0||p.skipNull&&_===null||p.skipEmptyString&&_===""?y:_===null?[...y,[I(b,p),"[]"].join("")]:[...y,[I(b,p),"[]=",I(_,p)].join("")];case"colon-list-separator":return b=>(y,_)=>_===void 0||p.skipNull&&_===null||p.skipEmptyString&&_===""?y:_===null?[...y,[I(b,p),":list="].join("")]:[...y,[I(b,p),":list=",I(_,p)].join("")];case"comma":case"separator":case"bracket-separator":{const b=p.arrayFormat==="bracket-separator"?"[]=":"=";return y=>(_,d)=>d===void 0||p.skipNull&&d===null||p.skipEmptyString&&d===""?_:(d=d===null?"":d,_.length===0?[[I(y,p),b,I(d,p)].join("")]:[[_,I(d,p)].join(p.arrayFormatSeparator)])}default:return b=>(y,_)=>_===void 0||p.skipNull&&_===null||p.skipEmptyString&&_===""?y:_===null?[...y,I(b,p)]:[...y,[I(b,p),"=",I(_,p)].join("")]}}function w(p){let b;switch(p.arrayFormat){case"index":return(y,_,d)=>{if(b=/\[(\d*)\]$/.exec(y),y=y.replace(/\[\d*\]$/,""),!b){d[y]=_;return}d[y]===void 0&&(d[y]={}),d[y][b[1]]=_};case"bracket":return(y,_,d)=>{if(b=/(\[\])$/.exec(y),y=y.replace(/\[\]$/,""),!b){d[y]=_;return}if(d[y]===void 0){d[y]=[_];return}d[y]=[].concat(d[y],_)};case"colon-list-separator":return(y,_,d)=>{if(b=/(:list)$/.exec(y),y=y.replace(/:list$/,""),!b){d[y]=_;return}if(d[y]===void 0){d[y]=[_];return}d[y]=[].concat(d[y],_)};case"comma":case"separator":return(y,_,d)=>{const c=typeof _=="string"&&_.includes(p.arrayFormatSeparator),v=typeof _=="string"&&!c&&N(_,p).includes(p.arrayFormatSeparator);_=v?N(_,p):_;const z=c||v?_.split(p.arrayFormatSeparator).map(G=>N(G,p)):_===null?_:N(_,p);d[y]=z};case"bracket-separator":return(y,_,d)=>{const c=/(\[\])$/.test(y);if(y=y.replace(/\[\]$/,""),!c){d[y]=_&&N(_,p);return}const v=_===null?[]:_.split(p.arrayFormatSeparator).map(z=>N(z,p));if(d[y]===void 0){d[y]=v;return}d[y]=[].concat(d[y],v)};default:return(y,_,d)=>{if(d[y]===void 0){d[y]=_;return}d[y]=[].concat(d[y],_)}}}function O(p){if(typeof p!="string"||p.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function I(p,b){return b.encode?b.strict?t(p):encodeURIComponent(p):p}function N(p,b){return b.decode?r(p):p}function j(p){return Array.isArray(p)?p.sort():typeof p=="object"?j(Object.keys(p)).sort((b,y)=>Number(b)-Number(y)).map(b=>p[b]):p}function R(p){const b=p.indexOf("#");return b!==-1&&(p=p.slice(0,b)),p}function U(p){let b="";const y=p.indexOf("#");return y!==-1&&(b=p.slice(y)),b}function H(p){p=R(p);const b=p.indexOf("?");return b===-1?"":p.slice(b+1)}function K(p,b){return b.parseNumbers&&!Number.isNaN(Number(p))&&typeof p=="string"&&p.trim()!==""?p=Number(p):b.parseBooleans&&p!==null&&(p.toLowerCase()==="true"||p.toLowerCase()==="false")&&(p=p.toLowerCase()==="true"),p}function ie(p,b){b=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},b),O(b.arrayFormatSeparator);const y=w(b),_=Object.create(null);if(typeof p!="string"||(p=p.trim().replace(/^[?#&]/,""),!p))return _;for(const d of p.split("&")){if(d==="")continue;let[c,v]=s(b.decode?d.replace(/\+/g," "):d,"=");v=v===void 0?null:["comma","separator","bracket-separator"].includes(b.arrayFormat)?v:N(v,b),y(N(c,b),v,_)}for(const d of Object.keys(_)){const c=_[d];if(typeof c=="object"&&c!==null)for(const v of Object.keys(c))c[v]=K(c[v],b);else _[d]=K(c,b)}return b.sort===!1?_:(b.sort===!0?Object.keys(_).sort():Object.keys(_).sort(b.sort)).reduce((d,c)=>{const v=_[c];return v&&typeof v=="object"&&!Array.isArray(v)?d[c]=j(v):d[c]=v,d},Object.create(null))}n.extract=H,n.parse=ie,n.stringify=(p,b)=>{if(!p)return"";b=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},b),O(b.arrayFormatSeparator);const y=v=>b.skipNull&&f(p[v])||b.skipEmptyString&&p[v]==="",_=l(b),d={};for(const v of Object.keys(p))y(v)||(d[v]=p[v]);const c=Object.keys(d);return b.sort!==!1&&c.sort(b.sort),c.map(v=>{const z=p[v];return z===void 0?"":z===null?I(v,b):Array.isArray(z)?z.length===0&&b.arrayFormat==="bracket-separator"?I(v,b)+"[]":z.reduce(_(v),[]).join("&"):I(v,b)+"="+I(z,b)}).filter(v=>v.length>0).join("&")},n.parseUrl=(p,b)=>{b=Object.assign({decode:!0},b);const[y,_]=s(p,"#");return Object.assign({url:y.split("?")[0]||"",query:ie(H(p),b)},b&&b.parseFragmentIdentifier&&_?{fragmentIdentifier:N(_,b)}:{})},n.stringifyUrl=(p,b)=>{b=Object.assign({encode:!0,strict:!0,[m]:!0},b);const y=R(p.url).split("?")[0]||"",_=n.extract(p.url),d=n.parse(_,{sort:!1}),c=Object.assign(d,p.query);let v=n.stringify(c,b);v&&(v=`?${v}`);let z=U(p.url);return p.fragmentIdentifier&&(z=`#${b[m]?I(p.fragmentIdentifier,b):p.fragmentIdentifier}`),`${y}${v}${z}`},n.pick=(p,b,y)=>{y=Object.assign({parseFragmentIdentifier:!0,[m]:!1},y);const{url:_,query:d,fragmentIdentifier:c}=n.parseUrl(p,y);return n.stringifyUrl({url:_,query:o(d,b),fragmentIdentifier:c},y)},n.exclude=(p,b,y)=>{const _=Array.isArray(b)?d=>!b.includes(d):(d,c)=>!b(d,c);return n.pick(p,_,y)}})(fs);function Ld(n,t){return n.includes(":")?[n]:t.chains||[]}const Md="base10",cr="base16",kc="base64pad",bu="utf8",jd=0,rn=1,gE=0,dl=1,Wc=12,wu=32;function yE(){const n=du.generateKeyPair();return{privateKey:ur(n.secretKey,cr),publicKey:ur(n.publicKey,cr)}}function Gc(){const n=Cn.randomBytes(wu);return ur(n,cr)}function vE(n,t){const r=du.sharedKey(vr(n,cr),vr(t,cr)),s=new Mm(za.SHA256,r).expand(wu);return ur(s,cr)}function _E(n){const t=za.hash(vr(n,cr));return ur(t,cr)}function An(n){const t=za.hash(vr(n,bu));return ur(t,cr)}function mE(n){return vr(`${n}`,Md)}function ys(n){return Number(ur(n,Md))}function bE(n){const t=mE(typeof n.type<"u"?n.type:jd);if(ys(t)===rn&&typeof n.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const r=typeof n.senderPublicKey<"u"?vr(n.senderPublicKey,cr):void 0,s=typeof n.iv<"u"?vr(n.iv,cr):Cn.randomBytes(Wc),o=new fu.ChaCha20Poly1305(vr(n.symKey,cr)).seal(s,vr(n.message,bu));return EE({type:t,sealed:o,iv:s,senderPublicKey:r})}function wE(n){const t=new fu.ChaCha20Poly1305(vr(n.symKey,cr)),{sealed:r,iv:s}=Na(n.encoded),o=t.open(s,r);if(o===null)throw new Error("Failed to decrypt");return ur(o,bu)}function EE(n){if(ys(n.type)===rn){if(typeof n.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return ur(Kc([n.type,n.senderPublicKey,n.iv,n.sealed]),kc)}return ur(Kc([n.type,n.iv,n.sealed]),kc)}function Na(n){const t=vr(n,kc),r=t.slice(gE,dl),s=dl;if(ys(r)===rn){const l=s+wu,w=l+Wc,O=t.slice(s,l),I=t.slice(l,w),N=t.slice(w);return{type:r,sealed:N,iv:I,senderPublicKey:O}}const o=s+Wc,f=t.slice(s,o),m=t.slice(o);return{type:r,sealed:m,iv:f}}function DE(n,t){const r=Na(n);return qd({type:ys(r.type),senderPublicKey:typeof r.senderPublicKey<"u"?ur(r.senderPublicKey,cr):void 0,receiverPublicKey:t==null?void 0:t.receiverPublicKey})}function qd(n){const t=(n==null?void 0:n.type)||jd;if(t===rn){if(typeof(n==null?void 0:n.senderPublicKey)>"u")throw new Error("missing sender public key");if(typeof(n==null?void 0:n.receiverPublicKey)>"u")throw new Error("missing receiver public key")}return{type:t,senderPublicKey:n==null?void 0:n.senderPublicKey,receiverPublicKey:n==null?void 0:n.receiverPublicKey}}function pl(n){return n.type===rn&&typeof n.senderPublicKey=="string"&&typeof n.receiverPublicKey=="string"}var SE=Object.defineProperty,gl=Object.getOwnPropertySymbols,IE=Object.prototype.hasOwnProperty,xE=Object.prototype.propertyIsEnumerable,yl=(n,t,r)=>t in n?SE(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,vl=(n,t)=>{for(var r in t||(t={}))IE.call(t,r)&&yl(n,r,t[r]);if(gl)for(var r of gl(t))xE.call(t,r)&&yl(n,r,t[r]);return n};const OE="ReactNative",Xi={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},AE="js";function Eu(){return typeof Zi<"u"&&typeof Zi.versions<"u"&&typeof Zi.versions.node<"u"}function Bd(){return!xd()&&!!gu()&&navigator.product===OE}function Du(){return!Eu()&&!!gu()}function zd(){return Bd()?Xi.reactNative:Eu()?Xi.node:Du()?Xi.browser:Xi.unknown}function CE(n,t){let r=fs.parse(n);return r=vl(vl({},r),t),n=fs.stringify(r),n}function PE(){return Ad()||{name:"",description:"",url:"",icons:[""]}}function TE(){const n=Jb();if(n===null)return"unknown";const t=n.os?n.os.replace(" ","").toLowerCase():"unknown";return n.type==="browser"?[t,n.name,n.version].join("-"):[t,n.version].join("-")}function NE(){var n;const t=zd();return t===Xi.browser?[t,((n=Od())==null?void 0:n.host)||"unknown"].join(":"):t}function UE(n,t,r){const s=TE(),o=NE();return[[n,t].join("-"),[AE,r].join("-"),s,o].join("/")}function RE({protocol:n,version:t,relayUrl:r,sdkVersion:s,auth:o,projectId:f,useOnCloseEvent:m}){const l=r.split("?"),w=UE(n,t,s),O={auth:o,ua:w,projectId:f,useOnCloseEvent:m||void 0},I=CE(l[1]||"",O);return l[0]+"?"+I}function Qi(n,t){return n.filter(r=>t.includes(r)).length===n.length}function Hd(n){return Object.fromEntries(n.entries())}function Kd(n){return new Map(Object.entries(n))}function On(n=_e.FIVE_MINUTES,t){const r=_e.toMiliseconds(n||_e.FIVE_MINUTES);let s,o,f;return{resolve:m=>{f&&s&&(clearTimeout(f),s(m))},reject:m=>{f&&o&&(clearTimeout(f),o(m))},done:()=>new Promise((m,l)=>{f=setTimeout(()=>{l(new Error(t))},r),s=m,o=l})}}function Ua(n,t,r){return new Promise(async(s,o)=>{const f=setTimeout(()=>o(new Error(r)),t);try{const m=await n;s(m)}catch(m){o(m)}clearTimeout(f)})}function Vd(n,t){if(typeof t=="string"&&t.startsWith(`${n}:`))return t;if(n.toLowerCase()==="topic"){if(typeof t!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${t}`}else if(n.toLowerCase()==="id"){if(typeof t!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${t}`}throw new Error(`Unknown expirer target type: ${n}`)}function FE(n){return Vd("topic",n)}function $E(n){return Vd("id",n)}function kd(n){const[t,r]=n.split(":"),s={id:void 0,topic:void 0};if(t==="topic"&&typeof r=="string")s.topic=r;else if(t==="id"&&Number.isInteger(Number(r)))s.id=Number(r);else throw new Error(`Invalid target, expected id:number or topic:string, got ${t}:${r}`);return s}function ti(n,t){return _e.fromMiliseconds((t||Date.now())+_e.toMiliseconds(n))}function xi(n){return Date.now()>=_e.toMiliseconds(n)}function Bt(n,t){return`${n}${t?`:${t}`:""}`}async function LE({id:n,topic:t,wcDeepLink:r}){try{if(!r)return;const s=typeof r=="string"?JSON.parse(r):r;let o=s==null?void 0:s.href;if(typeof o!="string")return;o.endsWith("/")&&(o=o.slice(0,-1));const f=`${o}/wc?requestId=${n}&sessionTopic=${t}`,m=zd();m===Xi.browser?window.open(f,"_self","noreferrer noopener"):m===Xi.reactNative&&typeof(Ai==null?void 0:Ai.Linking)<"u"&&await Ai.Linking.openURL(f)}catch(s){console.error(s)}}const ME="irn";function Yc(n){return(n==null?void 0:n.relay)||{protocol:ME}}function xa(n){const t=ww[n];if(typeof t>"u")throw new Error(`Relay Protocol not supported: ${n}`);return t}var jE=Object.defineProperty,_l=Object.getOwnPropertySymbols,qE=Object.prototype.hasOwnProperty,BE=Object.prototype.propertyIsEnumerable,ml=(n,t,r)=>t in n?jE(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,zE=(n,t)=>{for(var r in t||(t={}))qE.call(t,r)&&ml(n,r,t[r]);if(_l)for(var r of _l(t))BE.call(t,r)&&ml(n,r,t[r]);return n};function HE(n,t="-"){const r={},s="relay"+t;return Object.keys(n).forEach(o=>{if(o.startsWith(s)){const f=o.replace(s,""),m=n[o];r[f]=m}}),r}function KE(n){const t=n.indexOf(":"),r=n.indexOf("?")!==-1?n.indexOf("?"):void 0,s=n.substring(0,t),o=n.substring(t+1,r).split("@"),f=typeof r<"u"?n.substring(r):"",m=fs.parse(f);return{protocol:s,topic:VE(o[0]),version:parseInt(o[1],10),symKey:m.symKey,relay:HE(m)}}function VE(n){return n.startsWith("//")?n.substring(2):n}function kE(n,t="-"){const r="relay",s={};return Object.keys(n).forEach(o=>{const f=r+t+o;n[o]&&(s[f]=n[o])}),s}function WE(n){return`${n.protocol}:${n.topic}@${n.version}?`+fs.stringify(zE({symKey:n.symKey},kE(n.relay)))}function Tn(n){const t=[];return n.forEach(r=>{const[s,o]=r.split(":");t.push(`${s}:${o}`)}),t}function GE(n){const t=[];return Object.values(n).forEach(r=>{t.push(...Tn(r.accounts))}),t}function YE(n,t){const r=[];return Object.values(n).forEach(s=>{Tn(s.accounts).includes(t)&&r.push(...s.methods)}),r}function JE(n,t){const r=[];return Object.values(n).forEach(s=>{Tn(s.accounts).includes(t)&&r.push(...s.events)}),r}function XE(n,t){const r=Oa(n,t);if(r)throw new Error(r.message);const s={};for(const[o,f]of Object.entries(n))s[o]={methods:f.methods,events:f.events,chains:f.accounts.map(m=>`${m.split(":")[0]}:${m.split(":")[1]}`)};return s}const QE={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},ZE={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function he(n,t){const{message:r,code:s}=ZE[n];return{message:t?`${r} ${t}`:r,code:s}}function kt(n,t){const{message:r,code:s}=QE[n];return{message:t?`${r} ${t}`:r,code:s}}function vs(n,t){return Array.isArray(n)?typeof t<"u"&&n.length?n.every(t):!0:!1}function us(n){return Object.getPrototypeOf(n)===Object.prototype&&Object.keys(n).length}function or(n){return typeof n>"u"}function Wt(n,t){return t&&or(n)?!0:typeof n=="string"&&!!n.trim().length}function Su(n,t){return t&&or(n)?!0:typeof n=="number"&&!isNaN(n)}function e3(n,t){const{requiredNamespaces:r}=t,s=Object.keys(n.namespaces),o=Object.keys(r);let f=!0;return Qi(o,s)?(s.forEach(m=>{const{accounts:l,methods:w,events:O}=n.namespaces[m],I=Tn(l),N=r[m];(!Qi(Ld(m,N),I)||!Qi(N.methods,w)||!Qi(N.events,O))&&(f=!1)}),f):!1}function Iu(n){return Wt(n,!1)&&n.includes(":")?n.split(":").length===2:!1}function t3(n){if(Wt(n,!1)&&n.includes(":")){const t=n.split(":");if(t.length===3){const r=t[0]+":"+t[1];return!!t[2]&&Iu(r)}}return!1}function r3(n){if(Wt(n,!1))try{return typeof new URL(n)<"u"}catch{return!1}return!1}function i3(n){var t;return(t=n==null?void 0:n.proposer)==null?void 0:t.publicKey}function n3(n){return n==null?void 0:n.topic}function s3(n,t){let r=null;return Wt(n==null?void 0:n.publicKey,!1)||(r=he("MISSING_OR_INVALID",`${t} controller public key should be a string`)),r}function bl(n){let t=!0;return vs(n)?n.length&&(t=n.every(r=>Wt(r,!1))):t=!1,t}function a3(n,t,r){let s=null;return vs(t)?t.forEach(o=>{s||(!Iu(o)||!o.includes(n))&&(s=kt("UNSUPPORTED_CHAINS",`${r}, chain ${o} should be a string and conform to "namespace:chainId" format`))}):s=kt("UNSUPPORTED_CHAINS",`${r}, chains ${t} should be an array of strings conforming to "namespace:chainId" format`),s}function o3(n,t){let r=null;return Object.entries(n).forEach(([s,o])=>{if(r)return;const f=a3(s,Ld(s,o),`${t} requiredNamespace`);f&&(r=f)}),r}function c3(n,t){let r=null;return vs(n)?n.forEach(s=>{r||t3(s)||(r=kt("UNSUPPORTED_ACCOUNTS",`${t}, account ${s} should be a string and conform to "namespace:chainId:address" format`))}):r=kt("UNSUPPORTED_ACCOUNTS",`${t}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),r}function u3(n,t){let r=null;return Object.values(n).forEach(s=>{if(r)return;const o=c3(s==null?void 0:s.accounts,`${t} namespace`);o&&(r=o)}),r}function h3(n,t){let r=null;return bl(n==null?void 0:n.methods)?bl(n==null?void 0:n.events)||(r=kt("UNSUPPORTED_EVENTS",`${t}, events should be an array of strings or empty array for no events`)):r=kt("UNSUPPORTED_METHODS",`${t}, methods should be an array of strings or empty array for no methods`),r}function Wd(n,t){let r=null;return Object.values(n).forEach(s=>{if(r)return;const o=h3(s,`${t}, namespace`);o&&(r=o)}),r}function f3(n,t,r){let s=null;if(n&&us(n)){const o=Wd(n,t);o&&(s=o);const f=o3(n,t);f&&(s=f)}else s=he("MISSING_OR_INVALID",`${t}, ${r} should be an object with data`);return s}function Oa(n,t){let r=null;if(n&&us(n)){const s=Wd(n,t);s&&(r=s);const o=u3(n,t);o&&(r=o)}else r=he("MISSING_OR_INVALID",`${t}, namespaces should be an object with data`);return r}function Gd(n){return Wt(n.protocol,!0)}function l3(n,t){let r=!1;return t&&!n?r=!0:n&&vs(n)&&n.length&&n.forEach(s=>{r=Gd(s)}),r}function d3(n){return typeof n=="number"}function yr(n){return typeof n<"u"&&typeof n!==null}function p3(n){return!(!n||typeof n!="object"||!n.code||!Su(n.code,!1)||!n.message||!Wt(n.message,!1))}function g3(n){return!(or(n)||!Wt(n.method,!1))}function y3(n){return!(or(n)||or(n.result)&&or(n.error)||!Su(n.id,!1)||!Wt(n.jsonrpc,!1))}function v3(n){return!(or(n)||!Wt(n.name,!1))}function wl(n,t){return!(!Iu(t)||!GE(n).includes(t))}function _3(n,t,r){return Wt(r,!1)?YE(n,t).includes(r):!1}function m3(n,t,r){return Wt(r,!1)?JE(n,t).includes(r):!1}function El(n,t,r){let s=null;const o=b3(n),f=w3(t),m=Object.keys(o),l=Object.keys(f),w=Dl(Object.keys(n)),O=Dl(Object.keys(t)),I=w.filter(N=>!O.includes(N));return I.length&&(s=he("NON_CONFORMING_NAMESPACES",`${r} namespaces keys don't satisfy requiredNamespaces.
      Required: ${I.toString()}
      Received: ${Object.keys(t).toString()}`)),Qi(m,l)||(s=he("NON_CONFORMING_NAMESPACES",`${r} namespaces chains don't satisfy required namespaces.
      Required: ${m.toString()}
      Approved: ${l.toString()}`)),Object.keys(t).forEach(N=>{if(!N.includes(":")||s)return;const j=Tn(t[N].accounts);j.includes(N)||(s=he("NON_CONFORMING_NAMESPACES",`${r} namespaces accounts don't satisfy namespace accounts for ${N}
        Required: ${N}
        Approved: ${j.toString()}`))}),m.forEach(N=>{s||(Qi(o[N].methods,f[N].methods)?Qi(o[N].events,f[N].events)||(s=he("NON_CONFORMING_NAMESPACES",`${r} namespaces events don't satisfy namespace events for ${N}`)):s=he("NON_CONFORMING_NAMESPACES",`${r} namespaces methods don't satisfy namespace methods for ${N}`))}),s}function b3(n){const t={};return Object.keys(n).forEach(r=>{var s;r.includes(":")?t[r]=n[r]:(s=n[r].chains)==null||s.forEach(o=>{t[o]={methods:n[r].methods,events:n[r].events}})}),t}function Dl(n){return[...new Set(n.map(t=>t.includes(":")?t.split(":")[0]:t))]}function w3(n){const t={};return Object.keys(n).forEach(r=>{if(r.includes(":"))t[r]=n[r];else{const s=Tn(n[r].accounts);s==null||s.forEach(o=>{t[o]={accounts:n[r].accounts.filter(f=>f.includes(`${o}:`)),methods:n[r].methods,events:n[r].events}})}}),t}function E3(n,t){return Su(n,!1)&&n<=t.max&&n>=t.min}class Ti extends em{constructor(t){super(t),this.events=new Lr.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(t),this.connection.connected&&this.registerEventListeners()}async connect(t=this.connection){await this.open(t)}async disconnect(){await this.close()}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async request(t,r){return this.requestStrict(Fa(t.method,t.params||[],t.id||cu().toString()),r)}async requestStrict(t,r){return new Promise(async(s,o)=>{if(!this.connection.connected)try{await this.open()}catch(f){o(f)}this.events.on(`${t.id}`,f=>{Kr(f)?o(f.error):s(f.result)});try{await this.connection.send(t,r)}catch(f){o(f)}})}setConnection(t=this.connection){return t}onPayload(t){this.events.emit("payload",t),La(t)?this.events.emit(`${t.id}`,t):this.events.emit("message",{type:t.method,data:t.params})}onClose(t){t&&t.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${t.code} ${t.reason?`(${t.reason})`:""}`)),this.events.emit("disconnect")}async open(t=this.connection){this.connection===t&&this.connection.connected||(this.connection.connected&&this.close(),typeof t=="string"&&(await this.connection.open(t),t=this.connection),this.connection=this.setConnection(t),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",t=>this.onPayload(t)),this.connection.on("close",t=>this.onClose(t)),this.connection.on("error",t=>this.events.emit("error",t)),this.connection.on("register_error",t=>this.onClose()),this.hasRegisteredEventListeners=!0)}}const Sl=10,D3=()=>typeof Ai<"u"&&typeof Ai.WebSocket<"u"?Ai.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:require("ws"),S3=()=>typeof window<"u",I3=D3();class x3{constructor(t){if(this.url=t,this.events=new Lr.EventEmitter,this.registering=!1,!Tf(t))throw new Error(`Provided URL is not compatible with WebSocket connection: ${t}`);this.url=t}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async open(t=this.url){await this.register(t)}async close(){return new Promise((t,r)=>{if(typeof this.socket>"u"){r(new Error("Connection already closed"));return}this.socket.onclose=s=>{this.onClose(s),t()},this.socket.close()})}async send(t,r){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(hs(t))}catch(s){this.onError(t.id,s)}}register(t=this.url){if(!Tf(t))throw new Error(`Provided URL is not compatible with WebSocket connection: ${t}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((s,o)=>{this.events.once("register_error",f=>{this.resetMaxListeners(),o(f)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return o(new Error("WebSocket connection is missing or invalid"));s(this.socket)})})}return this.url=t,this.registering=!0,new Promise((r,s)=>{const o=X_.isReactNative()?void 0:{rejectUnauthorized:!nm(t)},f=new I3(t,[],o);S3()?f.onerror=m=>{const l=m;s(this.emitError(l.error))}:f.on("error",m=>{s(this.emitError(m))}),f.onopen=()=>{this.onOpen(f),r(f)}})}onOpen(t){t.onmessage=r=>this.onPayload(r),t.onclose=r=>this.onClose(r),this.socket=t,this.registering=!1,this.events.emit("open")}onClose(t){this.socket=void 0,this.registering=!1,this.events.emit("close",t)}onPayload(t){if(typeof t.data>"u")return;const r=typeof t.data=="string"?_u(t.data):t.data;this.events.emit("payload",r)}onError(t,r){const s=this.parseError(r),o=s.message||s.toString(),f=$a(t,o);this.events.emit("payload",f)}parseError(t,r=this.url){return ad(t,r,"WS")}resetMaxListeners(){this.events.getMaxListeners()>Sl&&this.events.setMaxListeners(Sl)}emitError(t){const r=this.parseError(new Error((t==null?void 0:t.message)||`WebSocket connection failed for URL: ${this.url}`));return this.events.emit("register_error",r),r}}var Ra={exports:{}};Ra.exports;(function(n,t){var r=200,s="__lodash_hash_undefined__",o=1,f=2,m=9007199254740991,l="[object Arguments]",w="[object Array]",O="[object AsyncFunction]",I="[object Boolean]",N="[object Date]",j="[object Error]",R="[object Function]",U="[object GeneratorFunction]",H="[object Map]",K="[object Number]",ie="[object Null]",p="[object Object]",b="[object Promise]",y="[object Proxy]",_="[object RegExp]",d="[object Set]",c="[object String]",v="[object Symbol]",z="[object Undefined]",G="[object WeakMap]",se="[object ArrayBuffer]",ce="[object DataView]",de="[object Float32Array]",S="[object Float64Array]",C="[object Int8Array]",ee="[object Int16Array]",X="[object Int32Array]",k="[object Uint8Array]",W="[object Uint8ClampedArray]",J="[object Uint16Array]",re="[object Uint32Array]",be=/[\\^$.*+?()[\]{}|]/g,ae=/^\[object .+?Constructor\]$/,we=/^(?:0|[1-9]\d*)$/,fe={};fe[de]=fe[S]=fe[C]=fe[ee]=fe[X]=fe[k]=fe[W]=fe[J]=fe[re]=!0,fe[l]=fe[w]=fe[se]=fe[I]=fe[ce]=fe[N]=fe[j]=fe[R]=fe[H]=fe[K]=fe[p]=fe[_]=fe[d]=fe[c]=fe[G]=!1;var ve=typeof Oi=="object"&&Oi&&Oi.Object===Object&&Oi,B=typeof self=="object"&&self&&self.Object===Object&&self,q=ve||B||Function("return this")(),F=t&&!t.nodeType&&t,h=F&&!0&&n&&!n.nodeType&&n,P=h&&h.exports===F,oe=P&&ve.process,le=function(){try{return oe&&oe.binding&&oe.binding("util")}catch{}}(),Ie=le&&le.isTypedArray;function ze(x,$){for(var te=-1,pe=x==null?0:x.length,ot=0,Te=[];++te<pe;){var lt=x[te];$(lt,te,x)&&(Te[ot++]=lt)}return Te}function Ve(x,$){for(var te=-1,pe=$.length,ot=x.length;++te<pe;)x[ot+te]=$[te];return x}function Le(x,$){for(var te=-1,pe=x==null?0:x.length;++te<pe;)if($(x[te],te,x))return!0;return!1}function pt(x,$){for(var te=-1,pe=Array(x);++te<x;)pe[te]=$(te);return pe}function gt(x){return function($){return x($)}}function je(x,$){return x.has($)}function xe(x,$){return x==null?void 0:x[$]}function Ue(x){var $=-1,te=Array(x.size);return x.forEach(function(pe,ot){te[++$]=[ot,pe]}),te}function Re(x,$){return function(te){return x($(te))}}function qe(x){var $=-1,te=Array(x.size);return x.forEach(function(pe){te[++$]=pe}),te}var Ae=Array.prototype,Fe=Function.prototype,Se=Object.prototype,Ce=q["__core-js_shared__"],He=Fe.toString,Oe=Se.hasOwnProperty,ke=function(){var x=/[^.]+$/.exec(Ce&&Ce.keys&&Ce.keys.IE_PROTO||"");return x?"Symbol(src)_1."+x:""}(),Ge=Se.toString,et=RegExp("^"+He.call(Oe).replace(be,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),tt=P?q.Buffer:void 0,Je=q.Symbol,er=q.Uint8Array,hr=Se.propertyIsEnumerable,kr=Ae.splice,tr=Je?Je.toStringTag:void 0,ri=Object.getOwnPropertySymbols,gi=tt?tt.isBuffer:void 0,Ui=Re(Object.keys,Object),wt=_r(q,"DataView"),yt=_r(q,"Map"),Et=_r(q,"Promise"),Dt=_r(q,"Set"),mt=_r(q,"WeakMap"),vt=_r(Object,"create"),Rt=ni(wt),Ft=ni(yt),St=ni(Et),$t=ni(Dt),It=ni(mt),Ct=Je?Je.prototype:void 0,xt=Ct?Ct.valueOf:void 0;function ht(x){var $=-1,te=x==null?0:x.length;for(this.clear();++$<te;){var pe=x[$];this.set(pe[0],pe[1])}}function Lt(){this.__data__=vt?vt(null):{},this.size=0}function Mt(x){var $=this.has(x)&&delete this.__data__[x];return this.size-=$?1:0,$}function Wa(x){var $=this.__data__;if(vt){var te=$[x];return te===s?void 0:te}return Oe.call($,x)?$[x]:void 0}function Ga(x){var $=this.__data__;return vt?$[x]!==void 0:Oe.call($,x)}function Ya(x,$){var te=this.__data__;return this.size+=this.has(x)?0:1,te[x]=vt&&$===void 0?s:$,this}ht.prototype.clear=Lt,ht.prototype.delete=Mt,ht.prototype.get=Wa,ht.prototype.has=Ga,ht.prototype.set=Ya;function Ir(x){var $=-1,te=x==null?0:x.length;for(this.clear();++$<te;){var pe=x[$];this.set(pe[0],pe[1])}}function Ja(){this.__data__=[],this.size=0}function Xa(x){var $=this.__data__,te=Ri($,x);if(te<0)return!1;var pe=$.length-1;return te==pe?$.pop():kr.call($,te,1),--this.size,!0}function Qa(x){var $=this.__data__,te=Ri($,x);return te<0?void 0:$[te][1]}function Za(x){return Ri(this.__data__,x)>-1}function eo(x,$){var te=this.__data__,pe=Ri(te,x);return pe<0?(++this.size,te.push([x,$])):te[pe][1]=$,this}Ir.prototype.clear=Ja,Ir.prototype.delete=Xa,Ir.prototype.get=Qa,Ir.prototype.has=Za,Ir.prototype.set=eo;function ii(x){var $=-1,te=x==null?0:x.length;for(this.clear();++$<te;){var pe=x[$];this.set(pe[0],pe[1])}}function sn(){this.size=0,this.__data__={hash:new ht,map:new(yt||Ir),string:new ht}}function to(x){var $=yi(this,x).delete(x);return this.size-=$?1:0,$}function an(x){return yi(this,x).get(x)}function ro(x){return yi(this,x).has(x)}function io(x,$){var te=yi(this,x),pe=te.size;return te.set(x,$),this.size+=te.size==pe?0:1,this}ii.prototype.clear=sn,ii.prototype.delete=to,ii.prototype.get=an,ii.prototype.has=ro,ii.prototype.set=io;function on(x){var $=-1,te=x==null?0:x.length;for(this.__data__=new ii;++$<te;)this.add(x[$])}function ms(x){return this.__data__.set(x,s),this}function bs(x){return this.__data__.has(x)}on.prototype.add=on.prototype.push=ms,on.prototype.has=bs;function Mr(x){var $=this.__data__=new Ir(x);this.size=$.size}function no(){this.__data__=new Ir,this.size=0}function so(x){var $=this.__data__,te=$.delete(x);return this.size=$.size,te}function ao(x){return this.__data__.get(x)}function oo(x){return this.__data__.has(x)}function ws(x,$){var te=this.__data__;if(te instanceof Ir){var pe=te.__data__;if(!yt||pe.length<r-1)return pe.push([x,$]),this.size=++te.size,this;te=this.__data__=new ii(pe)}return te.set(x,$),this.size=te.size,this}Mr.prototype.clear=no,Mr.prototype.delete=so,Mr.prototype.get=ao,Mr.prototype.has=oo,Mr.prototype.set=ws;function Es(x,$){var te=hn(x),pe=!te&&Rs(x),ot=!te&&!pe&&Rn(x),Te=!te&&!pe&&!ot&&Ls(x),lt=te||pe||ot||Te,jt=lt?pt(x.length,String):[],Xe=jt.length;for(var ct in x)($||Oe.call(x,ct))&&!(lt&&(ct=="length"||ot&&(ct=="offset"||ct=="parent")||Te&&(ct=="buffer"||ct=="byteLength"||ct=="byteOffset")||Cs(ct,Xe)))&&jt.push(ct);return jt}function Ri(x,$){for(var te=x.length;te--;)if(Us(x[te][0],$))return te;return-1}function Nn(x,$,te){var pe=$(x);return hn(x)?pe:Ve(pe,te(x))}function Fi(x){return x==null?x===void 0?z:ie:tr&&tr in Object(x)?Os(x):ho(x)}function Un(x){return Li(x)&&Fi(x)==l}function $i(x,$,te,pe,ot){return x===$?!0:x==null||$==null||!Li(x)&&!Li($)?x!==x&&$!==$:Ds(x,$,te,pe,$i,ot)}function Ds(x,$,te,pe,ot,Te){var lt=hn(x),jt=hn($),Xe=lt?w:Wr(x),ct=jt?w:Wr($);Xe=Xe==l?p:Xe,ct=ct==l?p:ct;var Pt=Xe==p,fr=ct==p,qt=Xe==ct;if(qt&&Rn(x)){if(!Rn($))return!1;lt=!0,Pt=!1}if(qt&&!Pt)return Te||(Te=new Mr),lt||Ls(x)?cn(x,$,te,pe,ot,Te):uo(x,$,Xe,te,pe,ot,Te);if(!(te&o)){var dt=Pt&&Oe.call(x,"__wrapped__"),rr=fr&&Oe.call($,"__wrapped__");if(dt||rr){var jr=dt?x.value():x,xr=rr?$.value():$;return Te||(Te=new Mr),ot(jr,xr,te,pe,Te)}}return qt?(Te||(Te=new Mr),xs(x,$,te,pe,ot,Te)):!1}function co(x){if(!$s(x)||Ts(x))return!1;var $=fn(x)?et:ae;return $.test(ni(x))}function Ss(x){return Li(x)&&Fs(x.length)&&!!fe[Fi(x)]}function Is(x){if(!Ns(x))return Ui(x);var $=[];for(var te in Object(x))Oe.call(x,te)&&te!="constructor"&&$.push(te);return $}function cn(x,$,te,pe,ot,Te){var lt=te&o,jt=x.length,Xe=$.length;if(jt!=Xe&&!(lt&&Xe>jt))return!1;var ct=Te.get(x);if(ct&&Te.get($))return ct==$;var Pt=-1,fr=!0,qt=te&f?new on:void 0;for(Te.set(x,$),Te.set($,x);++Pt<jt;){var dt=x[Pt],rr=$[Pt];if(pe)var jr=lt?pe(rr,dt,Pt,$,x,Te):pe(dt,rr,Pt,x,$,Te);if(jr!==void 0){if(jr)continue;fr=!1;break}if(qt){if(!Le($,function(xr,Gr){if(!je(qt,Gr)&&(dt===xr||ot(dt,xr,te,pe,Te)))return qt.push(Gr)})){fr=!1;break}}else if(!(dt===rr||ot(dt,rr,te,pe,Te))){fr=!1;break}}return Te.delete(x),Te.delete($),fr}function uo(x,$,te,pe,ot,Te,lt){switch(te){case ce:if(x.byteLength!=$.byteLength||x.byteOffset!=$.byteOffset)return!1;x=x.buffer,$=$.buffer;case se:return!(x.byteLength!=$.byteLength||!Te(new er(x),new er($)));case I:case N:case K:return Us(+x,+$);case j:return x.name==$.name&&x.message==$.message;case _:case c:return x==$+"";case H:var jt=Ue;case d:var Xe=pe&o;if(jt||(jt=qe),x.size!=$.size&&!Xe)return!1;var ct=lt.get(x);if(ct)return ct==$;pe|=f,lt.set(x,$);var Pt=cn(jt(x),jt($),pe,ot,Te,lt);return lt.delete(x),Pt;case v:if(xt)return xt.call(x)==xt.call($)}return!1}function xs(x,$,te,pe,ot,Te){var lt=te&o,jt=un(x),Xe=jt.length,ct=un($),Pt=ct.length;if(Xe!=Pt&&!lt)return!1;for(var fr=Xe;fr--;){var qt=jt[fr];if(!(lt?qt in $:Oe.call($,qt)))return!1}var dt=Te.get(x);if(dt&&Te.get($))return dt==$;var rr=!0;Te.set(x,$),Te.set($,x);for(var jr=lt;++fr<Xe;){qt=jt[fr];var xr=x[qt],Gr=$[qt];if(pe)var Fn=lt?pe(Gr,xr,qt,$,x,Te):pe(xr,Gr,qt,x,$,Te);if(!(Fn===void 0?xr===Gr||ot(xr,Gr,te,pe,Te):Fn)){rr=!1;break}jr||(jr=qt=="constructor")}if(rr&&!jr){var Mi=x.constructor,Kt=$.constructor;Mi!=Kt&&"constructor"in x&&"constructor"in $&&!(typeof Mi=="function"&&Mi instanceof Mi&&typeof Kt=="function"&&Kt instanceof Kt)&&(rr=!1)}return Te.delete(x),Te.delete($),rr}function un(x){return Nn(x,po,As)}function yi(x,$){var te=x.__data__;return Ps($)?te[typeof $=="string"?"string":"hash"]:te.map}function _r(x,$){var te=xe(x,$);return co(te)?te:void 0}function Os(x){var $=Oe.call(x,tr),te=x[tr];try{x[tr]=void 0;var pe=!0}catch{}var ot=Ge.call(x);return pe&&($?x[tr]=te:delete x[tr]),ot}var As=ri?function(x){return x==null?[]:(x=Object(x),ze(ri(x),function($){return hr.call(x,$)}))}:at,Wr=Fi;(wt&&Wr(new wt(new ArrayBuffer(1)))!=ce||yt&&Wr(new yt)!=H||Et&&Wr(Et.resolve())!=b||Dt&&Wr(new Dt)!=d||mt&&Wr(new mt)!=G)&&(Wr=function(x){var $=Fi(x),te=$==p?x.constructor:void 0,pe=te?ni(te):"";if(pe)switch(pe){case Rt:return ce;case Ft:return H;case St:return b;case $t:return d;case It:return G}return $});function Cs(x,$){return $=$??m,!!$&&(typeof x=="number"||we.test(x))&&x>-1&&x%1==0&&x<$}function Ps(x){var $=typeof x;return $=="string"||$=="number"||$=="symbol"||$=="boolean"?x!=="__proto__":x===null}function Ts(x){return!!ke&&ke in x}function Ns(x){var $=x&&x.constructor,te=typeof $=="function"&&$.prototype||Se;return x===te}function ho(x){return Ge.call(x)}function ni(x){if(x!=null){try{return He.call(x)}catch{}try{return x+""}catch{}}return""}function Us(x,$){return x===$||x!==x&&$!==$}var Rs=Un(function(){return arguments}())?Un:function(x){return Li(x)&&Oe.call(x,"callee")&&!hr.call(x,"callee")},hn=Array.isArray;function fo(x){return x!=null&&Fs(x.length)&&!fn(x)}var Rn=gi||st;function lo(x,$){return $i(x,$)}function fn(x){if(!$s(x))return!1;var $=Fi(x);return $==R||$==U||$==O||$==y}function Fs(x){return typeof x=="number"&&x>-1&&x%1==0&&x<=m}function $s(x){var $=typeof x;return x!=null&&($=="object"||$=="function")}function Li(x){return x!=null&&typeof x=="object"}var Ls=Ie?gt(Ie):Ss;function po(x){return fo(x)?Es(x):Is(x)}function at(){return[]}function st(){return!1}n.exports=lo})(Ra,Ra.exports);var O3=Ra.exports;const A3=sd(O3);function C3(n,t){if(n.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),s=0;s<r.length;s++)r[s]=255;for(var o=0;o<n.length;o++){var f=n.charAt(o),m=f.charCodeAt(0);if(r[m]!==255)throw new TypeError(f+" is ambiguous");r[m]=o}var l=n.length,w=n.charAt(0),O=Math.log(l)/Math.log(256),I=Math.log(256)/Math.log(l);function N(U){if(U instanceof Uint8Array||(ArrayBuffer.isView(U)?U=new Uint8Array(U.buffer,U.byteOffset,U.byteLength):Array.isArray(U)&&(U=Uint8Array.from(U))),!(U instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(U.length===0)return"";for(var H=0,K=0,ie=0,p=U.length;ie!==p&&U[ie]===0;)ie++,H++;for(var b=(p-ie)*I+1>>>0,y=new Uint8Array(b);ie!==p;){for(var _=U[ie],d=0,c=b-1;(_!==0||d<K)&&c!==-1;c--,d++)_+=256*y[c]>>>0,y[c]=_%l>>>0,_=_/l>>>0;if(_!==0)throw new Error("Non-zero carry");K=d,ie++}for(var v=b-K;v!==b&&y[v]===0;)v++;for(var z=w.repeat(H);v<b;++v)z+=n.charAt(y[v]);return z}function j(U){if(typeof U!="string")throw new TypeError("Expected String");if(U.length===0)return new Uint8Array;var H=0;if(U[H]!==" "){for(var K=0,ie=0;U[H]===w;)K++,H++;for(var p=(U.length-H)*O+1>>>0,b=new Uint8Array(p);U[H];){var y=r[U.charCodeAt(H)];if(y===255)return;for(var _=0,d=p-1;(y!==0||_<ie)&&d!==-1;d--,_++)y+=l*b[d]>>>0,b[d]=y%256>>>0,y=y/256>>>0;if(y!==0)throw new Error("Non-zero carry");ie=_,H++}if(U[H]!==" "){for(var c=p-ie;c!==p&&b[c]===0;)c++;for(var v=new Uint8Array(K+(p-c)),z=K;c!==p;)v[z++]=b[c++];return v}}}function R(U){var H=j(U);if(H)return H;throw new Error(`Non-${t} character`)}return{encode:N,decodeUnsafe:j,decode:R}}var P3=C3,T3=P3;const Yd=n=>{if(n instanceof Uint8Array&&n.constructor.name==="Uint8Array")return n;if(n instanceof ArrayBuffer)return new Uint8Array(n);if(ArrayBuffer.isView(n))return new Uint8Array(n.buffer,n.byteOffset,n.byteLength);throw new Error("Unknown type, must be binary type")},N3=n=>new TextEncoder().encode(n),U3=n=>new TextDecoder().decode(n);class R3{constructor(t,r,s){this.name=t,this.prefix=r,this.baseEncode=s}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}}class F3{constructor(t,r,s){if(this.name=t,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=s}decode(t){if(typeof t=="string"){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(t){return Jd(this,t)}}class $3{constructor(t){this.decoders=t}or(t){return Jd(this,t)}decode(t){const r=t[0],s=this.decoders[r];if(s)return s.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const Jd=(n,t)=>new $3({...n.decoders||{[n.prefix]:n},...t.decoders||{[t.prefix]:t}});class L3{constructor(t,r,s,o){this.name=t,this.prefix=r,this.baseEncode=s,this.baseDecode=o,this.encoder=new R3(t,r,s),this.decoder=new F3(t,r,o)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}}const Va=({name:n,prefix:t,encode:r,decode:s})=>new L3(n,t,r,s),_s=({prefix:n,name:t,alphabet:r})=>{const{encode:s,decode:o}=T3(r,t);return Va({prefix:n,name:t,encode:s,decode:f=>Yd(o(f))})},M3=(n,t,r,s)=>{const o={};for(let I=0;I<t.length;++I)o[t[I]]=I;let f=n.length;for(;n[f-1]==="=";)--f;const m=new Uint8Array(f*r/8|0);let l=0,w=0,O=0;for(let I=0;I<f;++I){const N=o[n[I]];if(N===void 0)throw new SyntaxError(`Non-${s} character`);w=w<<r|N,l+=r,l>=8&&(l-=8,m[O++]=255&w>>l)}if(l>=r||255&w<<8-l)throw new SyntaxError("Unexpected end of data");return m},j3=(n,t,r)=>{const s=t[t.length-1]==="=",o=(1<<r)-1;let f="",m=0,l=0;for(let w=0;w<n.length;++w)for(l=l<<8|n[w],m+=8;m>r;)m-=r,f+=t[o&l>>m];if(m&&(f+=t[o&l<<r-m]),s)for(;f.length*r&7;)f+="=";return f},Jt=({name:n,prefix:t,bitsPerChar:r,alphabet:s})=>Va({prefix:t,name:n,encode(o){return j3(o,s,r)},decode(o){return M3(o,s,r,n)}}),q3=Va({prefix:"\0",name:"identity",encode:n=>U3(n),decode:n=>N3(n)});var B3=Object.freeze({__proto__:null,identity:q3});const z3=Jt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var H3=Object.freeze({__proto__:null,base2:z3});const K3=Jt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var V3=Object.freeze({__proto__:null,base8:K3});const k3=_s({prefix:"9",name:"base10",alphabet:"0123456789"});var W3=Object.freeze({__proto__:null,base10:k3});const G3=Jt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Y3=Jt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var J3=Object.freeze({__proto__:null,base16:G3,base16upper:Y3});const X3=Jt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Q3=Jt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Z3=Jt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),eD=Jt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),tD=Jt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),rD=Jt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),iD=Jt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),nD=Jt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),sD=Jt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var aD=Object.freeze({__proto__:null,base32:X3,base32upper:Q3,base32pad:Z3,base32padupper:eD,base32hex:tD,base32hexupper:rD,base32hexpad:iD,base32hexpadupper:nD,base32z:sD});const oD=_s({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),cD=_s({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var uD=Object.freeze({__proto__:null,base36:oD,base36upper:cD});const hD=_s({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),fD=_s({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var lD=Object.freeze({__proto__:null,base58btc:hD,base58flickr:fD});const dD=Jt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),pD=Jt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),gD=Jt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),yD=Jt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var vD=Object.freeze({__proto__:null,base64:dD,base64pad:pD,base64url:gD,base64urlpad:yD});const Xd=Array.from("ðŸš€ðŸªâ˜„ðŸ›°ðŸŒŒðŸŒ‘ðŸŒ’ðŸŒ“ðŸŒ”ðŸŒ•ðŸŒ–ðŸŒ—ðŸŒ˜ðŸŒðŸŒðŸŒŽðŸ‰â˜€ðŸ’»ðŸ–¥ðŸ’¾ðŸ’¿ðŸ˜‚â¤ðŸ˜ðŸ¤£ðŸ˜ŠðŸ™ðŸ’•ðŸ˜­ðŸ˜˜ðŸ‘ðŸ˜…ðŸ‘ðŸ˜ðŸ”¥ðŸ¥°ðŸ’”ðŸ’–ðŸ’™ðŸ˜¢ðŸ¤”ðŸ˜†ðŸ™„ðŸ’ªðŸ˜‰â˜ºðŸ‘ŒðŸ¤—ðŸ’œðŸ˜”ðŸ˜ŽðŸ˜‡ðŸŒ¹ðŸ¤¦ðŸŽ‰ðŸ’žâœŒâœ¨ðŸ¤·ðŸ˜±ðŸ˜ŒðŸŒ¸ðŸ™ŒðŸ˜‹ðŸ’—ðŸ’šðŸ˜ðŸ’›ðŸ™‚ðŸ’“ðŸ¤©ðŸ˜„ðŸ˜€ðŸ–¤ðŸ˜ƒðŸ’¯ðŸ™ˆðŸ‘‡ðŸŽ¶ðŸ˜’ðŸ¤­â£ðŸ˜œðŸ’‹ðŸ‘€ðŸ˜ªðŸ˜‘ðŸ’¥ðŸ™‹ðŸ˜žðŸ˜©ðŸ˜¡ðŸ¤ªðŸ‘ŠðŸ¥³ðŸ˜¥ðŸ¤¤ðŸ‘‰ðŸ’ƒðŸ˜³âœ‹ðŸ˜šðŸ˜ðŸ˜´ðŸŒŸðŸ˜¬ðŸ™ƒðŸ€ðŸŒ·ðŸ˜»ðŸ˜“â­âœ…ðŸ¥ºðŸŒˆðŸ˜ˆðŸ¤˜ðŸ’¦âœ”ðŸ˜£ðŸƒðŸ’â˜¹ðŸŽŠðŸ’˜ðŸ˜ â˜ðŸ˜•ðŸŒºðŸŽ‚ðŸŒ»ðŸ˜ðŸ–•ðŸ’ðŸ™ŠðŸ˜¹ðŸ—£ðŸ’«ðŸ’€ðŸ‘‘ðŸŽµðŸ¤žðŸ˜›ðŸ”´ðŸ˜¤ðŸŒ¼ðŸ˜«âš½ðŸ¤™â˜•ðŸ†ðŸ¤«ðŸ‘ˆðŸ˜®ðŸ™†ðŸ»ðŸƒðŸ¶ðŸ’ðŸ˜²ðŸŒ¿ðŸ§¡ðŸŽâš¡ðŸŒžðŸŽˆâŒâœŠðŸ‘‹ðŸ˜°ðŸ¤¨ðŸ˜¶ðŸ¤ðŸš¶ðŸ’°ðŸ“ðŸ’¢ðŸ¤ŸðŸ™ðŸš¨ðŸ’¨ðŸ¤¬âœˆðŸŽ€ðŸºðŸ¤“ðŸ˜™ðŸ’ŸðŸŒ±ðŸ˜–ðŸ‘¶ðŸ¥´â–¶âž¡â“ðŸ’ŽðŸ’¸â¬‡ðŸ˜¨ðŸŒšðŸ¦‹ðŸ˜·ðŸ•ºâš ðŸ™…ðŸ˜ŸðŸ˜µðŸ‘ŽðŸ¤²ðŸ¤ ðŸ¤§ðŸ“ŒðŸ”µðŸ’…ðŸ§ðŸ¾ðŸ’ðŸ˜—ðŸ¤‘ðŸŒŠðŸ¤¯ðŸ·â˜ŽðŸ’§ðŸ˜¯ðŸ’†ðŸ‘†ðŸŽ¤ðŸ™‡ðŸ‘â„ðŸŒ´ðŸ’£ðŸ¸ðŸ’ŒðŸ“ðŸ¥€ðŸ¤¢ðŸ‘…ðŸ’¡ðŸ’©ðŸ‘ðŸ“¸ðŸ‘»ðŸ¤ðŸ¤®ðŸŽ¼ðŸ¥µðŸš©ðŸŽðŸŠðŸ‘¼ðŸ’ðŸ“£ðŸ¥‚"),_D=Xd.reduce((n,t,r)=>(n[r]=t,n),[]),mD=Xd.reduce((n,t,r)=>(n[t.codePointAt(0)]=r,n),[]);function bD(n){return n.reduce((t,r)=>(t+=_D[r],t),"")}function wD(n){const t=[];for(const r of n){const s=mD[r.codePointAt(0)];if(s===void 0)throw new Error(`Non-base256emoji character: ${r}`);t.push(s)}return new Uint8Array(t)}const ED=Va({prefix:"ðŸš€",name:"base256emoji",encode:bD,decode:wD});var DD=Object.freeze({__proto__:null,base256emoji:ED}),SD=Qd,Il=128,ID=127,xD=~ID,OD=Math.pow(2,31);function Qd(n,t,r){t=t||[],r=r||0;for(var s=r;n>=OD;)t[r++]=n&255|Il,n/=128;for(;n&xD;)t[r++]=n&255|Il,n>>>=7;return t[r]=n|0,Qd.bytes=r-s+1,t}var AD=Jc,CD=128,xl=127;function Jc(n,s){var r=0,s=s||0,o=0,f=s,m,l=n.length;do{if(f>=l)throw Jc.bytes=0,new RangeError("Could not decode varint");m=n[f++],r+=o<28?(m&xl)<<o:(m&xl)*Math.pow(2,o),o+=7}while(m>=CD);return Jc.bytes=f-s,r}var PD=Math.pow(2,7),TD=Math.pow(2,14),ND=Math.pow(2,21),UD=Math.pow(2,28),RD=Math.pow(2,35),FD=Math.pow(2,42),$D=Math.pow(2,49),LD=Math.pow(2,56),MD=Math.pow(2,63),jD=function(n){return n<PD?1:n<TD?2:n<ND?3:n<UD?4:n<RD?5:n<FD?6:n<$D?7:n<LD?8:n<MD?9:10},qD={encode:SD,decode:AD,encodingLength:jD},Zd=qD;const Ol=(n,t,r=0)=>(Zd.encode(n,t,r),t),Al=n=>Zd.encodingLength(n),Xc=(n,t)=>{const r=t.byteLength,s=Al(n),o=s+Al(r),f=new Uint8Array(o+r);return Ol(n,f,0),Ol(r,f,s),f.set(t,o),new BD(n,r,t,f)};class BD{constructor(t,r,s,o){this.code=t,this.size=r,this.digest=s,this.bytes=o}}const ep=({name:n,code:t,encode:r})=>new zD(n,t,r);class zD{constructor(t,r,s){this.name=t,this.code=r,this.encode=s}digest(t){if(t instanceof Uint8Array){const r=this.encode(t);return r instanceof Uint8Array?Xc(this.code,r):r.then(s=>Xc(this.code,s))}else throw Error("Unknown type, must be binary type")}}const tp=n=>async t=>new Uint8Array(await crypto.subtle.digest(n,t)),HD=ep({name:"sha2-256",code:18,encode:tp("SHA-256")}),KD=ep({name:"sha2-512",code:19,encode:tp("SHA-512")});var VD=Object.freeze({__proto__:null,sha256:HD,sha512:KD});const rp=0,kD="identity",ip=Yd,WD=n=>Xc(rp,ip(n)),GD={code:rp,name:kD,encode:ip,digest:WD};var YD=Object.freeze({__proto__:null,identity:GD});new TextEncoder,new TextDecoder;const Cl={...B3,...H3,...V3,...W3,...J3,...aD,...uD,...lD,...vD,...DD};({...VD,...YD});function np(n){return globalThis.Buffer!=null?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):n}function JD(n=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?np(globalThis.Buffer.allocUnsafe(n)):new Uint8Array(n)}function sp(n,t,r,s){return{name:n,prefix:t,encoder:{name:n,prefix:t,encode:r},decoder:{decode:s}}}const Pl=sp("utf8","u",n=>"u"+new TextDecoder("utf8").decode(n),n=>new TextEncoder().encode(n.substring(1))),Ac=sp("ascii","a",n=>{let t="a";for(let r=0;r<n.length;r++)t+=String.fromCharCode(n[r]);return t},n=>{n=n.substring(1);const t=JD(n.length);for(let r=0;r<n.length;r++)t[r]=n.charCodeAt(r);return t}),XD={utf8:Pl,"utf-8":Pl,hex:Cl.base16,latin1:Ac,ascii:Ac,binary:Ac,...Cl};function QD(n,t="utf8"){const r=XD[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?np(globalThis.Buffer.from(n,"utf-8")):r.decoder.decode(`${r.prefix}${n}`)}const ap="wc",ZD=2,xu="core",Ci=`${ap}@2:${xu}:`,e6={name:xu,logger:"error"},t6={database:":memory:"},r6="crypto",Tl="client_ed25519_seed",i6=_e.ONE_DAY,n6="keychain",s6="0.3",a6="messages",o6="0.3",c6=_e.SIX_HOURS,u6="publisher",op="irn",h6="error",cp="wss://relay.walletconnect.com",f6="relayer",At={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},l6="_subscription",ns={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},d6=_e.ONE_SECOND/2,p6="2.8.0",g6=1e4,y6="0.3",v6="WALLETCONNECT_CLIENT_ID",ei={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},_6="subscription",m6="0.3",b6=_e.FIVE_SECONDS*1e3,w6="pairing",E6="0.3",ss={wc_pairingDelete:{req:{ttl:_e.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:_e.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:_e.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:_e.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:_e.ONE_DAY,prompt:!1,tag:0},res:{ttl:_e.ONE_DAY,prompt:!1,tag:0}}},Zr={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},D6="history",S6="0.3",I6="expirer",Fr={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},x6="0.3",Cc="verify-api",Nl="https://verify.walletconnect.com";class O6{constructor(t,r){this.core=t,this.logger=r,this.keychain=new Map,this.name=n6,this.version=s6,this.initialized=!1,this.storagePrefix=Ci,this.init=async()=>{if(!this.initialized){const s=await this.getKeyChain();typeof s<"u"&&(this.keychain=s),this.initialized=!0}},this.has=s=>(this.isInitialized(),this.keychain.has(s)),this.set=async(s,o)=>{this.isInitialized(),this.keychain.set(s,o),await this.persist()},this.get=s=>{this.isInitialized();const o=this.keychain.get(s);if(typeof o>"u"){const{message:f}=he("NO_MATCHING_KEY",`${this.name}: ${s}`);throw new Error(f)}return o},this.del=async s=>{this.isInitialized(),this.keychain.delete(s),await this.persist()},this.core=t,this.logger=Ze.generateChildLogger(r,this.name)}get context(){return Ze.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setKeyChain(t){await this.core.storage.setItem(this.storageKey,Hd(t))}async getKeyChain(){const t=await this.core.storage.getItem(this.storageKey);return typeof t<"u"?Kd(t):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:t}=he("NOT_INITIALIZED",this.name);throw new Error(t)}}}class A6{constructor(t,r,s){this.core=t,this.logger=r,this.name=r6,this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=o=>(this.isInitialized(),this.keychain.has(o)),this.getClientId=async()=>{this.isInitialized();const o=await this.getClientSeed(),f=ll(o);return $d(f.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const o=yE();return this.setPrivateKey(o.publicKey,o.privateKey)},this.signJWT=async o=>{this.isInitialized();const f=await this.getClientSeed(),m=ll(f),l=Gc();return await pE(l,o,i6,m)},this.generateSharedKey=(o,f,m)=>{this.isInitialized();const l=this.getPrivateKey(o),w=vE(l,f);return this.setSymKey(w,m)},this.setSymKey=async(o,f)=>{this.isInitialized();const m=f||_E(o);return await this.keychain.set(m,o),m},this.deleteKeyPair=async o=>{this.isInitialized(),await this.keychain.del(o)},this.deleteSymKey=async o=>{this.isInitialized(),await this.keychain.del(o)},this.encode=async(o,f,m)=>{this.isInitialized();const l=qd(m),w=hs(f);if(pl(l)){const j=l.senderPublicKey,R=l.receiverPublicKey;o=await this.generateSharedKey(j,R)}const O=this.getSymKey(o),{type:I,senderPublicKey:N}=l;return bE({type:I,symKey:O,message:w,senderPublicKey:N})},this.decode=async(o,f,m)=>{this.isInitialized();const l=DE(f,m);if(pl(l)){const I=l.receiverPublicKey,N=l.senderPublicKey;o=await this.generateSharedKey(I,N)}const w=this.getSymKey(o),O=wE({symKey:w,encoded:f});return _u(O)},this.getPayloadType=o=>{const f=Na(o);return ys(f.type)},this.getPayloadSenderPublicKey=o=>{const f=Na(o);return f.senderPublicKey?ur(f.senderPublicKey,cr):void 0},this.core=t,this.logger=Ze.generateChildLogger(r,this.name),this.keychain=s||new O6(this.core,this.logger)}get context(){return Ze.getLoggerContext(this.logger)}async setPrivateKey(t,r){return await this.keychain.set(t,r),t}getPrivateKey(t){return this.keychain.get(t)}async getClientSeed(){let t="";try{t=this.keychain.get(Tl)}catch{t=Gc(),await this.keychain.set(Tl,t)}return QD(t,"base16")}getSymKey(t){return this.keychain.get(t)}isInitialized(){if(!this.initialized){const{message:t}=he("NOT_INITIALIZED",this.name);throw new Error(t)}}}class C6 extends Kw{constructor(t,r){super(t,r),this.logger=t,this.core=r,this.messages=new Map,this.name=a6,this.version=o6,this.initialized=!1,this.storagePrefix=Ci,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const s=await this.getRelayerMessages();typeof s<"u"&&(this.messages=s),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(s){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(s)}finally{this.initialized=!0}}},this.set=async(s,o)=>{this.isInitialized();const f=An(o);let m=this.messages.get(s);return typeof m>"u"&&(m={}),typeof m[f]<"u"||(m[f]=o,this.messages.set(s,m),await this.persist()),f},this.get=s=>{this.isInitialized();let o=this.messages.get(s);return typeof o>"u"&&(o={}),o},this.has=(s,o)=>{this.isInitialized();const f=this.get(s),m=An(o);return typeof f[m]<"u"},this.del=async s=>{this.isInitialized(),this.messages.delete(s),await this.persist()},this.logger=Ze.generateChildLogger(t,this.name),this.core=r}get context(){return Ze.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setRelayerMessages(t){await this.core.storage.setItem(this.storageKey,Hd(t))}async getRelayerMessages(){const t=await this.core.storage.getItem(this.storageKey);return typeof t<"u"?Kd(t):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:t}=he("NOT_INITIALIZED",this.name);throw new Error(t)}}}let P6=class extends Vw{constructor(t,r){super(t,r),this.relayer=t,this.logger=r,this.events=new Lr.EventEmitter,this.name=u6,this.queue=new Map,this.publishTimeout=1e4,this.publish=async(s,o,f)=>{this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:s,message:o,opts:f}});try{const m=(f==null?void 0:f.ttl)||c6,l=Yc(f),w=(f==null?void 0:f.prompt)||!1,O=(f==null?void 0:f.tag)||0,I=(f==null?void 0:f.id)||cu().toString(),N={topic:s,message:o,opts:{ttl:m,relay:l,prompt:w,tag:O,id:I}};this.queue.set(I,N);try{await await Ua(this.rpcPublish(s,o,m,l,w,O,I),this.publishTimeout),this.relayer.events.emit(At.publish,N)}catch{this.logger.debug("Publishing Payload stalled"),this.relayer.events.emit(At.connection_stalled);return}this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:s,message:o,opts:f}})}catch(m){throw this.logger.debug("Failed to Publish Payload"),this.logger.error(m),m}},this.on=(s,o)=>{this.events.on(s,o)},this.once=(s,o)=>{this.events.once(s,o)},this.off=(s,o)=>{this.events.off(s,o)},this.removeListener=(s,o)=>{this.events.removeListener(s,o)},this.relayer=t,this.logger=Ze.generateChildLogger(r,this.name),this.registerEventListeners()}get context(){return Ze.getLoggerContext(this.logger)}rpcPublish(t,r,s,o,f,m,l){var w,O,I,N;const j={method:xa(o.protocol).publish,params:{topic:t,message:r,ttl:s,prompt:f,tag:m},id:l};return or((w=j.params)==null?void 0:w.prompt)&&((O=j.params)==null||delete O.prompt),or((I=j.params)==null?void 0:I.tag)&&((N=j.params)==null||delete N.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:j}),this.relayer.request(j)}onPublish(t){this.queue.delete(t)}checkQueue(){this.queue.forEach(async t=>{const{topic:r,message:s,opts:o}=t;await this.publish(r,s,o)})}registerEventListeners(){this.relayer.core.heartbeat.on(gs.HEARTBEAT_EVENTS.pulse,()=>{this.checkQueue()}),this.relayer.on(At.message_ack,t=>{this.onPublish(t.id.toString())})}};class T6{constructor(){this.map=new Map,this.set=(t,r)=>{const s=this.get(t);this.exists(t,r)||this.map.set(t,[...s,r])},this.get=t=>this.map.get(t)||[],this.exists=(t,r)=>this.get(t).includes(r),this.delete=(t,r)=>{if(typeof r>"u"){this.map.delete(t);return}if(!this.map.has(t))return;const s=this.get(t);if(!this.exists(t,r))return;const o=s.filter(f=>f!==r);if(!o.length){this.map.delete(t);return}this.map.set(t,o)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var N6=Object.defineProperty,U6=Object.defineProperties,R6=Object.getOwnPropertyDescriptors,Ul=Object.getOwnPropertySymbols,F6=Object.prototype.hasOwnProperty,$6=Object.prototype.propertyIsEnumerable,Rl=(n,t,r)=>t in n?N6(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,as=(n,t)=>{for(var r in t||(t={}))F6.call(t,r)&&Rl(n,r,t[r]);if(Ul)for(var r of Ul(t))$6.call(t,r)&&Rl(n,r,t[r]);return n},Pc=(n,t)=>U6(n,R6(t));class L6 extends Gw{constructor(t,r){super(t,r),this.relayer=t,this.logger=r,this.subscriptions=new Map,this.topicMap=new T6,this.events=new Lr.EventEmitter,this.name=_6,this.version=m6,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pollingInterval=20,this.storagePrefix=Ci,this.subscribeTimeout=1e4,this.restartInProgress=!1,this.batchSubscribeTopicsLimit=500,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restart(),this.registerEventListeners(),this.onEnable(),this.clientId=await this.relayer.core.crypto.getClientId())},this.subscribe=async(s,o)=>{await this.restartToComplete(),this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:s,opts:o}});try{const f=Yc(o),m={topic:s,relay:f};this.pending.set(s,m);const l=await this.rpcSubscribe(s,f);return this.onSubscribe(l,m),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:s,opts:o}}),l}catch(f){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(f),f}},this.unsubscribe=async(s,o)=>{await this.restartToComplete(),this.isInitialized(),typeof(o==null?void 0:o.id)<"u"?await this.unsubscribeById(s,o.id,o):await this.unsubscribeByTopic(s,o)},this.isSubscribed=async s=>this.topics.includes(s)?!0:await new Promise((o,f)=>{const m=new _e.Watch;m.start(this.pendingSubscriptionWatchLabel);const l=setInterval(()=>{!this.pending.has(s)&&this.topics.includes(s)&&(clearInterval(l),m.stop(this.pendingSubscriptionWatchLabel),o(!0)),m.elapsed(this.pendingSubscriptionWatchLabel)>=b6&&(clearInterval(l),m.stop(this.pendingSubscriptionWatchLabel),f(new Error("Subscription resolution timeout")))},this.pollingInterval)}).catch(()=>!1),this.on=(s,o)=>{this.events.on(s,o)},this.once=(s,o)=>{this.events.once(s,o)},this.off=(s,o)=>{this.events.off(s,o)},this.removeListener=(s,o)=>{this.events.removeListener(s,o)},this.restart=async()=>{this.restartInProgress=!0,await this.restore(),await this.reset(),this.restartInProgress=!1},this.relayer=t,this.logger=Ze.generateChildLogger(r,this.name),this.clientId=""}get context(){return Ze.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(t,r){let s=!1;try{s=this.getSubscription(t).topic===r}catch{}return s}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(t,r){const s=this.topicMap.get(t);await Promise.all(s.map(async o=>await this.unsubscribeById(t,o,r)))}async unsubscribeById(t,r,s){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:t,id:r,opts:s}});try{const o=Yc(s);await this.rpcUnsubscribe(t,r,o);const f=kt("USER_DISCONNECTED",`${this.name}, ${t}`);await this.onUnsubscribe(t,r,f),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:t,id:r,opts:s}})}catch(o){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(o),o}}async rpcSubscribe(t,r){const s={method:xa(r.protocol).subscribe,params:{topic:t}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s});try{await await Ua(this.relayer.request(s),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(At.connection_stalled)}return An(t+this.clientId)}async rpcBatchSubscribe(t){if(!t.length)return;const r=t[0].relay,s={method:xa(r.protocol).batchSubscribe,params:{topics:t.map(o=>o.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s});try{return await await Ua(this.relayer.request(s),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Payload stalled"),this.relayer.events.emit(At.connection_stalled)}}rpcUnsubscribe(t,r,s){const o={method:xa(s.protocol).unsubscribe,params:{topic:t,id:r}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:o}),this.relayer.request(o)}onSubscribe(t,r){this.setSubscription(t,Pc(as({},r),{id:t})),this.pending.delete(r.topic)}onBatchSubscribe(t){t.length&&t.forEach(r=>{this.setSubscription(r.id,as({},r)),this.pending.delete(r.topic)})}async onUnsubscribe(t,r,s){this.events.removeAllListeners(r),this.hasSubscription(r,t)&&this.deleteSubscription(r,s),await this.relayer.messages.del(t)}async setRelayerSubscriptions(t){await this.relayer.core.storage.setItem(this.storageKey,t)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(t,r){this.subscriptions.has(t)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:t,subscription:r}),this.addSubscription(t,r))}addSubscription(t,r){this.subscriptions.set(t,as({},r)),this.topicMap.set(r.topic,t),this.events.emit(ei.created,r)}getSubscription(t){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:t});const r=this.subscriptions.get(t);if(!r){const{message:s}=he("NO_MATCHING_KEY",`${this.name}: ${t}`);throw new Error(s)}return r}deleteSubscription(t,r){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:t,reason:r});const s=this.getSubscription(t);this.subscriptions.delete(t),this.topicMap.delete(s.topic,t),this.events.emit(ei.deleted,Pc(as({},s),{reason:r}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(ei.sync)}async reset(){if(this.cached.length){const t=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let r=0;r<t;r++){const s=this.cached.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(s)}}this.events.emit(ei.resubscribed)}async restore(){try{const t=await this.getRelayerSubscriptions();if(typeof t>"u"||!t.length)return;if(this.subscriptions.size){const{message:r}=he("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(t){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(t)}}async batchSubscribe(t){if(!t.length)return;const r=await this.rpcBatchSubscribe(t);vs(r)&&this.onBatchSubscribe(r.map((s,o)=>Pc(as({},t[o]),{id:s})))}async onConnect(){this.restartInProgress||(await this.restart(),this.onEnable())}onDisconnect(){this.onDisable()}async checkPending(){if(this.relayer.transportExplicitlyClosed)return;const t=[];this.pending.forEach(r=>{t.push(r)}),await this.batchSubscribe(t)}registerEventListeners(){this.relayer.core.heartbeat.on(gs.HEARTBEAT_EVENTS.pulse,async()=>{await this.checkPending()}),this.relayer.on(At.connect,async()=>{await this.onConnect()}),this.relayer.on(At.disconnect,()=>{this.onDisconnect()}),this.events.on(ei.created,async t=>{const r=ei.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),await this.persist()}),this.events.on(ei.deleted,async t=>{const r=ei.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),await this.persist()})}isInitialized(){if(!this.initialized){const{message:t}=he("NOT_INITIALIZED",this.name);throw new Error(t)}}async restartToComplete(){this.restartInProgress&&await new Promise(t=>{const r=setInterval(()=>{this.restartInProgress||(clearInterval(r),t())},this.pollingInterval)})}}var M6=Object.defineProperty,Fl=Object.getOwnPropertySymbols,j6=Object.prototype.hasOwnProperty,q6=Object.prototype.propertyIsEnumerable,$l=(n,t,r)=>t in n?M6(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,B6=(n,t)=>{for(var r in t||(t={}))j6.call(t,r)&&$l(n,r,t[r]);if(Fl)for(var r of Fl(t))q6.call(t,r)&&$l(n,r,t[r]);return n};let z6=class extends kw{constructor(t){super(t),this.protocol="wc",this.version=2,this.events=new Lr.EventEmitter,this.name=f6,this.transportExplicitlyClosed=!1,this.initialized=!1,this.reconnecting=!1,this.connectionStatusPollingInterval=20,this.staleConnectionErrors=["socket hang up","socket stalled"],this.request=async r=>{this.logger.debug("Publishing Request Payload");try{return await this.toEstablishConnection(),await this.provider.request(r)}catch(s){throw this.logger.debug("Failed to Publish Request"),this.logger.error(s),s}},this.core=t.core,this.logger=typeof t.logger<"u"&&typeof t.logger!="string"?Ze.generateChildLogger(t.logger,this.name):Ze.pino(Ze.getDefaultLoggerOptions({level:t.logger||h6})),this.messages=new C6(this.logger,t.core),this.subscriber=new L6(this,this.logger),this.publisher=new P6(this,this.logger),this.relayUrl=(t==null?void 0:t.relayUrl)||cp,this.projectId=t.projectId,this.provider={}}async init(){this.logger.trace("Initialized"),await this.createProvider(),await Promise.all([this.messages.init(),this.transportOpen(),this.subscriber.init()]),this.registerEventListeners(),this.initialized=!0,setTimeout(async()=>{this.subscriber.topics.length===0&&(this.logger.info("No topics subscribted to after init, closing transport"),await this.transportClose(),this.transportExplicitlyClosed=!1)},g6)}get context(){return Ze.getLoggerContext(this.logger)}get connected(){return this.provider.connection.connected}get connecting(){return this.provider.connection.connecting}async publish(t,r,s){this.isInitialized(),await this.publisher.publish(t,r,s),await this.recordMessageEvent({topic:t,message:r,publishedAt:Date.now()})}async subscribe(t,r){var s;this.isInitialized();let o=((s=this.subscriber.topicMap.get(t))==null?void 0:s[0])||"";return o||(await Promise.all([new Promise(f=>{this.subscriber.once(ei.created,m=>{m.topic===t&&f()})}),new Promise(async f=>{o=await this.subscriber.subscribe(t,r),f()})]),o)}async unsubscribe(t,r){this.isInitialized(),await this.subscriber.unsubscribe(t,r)}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async transportClose(){this.transportExplicitlyClosed=!0,this.connected&&(await this.provider.disconnect(),this.events.emit(At.transport_closed))}async transportOpen(t){if(this.transportExplicitlyClosed=!1,!this.reconnecting){this.relayUrl=t||this.relayUrl,this.reconnecting=!0;try{await Promise.all([new Promise(r=>{this.initialized||r(),this.subscriber.once(ei.resubscribed,()=>{r()})}),await Promise.race([new Promise(async(r,s)=>{await Ua(this.provider.connect(),5e3,"socket stalled").catch(o=>s(o)).then(()=>r()).finally(()=>this.removeListener(At.transport_closed,this.rejectTransportOpen))}),new Promise(r=>this.once(At.transport_closed,this.rejectTransportOpen))])])}catch(r){this.logger.error(r);const s=r;if(!this.isConnectionStalled(s.message))throw r;this.events.emit(At.transport_closed)}finally{this.reconnecting=!1}}}async restartTransport(t){this.transportExplicitlyClosed||this.reconnecting||(this.relayUrl=t||this.relayUrl,this.connected&&await Promise.all([new Promise(r=>{this.provider.once(ns.disconnect,()=>{r()})}),this.transportClose()]),await this.createProvider(),await this.transportOpen())}isConnectionStalled(t){return this.staleConnectionErrors.some(r=>t.includes(r))}rejectTransportOpen(){throw new Error("closeTransport called before connection was established")}async createProvider(){const t=await this.core.crypto.signJWT(this.relayUrl);this.provider=new Ti(new x3(RE({sdkVersion:p6,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:t,useOnCloseEvent:!0}))),this.registerProviderListeners()}async recordMessageEvent(t){const{topic:r,message:s}=t;await this.messages.set(r,s)}async shouldIgnoreMessageEvent(t){const{topic:r,message:s}=t;return await this.subscriber.isSubscribed(r)?this.messages.has(r,s):!0}async onProviderPayload(t){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:t}),hu(t)){if(!t.method.endsWith(l6))return;const r=t.params,{topic:s,message:o,publishedAt:f}=r.data,m={topic:s,message:o,publishedAt:f};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(B6({type:"event",event:r.id},m)),this.events.emit(r.id,m),await this.acknowledgePayload(t),await this.onMessageEvent(m)}else La(t)&&this.events.emit(At.message_ack,t)}async onMessageEvent(t){await this.shouldIgnoreMessageEvent(t)||(this.events.emit(At.message,t),await this.recordMessageEvent(t))}async acknowledgePayload(t){const r=uu(t.id,!0);await this.provider.connection.send(r)}registerProviderListeners(){this.provider.on(ns.payload,t=>this.onProviderPayload(t)),this.provider.on(ns.connect,()=>{this.events.emit(At.connect)}),this.provider.on(ns.disconnect,()=>{this.onProviderDisconnect()}),this.provider.on(ns.error,t=>{this.logger.error(t),this.events.emit(At.error,t)})}registerEventListeners(){this.events.on(At.connection_stalled,async()=>{await this.restartTransport()})}onProviderDisconnect(){this.events.emit(At.disconnect),this.attemptToReconnect()}attemptToReconnect(){this.transportExplicitlyClosed||setTimeout(async()=>{await this.restartTransport()},_e.toMiliseconds(d6))}isInitialized(){if(!this.initialized){const{message:t}=he("NOT_INITIALIZED",this.name);throw new Error(t)}}async toEstablishConnection(){if(!this.connected){if(this.connecting)return await new Promise(t=>{const r=setInterval(()=>{this.connected&&(clearInterval(r),t())},this.connectionStatusPollingInterval)});await this.restartTransport()}}};var H6=Object.defineProperty,Ll=Object.getOwnPropertySymbols,K6=Object.prototype.hasOwnProperty,V6=Object.prototype.propertyIsEnumerable,Ml=(n,t,r)=>t in n?H6(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,jl=(n,t)=>{for(var r in t||(t={}))K6.call(t,r)&&Ml(n,r,t[r]);if(Ll)for(var r of Ll(t))V6.call(t,r)&&Ml(n,r,t[r]);return n};class ka extends Ww{constructor(t,r,s,o=Ci,f=void 0){super(t,r,s,o),this.core=t,this.logger=r,this.name=s,this.map=new Map,this.version=y6,this.cached=[],this.initialized=!1,this.storagePrefix=Ci,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(m=>{this.getKey&&m!==null&&!or(m)?this.map.set(this.getKey(m),m):i3(m)?this.map.set(m.id,m):n3(m)&&this.map.set(m.topic,m)}),this.cached=[],this.initialized=!0)},this.set=async(m,l)=>{this.isInitialized(),this.map.has(m)?await this.update(m,l):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:m,value:l}),this.map.set(m,l),await this.persist())},this.get=m=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:m}),this.getData(m)),this.getAll=m=>(this.isInitialized(),m?this.values.filter(l=>Object.keys(m).every(w=>A3(l[w],m[w]))):this.values),this.update=async(m,l)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:m,update:l});const w=jl(jl({},this.getData(m)),l);this.map.set(m,w),await this.persist()},this.delete=async(m,l)=>{this.isInitialized(),this.map.has(m)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:m,reason:l}),this.map.delete(m),await this.persist())},this.logger=Ze.generateChildLogger(r,this.name),this.storagePrefix=o,this.getKey=f}get context(){return Ze.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}async setDataStore(t){await this.core.storage.setItem(this.storageKey,t)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(t){const r=this.map.get(t);if(!r){const{message:s}=he("NO_MATCHING_KEY",`${this.name}: ${t}`);throw this.logger.error(s),new Error(s)}return r}async persist(){await this.setDataStore(this.values)}async restore(){try{const t=await this.getDataStore();if(typeof t>"u"||!t.length)return;if(this.map.size){const{message:r}=he("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(t){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(t)}}isInitialized(){if(!this.initialized){const{message:t}=he("NOT_INITIALIZED",this.name);throw new Error(t)}}}class k6{constructor(t,r){this.core=t,this.logger=r,this.name=w6,this.version=E6,this.events=new nu,this.initialized=!1,this.storagePrefix=Ci,this.ignoredPayloadTypes=[rn],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:s})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...s])]},this.create=async()=>{this.isInitialized();const s=Gc(),o=await this.core.crypto.setSymKey(s),f=ti(_e.FIVE_MINUTES),m={protocol:op},l={topic:o,expiry:f,relay:m,active:!1},w=WE({protocol:this.core.protocol,version:this.core.version,topic:o,symKey:s,relay:m});return await this.pairings.set(o,l),await this.core.relayer.subscribe(o),this.core.expirer.set(o,f),{topic:o,uri:w}},this.pair=async s=>{this.isInitialized(),this.isValidPair(s);const{topic:o,symKey:f,relay:m}=KE(s.uri);if(this.pairings.keys.includes(o))throw new Error(`Pairing already exists: ${o}`);if(this.core.crypto.hasKeys(o))throw new Error(`Keychain already exists: ${o}`);const l=ti(_e.FIVE_MINUTES),w={topic:o,relay:m,expiry:l,active:!1};return await this.pairings.set(o,w),await this.core.crypto.setSymKey(f,o),await this.core.relayer.subscribe(o,{relay:m}),this.core.expirer.set(o,l),s.activatePairing&&await this.activate({topic:o}),w},this.activate=async({topic:s})=>{this.isInitialized();const o=ti(_e.THIRTY_DAYS);await this.pairings.update(s,{active:!0,expiry:o}),this.core.expirer.set(s,o)},this.ping=async s=>{this.isInitialized(),await this.isValidPing(s);const{topic:o}=s;if(this.pairings.keys.includes(o)){const f=await this.sendRequest(o,"wc_pairingPing",{}),{done:m,resolve:l,reject:w}=On();this.events.once(Bt("pairing_ping",f),({error:O})=>{O?w(O):l()}),await m()}},this.updateExpiry=async({topic:s,expiry:o})=>{this.isInitialized(),await this.pairings.update(s,{expiry:o})},this.updateMetadata=async({topic:s,metadata:o})=>{this.isInitialized(),await this.pairings.update(s,{peerMetadata:o})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async s=>{this.isInitialized(),await this.isValidDisconnect(s);const{topic:o}=s;this.pairings.keys.includes(o)&&(await this.sendRequest(o,"wc_pairingDelete",kt("USER_DISCONNECTED")),await this.deletePairing(o))},this.sendRequest=async(s,o,f)=>{const m=Fa(o,f),l=await this.core.crypto.encode(s,m),w=ss[o].req;return this.core.history.set(s,m),this.core.relayer.publish(s,l,w),m.id},this.sendResult=async(s,o,f)=>{const m=uu(s,f),l=await this.core.crypto.encode(o,m),w=await this.core.history.get(o,s),O=ss[w.request.method].res;await this.core.relayer.publish(o,l,O),await this.core.history.resolve(m)},this.sendError=async(s,o,f)=>{const m=$a(s,f),l=await this.core.crypto.encode(o,m),w=await this.core.history.get(o,s),O=ss[w.request.method]?ss[w.request.method].res:ss.unregistered_method.res;await this.core.relayer.publish(o,l,O),await this.core.history.resolve(m)},this.deletePairing=async(s,o)=>{await this.core.relayer.unsubscribe(s),await Promise.all([this.pairings.delete(s,kt("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(s),o?Promise.resolve():this.core.expirer.del(s)])},this.cleanup=async()=>{const s=this.pairings.getAll().filter(o=>xi(o.expiry));await Promise.all(s.map(o=>this.deletePairing(o.topic)))},this.onRelayEventRequest=s=>{const{topic:o,payload:f}=s,m=f.method;if(this.pairings.keys.includes(o))switch(m){case"wc_pairingPing":return this.onPairingPingRequest(o,f);case"wc_pairingDelete":return this.onPairingDeleteRequest(o,f);default:return this.onUnknownRpcMethodRequest(o,f)}},this.onRelayEventResponse=async s=>{const{topic:o,payload:f}=s,m=(await this.core.history.get(o,f.id)).request.method;if(this.pairings.keys.includes(o))switch(m){case"wc_pairingPing":return this.onPairingPingResponse(o,f);default:return this.onUnknownRpcMethodResponse(m)}},this.onPairingPingRequest=async(s,o)=>{const{id:f}=o;try{this.isValidPing({topic:s}),await this.sendResult(f,s,!0),this.events.emit("pairing_ping",{id:f,topic:s})}catch(m){await this.sendError(f,s,m),this.logger.error(m)}},this.onPairingPingResponse=(s,o)=>{const{id:f}=o;setTimeout(()=>{pi(o)?this.events.emit(Bt("pairing_ping",f),{}):Kr(o)&&this.events.emit(Bt("pairing_ping",f),{error:o.error})},500)},this.onPairingDeleteRequest=async(s,o)=>{const{id:f}=o;try{this.isValidDisconnect({topic:s}),await this.deletePairing(s),this.events.emit("pairing_delete",{id:f,topic:s})}catch(m){await this.sendError(f,s,m),this.logger.error(m)}},this.onUnknownRpcMethodRequest=async(s,o)=>{const{id:f,method:m}=o;try{if(this.registeredMethods.includes(m))return;const l=kt("WC_METHOD_UNSUPPORTED",m);await this.sendError(f,s,l),this.logger.error(l)}catch(l){await this.sendError(f,s,l),this.logger.error(l)}},this.onUnknownRpcMethodResponse=s=>{this.registeredMethods.includes(s)||this.logger.error(kt("WC_METHOD_UNSUPPORTED",s))},this.isValidPair=s=>{if(!yr(s)){const{message:o}=he("MISSING_OR_INVALID",`pair() params: ${s}`);throw new Error(o)}if(!r3(s.uri)){const{message:o}=he("MISSING_OR_INVALID",`pair() uri: ${s.uri}`);throw new Error(o)}},this.isValidPing=async s=>{if(!yr(s)){const{message:f}=he("MISSING_OR_INVALID",`ping() params: ${s}`);throw new Error(f)}const{topic:o}=s;await this.isValidPairingTopic(o)},this.isValidDisconnect=async s=>{if(!yr(s)){const{message:f}=he("MISSING_OR_INVALID",`disconnect() params: ${s}`);throw new Error(f)}const{topic:o}=s;await this.isValidPairingTopic(o)},this.isValidPairingTopic=async s=>{if(!Wt(s,!1)){const{message:o}=he("MISSING_OR_INVALID",`pairing topic should be a string: ${s}`);throw new Error(o)}if(!this.pairings.keys.includes(s)){const{message:o}=he("NO_MATCHING_KEY",`pairing topic doesn't exist: ${s}`);throw new Error(o)}if(xi(this.pairings.get(s).expiry)){await this.deletePairing(s);const{message:o}=he("EXPIRED",`pairing topic: ${s}`);throw new Error(o)}},this.core=t,this.logger=Ze.generateChildLogger(r,this.name),this.pairings=new ka(this.core,this.logger,this.name,this.storagePrefix)}get context(){return Ze.getLoggerContext(this.logger)}isInitialized(){if(!this.initialized){const{message:t}=he("NOT_INITIALIZED",this.name);throw new Error(t)}}registerRelayerEvents(){this.core.relayer.on(At.message,async t=>{const{topic:r,message:s}=t;if(this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(s)))return;const o=await this.core.crypto.decode(r,s);hu(o)?(this.core.history.set(r,o),this.onRelayEventRequest({topic:r,payload:o})):La(o)&&(await this.core.history.resolve(o),this.onRelayEventResponse({topic:r,payload:o}))})}registerExpirerEvents(){this.core.expirer.on(Fr.expired,async t=>{const{topic:r}=kd(t.target);r&&this.pairings.keys.includes(r)&&(await this.deletePairing(r,!0),this.events.emit("pairing_expire",{topic:r}))})}}class W6 extends Hw{constructor(t,r){super(t,r),this.core=t,this.logger=r,this.records=new Map,this.events=new Lr.EventEmitter,this.name=D6,this.version=S6,this.cached=[],this.initialized=!1,this.storagePrefix=Ci,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(s=>this.records.set(s.id,s)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(s,o,f)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:s,request:o,chainId:f}),this.records.has(o.id))return;const m={id:o.id,topic:s,request:{method:o.method,params:o.params||null},chainId:f};this.records.set(m.id,m),this.events.emit(Zr.created,m)},this.resolve=async s=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:s}),!this.records.has(s.id))return;const o=await this.getRecord(s.id);typeof o.response>"u"&&(o.response=Kr(s)?{error:s.error}:{result:s.result},this.records.set(o.id,o),this.events.emit(Zr.updated,o))},this.get=async(s,o)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:s,id:o}),await this.getRecord(o)),this.delete=(s,o)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:o}),this.values.forEach(f=>{if(f.topic===s){if(typeof o<"u"&&f.id!==o)return;this.records.delete(f.id),this.events.emit(Zr.deleted,f)}})},this.exists=async(s,o)=>(this.isInitialized(),this.records.has(o)?(await this.getRecord(o)).topic===s:!1),this.on=(s,o)=>{this.events.on(s,o)},this.once=(s,o)=>{this.events.once(s,o)},this.off=(s,o)=>{this.events.off(s,o)},this.removeListener=(s,o)=>{this.events.removeListener(s,o)},this.logger=Ze.generateChildLogger(r,this.name)}get context(){return Ze.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const t=[];return this.values.forEach(r=>{if(typeof r.response<"u")return;const s={topic:r.topic,request:Fa(r.request.method,r.request.params,r.id),chainId:r.chainId};return t.push(s)}),t}async setJsonRpcRecords(t){await this.core.storage.setItem(this.storageKey,t)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(t){this.isInitialized();const r=this.records.get(t);if(!r){const{message:s}=he("NO_MATCHING_KEY",`${this.name}: ${t}`);throw new Error(s)}return r}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(Zr.sync)}async restore(){try{const t=await this.getJsonRpcRecords();if(typeof t>"u"||!t.length)return;if(this.records.size){const{message:r}=he("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(t){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(t)}}registerEventListeners(){this.events.on(Zr.created,t=>{const r=Zr.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:t}),this.persist()}),this.events.on(Zr.updated,t=>{const r=Zr.updated;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:t}),this.persist()}),this.events.on(Zr.deleted,t=>{const r=Zr.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:t}),this.persist()})}isInitialized(){if(!this.initialized){const{message:t}=he("NOT_INITIALIZED",this.name);throw new Error(t)}}}class G6 extends Yw{constructor(t,r){super(t,r),this.core=t,this.logger=r,this.expirations=new Map,this.events=new Lr.EventEmitter,this.name=I6,this.version=x6,this.cached=[],this.initialized=!1,this.storagePrefix=Ci,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(s=>this.expirations.set(s.target,s)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=s=>{try{const o=this.formatTarget(s);return typeof this.getExpiration(o)<"u"}catch{return!1}},this.set=(s,o)=>{this.isInitialized();const f=this.formatTarget(s),m={target:f,expiry:o};this.expirations.set(f,m),this.checkExpiry(f,m),this.events.emit(Fr.created,{target:f,expiration:m})},this.get=s=>{this.isInitialized();const o=this.formatTarget(s);return this.getExpiration(o)},this.del=s=>{if(this.isInitialized(),this.has(s)){const o=this.formatTarget(s),f=this.getExpiration(o);this.expirations.delete(o),this.events.emit(Fr.deleted,{target:o,expiration:f})}},this.on=(s,o)=>{this.events.on(s,o)},this.once=(s,o)=>{this.events.once(s,o)},this.off=(s,o)=>{this.events.off(s,o)},this.removeListener=(s,o)=>{this.events.removeListener(s,o)},this.logger=Ze.generateChildLogger(r,this.name)}get context(){return Ze.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(t){if(typeof t=="string")return FE(t);if(typeof t=="number")return $E(t);const{message:r}=he("UNKNOWN_TYPE",`Target type: ${typeof t}`);throw new Error(r)}async setExpirations(t){await this.core.storage.setItem(this.storageKey,t)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(Fr.sync)}async restore(){try{const t=await this.getExpirations();if(typeof t>"u"||!t.length)return;if(this.expirations.size){const{message:r}=he("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(t){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(t)}}getExpiration(t){const r=this.expirations.get(t);if(!r){const{message:s}=he("NO_MATCHING_KEY",`${this.name}: ${t}`);throw this.logger.error(s),new Error(s)}return r}checkExpiry(t,r){const{expiry:s}=r;_e.toMiliseconds(s)-Date.now()<=0&&this.expire(t,r)}expire(t,r){this.expirations.delete(t),this.events.emit(Fr.expired,{target:t,expiration:r})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((t,r)=>this.checkExpiry(r,t))}registerEventListeners(){this.core.heartbeat.on(gs.HEARTBEAT_EVENTS.pulse,()=>this.checkExpirations()),this.events.on(Fr.created,t=>{const r=Fr.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),this.persist()}),this.events.on(Fr.expired,t=>{const r=Fr.expired;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),this.persist()}),this.events.on(Fr.deleted,t=>{const r=Fr.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),this.persist()})}isInitialized(){if(!this.initialized){const{message:t}=he("NOT_INITIALIZED",this.name);throw new Error(t)}}}class Y6 extends Jw{constructor(t,r){super(t,r),this.projectId=t,this.logger=r,this.name=Cc,this.initialized=!1,this.init=async s=>{Bd()||!Du()||(this.verifyUrl=(s==null?void 0:s.verifyUrl)||Nl,await this.createIframe())},this.register=async s=>{var o;this.initialized||await this.init(),this.iframe&&((o=this.iframe.contentWindow)==null||o.postMessage(s.attestationId,this.verifyUrl),this.logger.info(`postMessage sent: ${s.attestationId} ${this.verifyUrl}`))},this.resolve=async s=>{var o;if(this.isDevEnv)return"";this.logger.info(`resolving attestation: ${s.attestationId}`);const f=this.startAbortTimer(_e.FIVE_SECONDS),m=await fetch(`${this.verifyUrl}/attestation/${s.attestationId}`,{signal:this.abortController.signal});return clearTimeout(f),m.status===200?(o=await m.json())==null?void 0:o.origin:""},this.createIframe=async()=>{try{await Promise.race([new Promise((s,o)=>{if(document.getElementById(Cc))return s();const f=document.createElement("iframe");f.setAttribute("id",Cc),f.setAttribute("src",`${this.verifyUrl}/${this.projectId}`),f.style.display="none",f.addEventListener("load",()=>{this.initialized=!0,s()}),f.addEventListener("error",m=>{o(m)}),document.body.append(f),this.iframe=f}),new Promise(s=>{setTimeout(()=>s("iframe load timeout"),_e.toMiliseconds(_e.ONE_SECOND/2))})])}catch(s){this.logger.error(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.error(s)}},this.logger=Ze.generateChildLogger(r,this.name),this.verifyUrl=Nl,this.abortController=new AbortController,this.isDevEnv=Eu()&&{}.IS_VITEST}get context(){return Ze.getLoggerContext(this.logger)}startAbortTimer(t){return setTimeout(()=>this.abortController.abort(),_e.toMiliseconds(t))}}var J6=Object.defineProperty,ql=Object.getOwnPropertySymbols,X6=Object.prototype.hasOwnProperty,Q6=Object.prototype.propertyIsEnumerable,Bl=(n,t,r)=>t in n?J6(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,zl=(n,t)=>{for(var r in t||(t={}))X6.call(t,r)&&Bl(n,r,t[r]);if(ql)for(var r of ql(t))Q6.call(t,r)&&Bl(n,r,t[r]);return n};let Z6=class up extends zw{constructor(t){super(t),this.protocol=ap,this.version=ZD,this.name=xu,this.events=new Lr.EventEmitter,this.initialized=!1,this.on=(s,o)=>this.events.on(s,o),this.once=(s,o)=>this.events.once(s,o),this.off=(s,o)=>this.events.off(s,o),this.removeListener=(s,o)=>this.events.removeListener(s,o),this.projectId=t==null?void 0:t.projectId,this.relayUrl=(t==null?void 0:t.relayUrl)||cp;const r=typeof(t==null?void 0:t.logger)<"u"&&typeof(t==null?void 0:t.logger)!="string"?t.logger:Ze.pino(Ze.getDefaultLoggerOptions({level:(t==null?void 0:t.logger)||e6.logger}));this.logger=Ze.generateChildLogger(r,this.name),this.heartbeat=new gs.HeartBeat,this.crypto=new A6(this,this.logger,t==null?void 0:t.keychain),this.history=new W6(this,this.logger),this.expirer=new G6(this,this.logger),this.storage=t!=null&&t.storage?t.storage:new Uw(zl(zl({},t6),t==null?void 0:t.storageOptions)),this.relayer=new z6({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new k6(this,this.logger),this.verify=new Y6(this.projectId||"",this.logger)}static async init(t){const r=new up(t);await r.initialize();const s=await r.crypto.getClientId();return await r.storage.setItem(v6,s),r}get context(){return Ze.getLoggerContext(this.logger)}async start(){this.initialized||await this.initialize()}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.initialized=!0,this.logger.info("Core Initialization Success")}catch(t){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,t),this.logger.error(t.message),t}}};const e2=Z6,hp="wc",fp=2,lp="client",Ou=`${hp}@${fp}:${lp}:`,Tc={name:lp,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.com"},t2="WALLETCONNECT_DEEPLINK_CHOICE",r2="proposal",dp="Proposal expired",i2="session",Da=_e.SEVEN_DAYS,n2="engine",os={wc_sessionPropose:{req:{ttl:_e.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:_e.FIVE_MINUTES,prompt:!1,tag:1101}},wc_sessionSettle:{req:{ttl:_e.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:_e.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:_e.ONE_DAY,prompt:!1,tag:1104},res:{ttl:_e.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:_e.ONE_DAY,prompt:!1,tag:1106},res:{ttl:_e.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:_e.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:_e.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:_e.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:_e.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:_e.ONE_DAY,prompt:!1,tag:1112},res:{ttl:_e.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:_e.THIRTY_SECONDS,prompt:!1,tag:1114},res:{ttl:_e.THIRTY_SECONDS,prompt:!1,tag:1115}}},Nc={min:_e.FIVE_MINUTES,max:_e.SEVEN_DAYS},s2="request",a2=["wc_sessionPropose","wc_sessionRequest","wc_authRequest"];var o2=Object.defineProperty,c2=Object.defineProperties,u2=Object.getOwnPropertyDescriptors,Hl=Object.getOwnPropertySymbols,h2=Object.prototype.hasOwnProperty,f2=Object.prototype.propertyIsEnumerable,Kl=(n,t,r)=>t in n?o2(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,Rr=(n,t)=>{for(var r in t||(t={}))h2.call(t,r)&&Kl(n,r,t[r]);if(Hl)for(var r of Hl(t))f2.call(t,r)&&Kl(n,r,t[r]);return n},Uc=(n,t)=>c2(n,u2(t));class l2 extends Qw{constructor(t){super(t),this.name=n2,this.events=new nu,this.initialized=!1,this.ignoredPayloadTypes=[rn],this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.client.core.pairing.register({methods:Object.keys(os)}),this.initialized=!0)},this.connect=async r=>{this.isInitialized();const s=Uc(Rr({},r),{requiredNamespaces:r.requiredNamespaces||{},optionalNamespaces:r.optionalNamespaces||{}});await this.isValidConnect(s);const{pairingTopic:o,requiredNamespaces:f,optionalNamespaces:m,sessionProperties:l,relays:w}=s;let O=o,I,N=!1;if(O&&(N=this.client.core.pairing.pairings.get(O).active),!O||!N){const{topic:b,uri:y}=await this.client.core.pairing.create();O=b,I=y}const j=await this.client.core.crypto.generateKeyPair(),R=Rr({requiredNamespaces:f,optionalNamespaces:m,relays:w??[{protocol:op}],proposer:{publicKey:j,metadata:this.client.metadata}},l&&{sessionProperties:l}),{reject:U,resolve:H,done:K}=On(_e.FIVE_MINUTES,dp);if(this.events.once(Bt("session_connect"),async({error:b,session:y})=>{if(b)U(b);else if(y){y.self.publicKey=j;const _=Uc(Rr({},y),{requiredNamespaces:y.requiredNamespaces,optionalNamespaces:y.optionalNamespaces});await this.client.session.set(y.topic,_),await this.setExpiry(y.topic,y.expiry),O&&await this.client.core.pairing.updateMetadata({topic:O,metadata:y.peer.metadata}),H(_)}}),!O){const{message:b}=he("NO_MATCHING_KEY",`connect() pairing topic: ${O}`);throw new Error(b)}const ie=await this.sendRequest(O,"wc_sessionPropose",R),p=ti(_e.FIVE_MINUTES);return await this.setProposal(ie,Rr({id:ie,expiry:p},R)),{uri:I,approval:K}},this.pair=async r=>(this.isInitialized(),await this.client.core.pairing.pair(r)),this.approve=async r=>{this.isInitialized(),await this.isValidApprove(r);const{id:s,relayProtocol:o,namespaces:f,sessionProperties:m}=r,l=this.client.proposal.get(s);let{pairingTopic:w,proposer:O,requiredNamespaces:I,optionalNamespaces:N}=l;w=w||"",us(I)||(I=XE(f,"approve()"));const j=await this.client.core.crypto.generateKeyPair(),R=O.publicKey,U=await this.client.core.crypto.generateSharedKey(j,R);w&&s&&(await this.client.core.pairing.updateMetadata({topic:w,metadata:O.metadata}),await this.sendResult(s,w,{relay:{protocol:o??"irn"},responderPublicKey:j}),await this.client.proposal.delete(s,kt("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:w}));const H=Rr({relay:{protocol:o??"irn"},namespaces:f,requiredNamespaces:I,optionalNamespaces:N,pairingTopic:w,controller:{publicKey:j,metadata:this.client.metadata},expiry:ti(Da)},m&&{sessionProperties:m});await this.client.core.relayer.subscribe(U),await this.sendRequest(U,"wc_sessionSettle",H);const K=Uc(Rr({},H),{topic:U,pairingTopic:w,acknowledged:!1,self:H.controller,peer:{publicKey:O.publicKey,metadata:O.metadata},controller:j});return await this.client.session.set(U,K),await this.setExpiry(U,ti(Da)),{topic:U,acknowledged:()=>new Promise(ie=>setTimeout(()=>ie(this.client.session.get(U)),500))}},this.reject=async r=>{this.isInitialized(),await this.isValidReject(r);const{id:s,reason:o}=r,{pairingTopic:f}=this.client.proposal.get(s);f&&(await this.sendError(s,f,o),await this.client.proposal.delete(s,kt("USER_DISCONNECTED")))},this.update=async r=>{this.isInitialized(),await this.isValidUpdate(r);const{topic:s,namespaces:o}=r,f=await this.sendRequest(s,"wc_sessionUpdate",{namespaces:o}),{done:m,resolve:l,reject:w}=On();return this.events.once(Bt("session_update",f),({error:O})=>{O?w(O):l()}),await this.client.session.update(s,{namespaces:o}),{acknowledged:m}},this.extend=async r=>{this.isInitialized(),await this.isValidExtend(r);const{topic:s}=r,o=await this.sendRequest(s,"wc_sessionExtend",{}),{done:f,resolve:m,reject:l}=On();return this.events.once(Bt("session_extend",o),({error:w})=>{w?l(w):m()}),await this.setExpiry(s,ti(Da)),{acknowledged:f}},this.request=async r=>{this.isInitialized(),await this.isValidRequest(r);const{chainId:s,request:o,topic:f,expiry:m}=r,l=await this.sendRequest(f,"wc_sessionRequest",{request:o,chainId:s},m),{done:w,resolve:O,reject:I}=On(m);this.events.once(Bt("session_request",l),({error:j,result:R})=>{j?I(j):O(R)}),this.client.events.emit("session_request_sent",{topic:f,request:o,chainId:s,id:l});const N=await this.client.core.storage.getItem(t2);return LE({id:l,topic:f,wcDeepLink:N}),await w()},this.respond=async r=>{this.isInitialized(),await this.isValidRespond(r);const{topic:s,response:o}=r,{id:f}=o;pi(o)?await this.sendResult(f,s,o.result):Kr(o)&&await this.sendError(f,s,o.error),this.deletePendingSessionRequest(r.response.id,{message:"fulfilled",code:0})},this.ping=async r=>{this.isInitialized(),await this.isValidPing(r);const{topic:s}=r;if(this.client.session.keys.includes(s)){const o=await this.sendRequest(s,"wc_sessionPing",{}),{done:f,resolve:m,reject:l}=On();this.events.once(Bt("session_ping",o),({error:w})=>{w?l(w):m()}),await f()}else this.client.core.pairing.pairings.keys.includes(s)&&await this.client.core.pairing.ping({topic:s})},this.emit=async r=>{this.isInitialized(),await this.isValidEmit(r);const{topic:s,event:o,chainId:f}=r;await this.sendRequest(s,"wc_sessionEvent",{event:o,chainId:f})},this.disconnect=async r=>{this.isInitialized(),await this.isValidDisconnect(r);const{topic:s}=r;if(this.client.session.keys.includes(s)){const o=cu().toString();let f;const m=l=>{(l==null?void 0:l.id.toString())===o&&(this.client.core.relayer.events.removeListener(At.message_ack,m),f())};await Promise.all([new Promise(l=>{f=l,this.client.core.relayer.on(At.message_ack,m)}),this.sendRequest(s,"wc_sessionDelete",kt("USER_DISCONNECTED"),void 0,o)]),await this.deleteSession(s)}else await this.client.core.pairing.disconnect({topic:s})},this.find=r=>(this.isInitialized(),this.client.session.getAll().filter(s=>e3(s,r))),this.getPendingSessionRequests=()=>(this.isInitialized(),this.client.pendingRequest.getAll()),this.cleanupDuplicatePairings=async r=>{try{const s=this.client.core.pairing.pairings.get(r.pairingTopic),o=this.client.core.pairing.pairings.getAll().filter(f=>{var m,l;return((m=f.peerMetadata)==null?void 0:m.url)&&((l=f.peerMetadata)==null?void 0:l.url)===r.peer.metadata.url&&f.topic&&f.topic!==s.topic});if(o.length===0)return;this.client.logger.info(`Cleaning up ${o.length} duplicate pairing(s)`),await Promise.all(o.map(f=>this.client.core.pairing.disconnect({topic:f.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(s){this.client.logger.error(s)}},this.deleteSession=async(r,s)=>{const{self:o}=this.client.session.get(r);await this.client.core.relayer.unsubscribe(r),this.client.session.delete(r,kt("USER_DISCONNECTED")),this.client.core.crypto.keychain.has(o.publicKey)&&await this.client.core.crypto.deleteKeyPair(o.publicKey),this.client.core.crypto.keychain.has(r)&&await this.client.core.crypto.deleteSymKey(r),s||this.client.core.expirer.del(r)},this.deleteProposal=async(r,s)=>{await Promise.all([this.client.proposal.delete(r,kt("USER_DISCONNECTED")),s?Promise.resolve():this.client.core.expirer.del(r)])},this.deletePendingSessionRequest=async(r,s,o=!1)=>{await Promise.all([this.client.pendingRequest.delete(r,s),o?Promise.resolve():this.client.core.expirer.del(r)])},this.setExpiry=async(r,s)=>{this.client.session.keys.includes(r)&&await this.client.session.update(r,{expiry:s}),this.client.core.expirer.set(r,s)},this.setProposal=async(r,s)=>{await this.client.proposal.set(r,s),this.client.core.expirer.set(r,s.expiry)},this.setPendingSessionRequest=async r=>{const s=os.wc_sessionRequest.req.ttl,{id:o,topic:f,params:m}=r;await this.client.pendingRequest.set(o,{id:o,topic:f,params:m}),s&&this.client.core.expirer.set(o,ti(s))},this.sendRequest=async(r,s,o,f,m)=>{const l=Fa(s,o);if(Du()&&a2.includes(s)){const I=An(JSON.stringify(l));await this.client.core.verify.register({attestationId:I})}const w=await this.client.core.crypto.encode(r,l),O=os[s].req;return f&&(O.ttl=f),m&&(O.id=m),this.client.core.history.set(r,l),this.client.core.relayer.publish(r,w,O),l.id},this.sendResult=async(r,s,o)=>{const f=uu(r,o),m=await this.client.core.crypto.encode(s,f),l=await this.client.core.history.get(s,r),w=os[l.request.method].res;this.client.core.relayer.publish(s,m,w),await this.client.core.history.resolve(f)},this.sendError=async(r,s,o)=>{const f=$a(r,o),m=await this.client.core.crypto.encode(s,f),l=await this.client.core.history.get(s,r),w=os[l.request.method].res;this.client.core.relayer.publish(s,m,w),await this.client.core.history.resolve(f)},this.cleanup=async()=>{const r=[],s=[];this.client.session.getAll().forEach(o=>{xi(o.expiry)&&r.push(o.topic)}),this.client.proposal.getAll().forEach(o=>{xi(o.expiry)&&s.push(o.id)}),await Promise.all([...r.map(o=>this.deleteSession(o)),...s.map(o=>this.deleteProposal(o))])},this.onRelayEventRequest=r=>{const{topic:s,payload:o}=r,f=o.method;switch(f){case"wc_sessionPropose":return this.onSessionProposeRequest(s,o);case"wc_sessionSettle":return this.onSessionSettleRequest(s,o);case"wc_sessionUpdate":return this.onSessionUpdateRequest(s,o);case"wc_sessionExtend":return this.onSessionExtendRequest(s,o);case"wc_sessionPing":return this.onSessionPingRequest(s,o);case"wc_sessionDelete":return this.onSessionDeleteRequest(s,o);case"wc_sessionRequest":return this.onSessionRequest(s,o);case"wc_sessionEvent":return this.onSessionEventRequest(s,o);default:return this.client.logger.info(`Unsupported request method ${f}`)}},this.onRelayEventResponse=async r=>{const{topic:s,payload:o}=r,f=(await this.client.core.history.get(s,o.id)).request.method;switch(f){case"wc_sessionPropose":return this.onSessionProposeResponse(s,o);case"wc_sessionSettle":return this.onSessionSettleResponse(s,o);case"wc_sessionUpdate":return this.onSessionUpdateResponse(s,o);case"wc_sessionExtend":return this.onSessionExtendResponse(s,o);case"wc_sessionPing":return this.onSessionPingResponse(s,o);case"wc_sessionRequest":return this.onSessionRequestResponse(s,o);default:return this.client.logger.info(`Unsupported response method ${f}`)}},this.onRelayEventUnknownPayload=r=>{const{topic:s}=r,{message:o}=he("MISSING_OR_INVALID",`Decoded payload on topic ${s} is not identifiable as a JSON-RPC request or a response.`);throw new Error(o)},this.onSessionProposeRequest=async(r,s)=>{const{params:o,id:f}=s;try{this.isValidConnect(Rr({},s.params));const m=ti(_e.FIVE_MINUTES),l=Rr({id:f,pairingTopic:r,expiry:m},o);await this.setProposal(f,l);const w=An(JSON.stringify(s)),O=await this.getVerifyContext(w,l.proposer.metadata);this.client.events.emit("session_proposal",{id:f,params:l,verifyContext:O})}catch(m){await this.sendError(f,r,m),this.client.logger.error(m)}},this.onSessionProposeResponse=async(r,s)=>{const{id:o}=s;if(pi(s)){const{result:f}=s;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:f});const m=this.client.proposal.get(o);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:m});const l=m.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:l});const w=f.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:w});const O=await this.client.core.crypto.generateSharedKey(l,w);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:O});const I=await this.client.core.relayer.subscribe(O);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:I}),await this.client.core.pairing.activate({topic:r})}else Kr(s)&&(await this.client.proposal.delete(o,kt("USER_DISCONNECTED")),this.events.emit(Bt("session_connect"),{error:s.error}))},this.onSessionSettleRequest=async(r,s)=>{const{id:o,params:f}=s;try{this.isValidSessionSettleRequest(f);const{relay:m,controller:l,expiry:w,namespaces:O,requiredNamespaces:I,optionalNamespaces:N,sessionProperties:j,pairingTopic:R}=s.params,U=Rr({topic:r,relay:m,expiry:w,namespaces:O,acknowledged:!0,pairingTopic:R,requiredNamespaces:I,optionalNamespaces:N,controller:l.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:l.publicKey,metadata:l.metadata}},j&&{sessionProperties:j});await this.sendResult(s.id,r,!0),this.events.emit(Bt("session_connect"),{session:U}),this.cleanupDuplicatePairings(U)}catch(m){await this.sendError(o,r,m),this.client.logger.error(m)}},this.onSessionSettleResponse=async(r,s)=>{const{id:o}=s;pi(s)?(await this.client.session.update(r,{acknowledged:!0}),this.events.emit(Bt("session_approve",o),{})):Kr(s)&&(await this.client.session.delete(r,kt("USER_DISCONNECTED")),this.events.emit(Bt("session_approve",o),{error:s.error}))},this.onSessionUpdateRequest=async(r,s)=>{const{params:o,id:f}=s;try{this.isValidUpdate(Rr({topic:r},o)),await this.client.session.update(r,{namespaces:o.namespaces}),await this.sendResult(f,r,!0),this.client.events.emit("session_update",{id:f,topic:r,params:o})}catch(m){await this.sendError(f,r,m),this.client.logger.error(m)}},this.onSessionUpdateResponse=(r,s)=>{const{id:o}=s;pi(s)?this.events.emit(Bt("session_update",o),{}):Kr(s)&&this.events.emit(Bt("session_update",o),{error:s.error})},this.onSessionExtendRequest=async(r,s)=>{const{id:o}=s;try{this.isValidExtend({topic:r}),await this.setExpiry(r,ti(Da)),await this.sendResult(o,r,!0),this.client.events.emit("session_extend",{id:o,topic:r})}catch(f){await this.sendError(o,r,f),this.client.logger.error(f)}},this.onSessionExtendResponse=(r,s)=>{const{id:o}=s;pi(s)?this.events.emit(Bt("session_extend",o),{}):Kr(s)&&this.events.emit(Bt("session_extend",o),{error:s.error})},this.onSessionPingRequest=async(r,s)=>{const{id:o}=s;try{this.isValidPing({topic:r}),await this.sendResult(o,r,!0),this.client.events.emit("session_ping",{id:o,topic:r})}catch(f){await this.sendError(o,r,f),this.client.logger.error(f)}},this.onSessionPingResponse=(r,s)=>{const{id:o}=s;setTimeout(()=>{pi(s)?this.events.emit(Bt("session_ping",o),{}):Kr(s)&&this.events.emit(Bt("session_ping",o),{error:s.error})},500)},this.onSessionDeleteRequest=async(r,s)=>{const{id:o}=s;try{this.isValidDisconnect({topic:r,reason:s.params}),await Promise.all([new Promise(f=>{this.client.core.relayer.once(At.publish,async()=>{f(await this.deleteSession(r))})}),this.sendResult(o,r,!0)]),this.client.events.emit("session_delete",{id:o,topic:r})}catch(f){this.client.logger.error(f)}},this.onSessionRequest=async(r,s)=>{const{id:o,params:f}=s;try{this.isValidRequest(Rr({topic:r},f)),await this.setPendingSessionRequest({id:o,topic:r,params:f});const m=An(JSON.stringify(s)),l=this.client.session.get(r),w=await this.getVerifyContext(m,l.peer.metadata);this.client.events.emit("session_request",{id:o,topic:r,params:f,verifyContext:w})}catch(m){await this.sendError(o,r,m),this.client.logger.error(m)}},this.onSessionRequestResponse=(r,s)=>{const{id:o}=s;pi(s)?this.events.emit(Bt("session_request",o),{result:s.result}):Kr(s)&&this.events.emit(Bt("session_request",o),{error:s.error})},this.onSessionEventRequest=async(r,s)=>{const{id:o,params:f}=s;try{this.isValidEmit(Rr({topic:r},f)),this.client.events.emit("session_event",{id:o,topic:r,params:f})}catch(m){await this.sendError(o,r,m),this.client.logger.error(m)}},this.isValidConnect=async r=>{if(!yr(r)){const{message:w}=he("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(r)}`);throw new Error(w)}const{pairingTopic:s,requiredNamespaces:o,optionalNamespaces:f,sessionProperties:m,relays:l}=r;if(or(s)||await this.isValidPairingTopic(s),!l3(l,!0)){const{message:w}=he("MISSING_OR_INVALID",`connect() relays: ${l}`);throw new Error(w)}!or(o)&&us(o)!==0&&this.validateNamespaces(o,"requiredNamespaces"),!or(f)&&us(f)!==0&&this.validateNamespaces(f,"optionalNamespaces"),or(m)||this.validateSessionProps(m,"sessionProperties")},this.validateNamespaces=(r,s)=>{const o=f3(r,"connect()",s);if(o)throw new Error(o.message)},this.isValidApprove=async r=>{if(!yr(r))throw new Error(he("MISSING_OR_INVALID",`approve() params: ${r}`).message);const{id:s,namespaces:o,relayProtocol:f,sessionProperties:m}=r;await this.isValidProposalId(s);const l=this.client.proposal.get(s),w=Oa(o,"approve()");if(w)throw new Error(w.message);const O=El(l.requiredNamespaces,o,"approve()");if(O)throw new Error(O.message);if(!Wt(f,!0)){const{message:I}=he("MISSING_OR_INVALID",`approve() relayProtocol: ${f}`);throw new Error(I)}or(m)||this.validateSessionProps(m,"sessionProperties")},this.isValidReject=async r=>{if(!yr(r)){const{message:f}=he("MISSING_OR_INVALID",`reject() params: ${r}`);throw new Error(f)}const{id:s,reason:o}=r;if(await this.isValidProposalId(s),!p3(o)){const{message:f}=he("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(o)}`);throw new Error(f)}},this.isValidSessionSettleRequest=r=>{if(!yr(r)){const{message:O}=he("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${r}`);throw new Error(O)}const{relay:s,controller:o,namespaces:f,expiry:m}=r;if(!Gd(s)){const{message:O}=he("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(O)}const l=s3(o,"onSessionSettleRequest()");if(l)throw new Error(l.message);const w=Oa(f,"onSessionSettleRequest()");if(w)throw new Error(w.message);if(xi(m)){const{message:O}=he("EXPIRED","onSessionSettleRequest()");throw new Error(O)}},this.isValidUpdate=async r=>{if(!yr(r)){const{message:w}=he("MISSING_OR_INVALID",`update() params: ${r}`);throw new Error(w)}const{topic:s,namespaces:o}=r;await this.isValidSessionTopic(s);const f=this.client.session.get(s),m=Oa(o,"update()");if(m)throw new Error(m.message);const l=El(f.requiredNamespaces,o,"update()");if(l)throw new Error(l.message)},this.isValidExtend=async r=>{if(!yr(r)){const{message:o}=he("MISSING_OR_INVALID",`extend() params: ${r}`);throw new Error(o)}const{topic:s}=r;await this.isValidSessionTopic(s)},this.isValidRequest=async r=>{if(!yr(r)){const{message:w}=he("MISSING_OR_INVALID",`request() params: ${r}`);throw new Error(w)}const{topic:s,request:o,chainId:f,expiry:m}=r;await this.isValidSessionTopic(s);const{namespaces:l}=this.client.session.get(s);if(!wl(l,f)){const{message:w}=he("MISSING_OR_INVALID",`request() chainId: ${f}`);throw new Error(w)}if(!g3(o)){const{message:w}=he("MISSING_OR_INVALID",`request() ${JSON.stringify(o)}`);throw new Error(w)}if(!_3(l,f,o.method)){const{message:w}=he("MISSING_OR_INVALID",`request() method: ${o.method}`);throw new Error(w)}if(m&&!E3(m,Nc)){const{message:w}=he("MISSING_OR_INVALID",`request() expiry: ${m}. Expiry must be a number (in seconds) between ${Nc.min} and ${Nc.max}`);throw new Error(w)}},this.isValidRespond=async r=>{if(!yr(r)){const{message:f}=he("MISSING_OR_INVALID",`respond() params: ${r}`);throw new Error(f)}const{topic:s,response:o}=r;if(await this.isValidSessionTopic(s),!y3(o)){const{message:f}=he("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(o)}`);throw new Error(f)}},this.isValidPing=async r=>{if(!yr(r)){const{message:o}=he("MISSING_OR_INVALID",`ping() params: ${r}`);throw new Error(o)}const{topic:s}=r;await this.isValidSessionOrPairingTopic(s)},this.isValidEmit=async r=>{if(!yr(r)){const{message:l}=he("MISSING_OR_INVALID",`emit() params: ${r}`);throw new Error(l)}const{topic:s,event:o,chainId:f}=r;await this.isValidSessionTopic(s);const{namespaces:m}=this.client.session.get(s);if(!wl(m,f)){const{message:l}=he("MISSING_OR_INVALID",`emit() chainId: ${f}`);throw new Error(l)}if(!v3(o)){const{message:l}=he("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(o)}`);throw new Error(l)}if(!m3(m,f,o.name)){const{message:l}=he("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(o)}`);throw new Error(l)}},this.isValidDisconnect=async r=>{if(!yr(r)){const{message:o}=he("MISSING_OR_INVALID",`disconnect() params: ${r}`);throw new Error(o)}const{topic:s}=r;await this.isValidSessionOrPairingTopic(s)},this.getVerifyContext=async(r,s)=>{const o={verified:{verifyUrl:s.verifyUrl||"",validation:"UNKNOWN",origin:s.url||""}};try{const f=await this.client.core.verify.resolve({attestationId:r,verifyUrl:s.verifyUrl});f&&(o.verified.origin=f,o.verified.validation=f===s.url?"VALID":"INVALID")}catch(f){this.client.logger.error(f)}return this.client.logger.info(`Verify context: ${JSON.stringify(o)}`),o},this.validateSessionProps=(r,s)=>{Object.values(r).forEach(o=>{if(!Wt(o,!1)){const{message:f}=he("MISSING_OR_INVALID",`${s} must be in Record<string, string> format. Received: ${JSON.stringify(o)}`);throw new Error(f)}})}}isInitialized(){if(!this.initialized){const{message:t}=he("NOT_INITIALIZED",this.name);throw new Error(t)}}registerRelayerEvents(){this.client.core.relayer.on(At.message,async t=>{const{topic:r,message:s}=t;if(this.ignoredPayloadTypes.includes(this.client.core.crypto.getPayloadType(s)))return;const o=await this.client.core.crypto.decode(r,s);hu(o)?(this.client.core.history.set(r,o),this.onRelayEventRequest({topic:r,payload:o})):La(o)?(await this.client.core.history.resolve(o),this.onRelayEventResponse({topic:r,payload:o})):this.onRelayEventUnknownPayload({topic:r,payload:o})})}registerExpirerEvents(){this.client.core.expirer.on(Fr.expired,async t=>{const{topic:r,id:s}=kd(t.target);if(s&&this.client.pendingRequest.keys.includes(s))return await this.deletePendingSessionRequest(s,he("EXPIRED"),!0);r?this.client.session.keys.includes(r)&&(await this.deleteSession(r,!0),this.client.events.emit("session_expire",{topic:r})):s&&(await this.deleteProposal(s,!0),this.client.events.emit("proposal_expire",{id:s}))})}isValidPairingTopic(t){if(!Wt(t,!1)){const{message:r}=he("MISSING_OR_INVALID",`pairing topic should be a string: ${t}`);throw new Error(r)}if(!this.client.core.pairing.pairings.keys.includes(t)){const{message:r}=he("NO_MATCHING_KEY",`pairing topic doesn't exist: ${t}`);throw new Error(r)}if(xi(this.client.core.pairing.pairings.get(t).expiry)){const{message:r}=he("EXPIRED",`pairing topic: ${t}`);throw new Error(r)}}async isValidSessionTopic(t){if(!Wt(t,!1)){const{message:r}=he("MISSING_OR_INVALID",`session topic should be a string: ${t}`);throw new Error(r)}if(!this.client.session.keys.includes(t)){const{message:r}=he("NO_MATCHING_KEY",`session topic doesn't exist: ${t}`);throw new Error(r)}if(xi(this.client.session.get(t).expiry)){await this.deleteSession(t);const{message:r}=he("EXPIRED",`session topic: ${t}`);throw new Error(r)}}async isValidSessionOrPairingTopic(t){if(this.client.session.keys.includes(t))await this.isValidSessionTopic(t);else if(this.client.core.pairing.pairings.keys.includes(t))this.isValidPairingTopic(t);else if(Wt(t,!1)){const{message:r}=he("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${t}`);throw new Error(r)}else{const{message:r}=he("MISSING_OR_INVALID",`session or pairing topic should be a string: ${t}`);throw new Error(r)}}async isValidProposalId(t){if(!d3(t)){const{message:r}=he("MISSING_OR_INVALID",`proposal id should be a number: ${t}`);throw new Error(r)}if(!this.client.proposal.keys.includes(t)){const{message:r}=he("NO_MATCHING_KEY",`proposal id doesn't exist: ${t}`);throw new Error(r)}if(xi(this.client.proposal.get(t).expiry)){await this.deleteProposal(t);const{message:r}=he("EXPIRED",`proposal id: ${t}`);throw new Error(r)}}}class d2 extends ka{constructor(t,r){super(t,r,r2,Ou),this.core=t,this.logger=r}}class p2 extends ka{constructor(t,r){super(t,r,i2,Ou),this.core=t,this.logger=r}}class g2 extends ka{constructor(t,r){super(t,r,s2,Ou,s=>s.id),this.core=t,this.logger=r}}let y2=class pp extends Xw{constructor(t){super(t),this.protocol=hp,this.version=fp,this.name=Tc.name,this.events=new Lr.EventEmitter,this.on=(s,o)=>this.events.on(s,o),this.once=(s,o)=>this.events.once(s,o),this.off=(s,o)=>this.events.off(s,o),this.removeListener=(s,o)=>this.events.removeListener(s,o),this.removeAllListeners=s=>this.events.removeAllListeners(s),this.connect=async s=>{try{return await this.engine.connect(s)}catch(o){throw this.logger.error(o.message),o}},this.pair=async s=>{try{return await this.engine.pair(s)}catch(o){throw this.logger.error(o.message),o}},this.approve=async s=>{try{return await this.engine.approve(s)}catch(o){throw this.logger.error(o.message),o}},this.reject=async s=>{try{return await this.engine.reject(s)}catch(o){throw this.logger.error(o.message),o}},this.update=async s=>{try{return await this.engine.update(s)}catch(o){throw this.logger.error(o.message),o}},this.extend=async s=>{try{return await this.engine.extend(s)}catch(o){throw this.logger.error(o.message),o}},this.request=async s=>{try{return await this.engine.request(s)}catch(o){throw this.logger.error(o.message),o}},this.respond=async s=>{try{return await this.engine.respond(s)}catch(o){throw this.logger.error(o.message),o}},this.ping=async s=>{try{return await this.engine.ping(s)}catch(o){throw this.logger.error(o.message),o}},this.emit=async s=>{try{return await this.engine.emit(s)}catch(o){throw this.logger.error(o.message),o}},this.disconnect=async s=>{try{return await this.engine.disconnect(s)}catch(o){throw this.logger.error(o.message),o}},this.find=s=>{try{return this.engine.find(s)}catch(o){throw this.logger.error(o.message),o}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(s){throw this.logger.error(s.message),s}},this.name=(t==null?void 0:t.name)||Tc.name,this.metadata=(t==null?void 0:t.metadata)||PE();const r=typeof(t==null?void 0:t.logger)<"u"&&typeof(t==null?void 0:t.logger)!="string"?t.logger:Ze.pino(Ze.getDefaultLoggerOptions({level:(t==null?void 0:t.logger)||Tc.logger}));this.core=(t==null?void 0:t.core)||new e2(t),this.logger=Ze.generateChildLogger(r,this.name),this.session=new p2(this.core,this.logger),this.proposal=new d2(this.core,this.logger),this.pendingRequest=new g2(this.core,this.logger),this.engine=new l2(this)}static async init(t){const r=new pp(t);return await r.initialize(),r}get context(){return Ze.getLoggerContext(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.engine.init(),this.core.verify.init({verifyUrl:this.metadata.verifyUrl}),this.logger.info("SignClient Initialization Success")}catch(t){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(t.message),t}}};var v2={};(function(n){const t=au,r=ou,s=su,o=vu,f=p=>p==null,m=Symbol("encodeFragmentIdentifier");function l(p){switch(p.arrayFormat){case"index":return b=>(y,_)=>{const d=y.length;return _===void 0||p.skipNull&&_===null||p.skipEmptyString&&_===""?y:_===null?[...y,[I(b,p),"[",d,"]"].join("")]:[...y,[I(b,p),"[",I(d,p),"]=",I(_,p)].join("")]};case"bracket":return b=>(y,_)=>_===void 0||p.skipNull&&_===null||p.skipEmptyString&&_===""?y:_===null?[...y,[I(b,p),"[]"].join("")]:[...y,[I(b,p),"[]=",I(_,p)].join("")];case"colon-list-separator":return b=>(y,_)=>_===void 0||p.skipNull&&_===null||p.skipEmptyString&&_===""?y:_===null?[...y,[I(b,p),":list="].join("")]:[...y,[I(b,p),":list=",I(_,p)].join("")];case"comma":case"separator":case"bracket-separator":{const b=p.arrayFormat==="bracket-separator"?"[]=":"=";return y=>(_,d)=>d===void 0||p.skipNull&&d===null||p.skipEmptyString&&d===""?_:(d=d===null?"":d,_.length===0?[[I(y,p),b,I(d,p)].join("")]:[[_,I(d,p)].join(p.arrayFormatSeparator)])}default:return b=>(y,_)=>_===void 0||p.skipNull&&_===null||p.skipEmptyString&&_===""?y:_===null?[...y,I(b,p)]:[...y,[I(b,p),"=",I(_,p)].join("")]}}function w(p){let b;switch(p.arrayFormat){case"index":return(y,_,d)=>{if(b=/\[(\d*)\]$/.exec(y),y=y.replace(/\[\d*\]$/,""),!b){d[y]=_;return}d[y]===void 0&&(d[y]={}),d[y][b[1]]=_};case"bracket":return(y,_,d)=>{if(b=/(\[\])$/.exec(y),y=y.replace(/\[\]$/,""),!b){d[y]=_;return}if(d[y]===void 0){d[y]=[_];return}d[y]=[].concat(d[y],_)};case"colon-list-separator":return(y,_,d)=>{if(b=/(:list)$/.exec(y),y=y.replace(/:list$/,""),!b){d[y]=_;return}if(d[y]===void 0){d[y]=[_];return}d[y]=[].concat(d[y],_)};case"comma":case"separator":return(y,_,d)=>{const c=typeof _=="string"&&_.includes(p.arrayFormatSeparator),v=typeof _=="string"&&!c&&N(_,p).includes(p.arrayFormatSeparator);_=v?N(_,p):_;const z=c||v?_.split(p.arrayFormatSeparator).map(G=>N(G,p)):_===null?_:N(_,p);d[y]=z};case"bracket-separator":return(y,_,d)=>{const c=/(\[\])$/.test(y);if(y=y.replace(/\[\]$/,""),!c){d[y]=_&&N(_,p);return}const v=_===null?[]:_.split(p.arrayFormatSeparator).map(z=>N(z,p));if(d[y]===void 0){d[y]=v;return}d[y]=[].concat(d[y],v)};default:return(y,_,d)=>{if(d[y]===void 0){d[y]=_;return}d[y]=[].concat(d[y],_)}}}function O(p){if(typeof p!="string"||p.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function I(p,b){return b.encode?b.strict?t(p):encodeURIComponent(p):p}function N(p,b){return b.decode?r(p):p}function j(p){return Array.isArray(p)?p.sort():typeof p=="object"?j(Object.keys(p)).sort((b,y)=>Number(b)-Number(y)).map(b=>p[b]):p}function R(p){const b=p.indexOf("#");return b!==-1&&(p=p.slice(0,b)),p}function U(p){let b="";const y=p.indexOf("#");return y!==-1&&(b=p.slice(y)),b}function H(p){p=R(p);const b=p.indexOf("?");return b===-1?"":p.slice(b+1)}function K(p,b){return b.parseNumbers&&!Number.isNaN(Number(p))&&typeof p=="string"&&p.trim()!==""?p=Number(p):b.parseBooleans&&p!==null&&(p.toLowerCase()==="true"||p.toLowerCase()==="false")&&(p=p.toLowerCase()==="true"),p}function ie(p,b){b=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},b),O(b.arrayFormatSeparator);const y=w(b),_=Object.create(null);if(typeof p!="string"||(p=p.trim().replace(/^[?#&]/,""),!p))return _;for(const d of p.split("&")){if(d==="")continue;let[c,v]=s(b.decode?d.replace(/\+/g," "):d,"=");v=v===void 0?null:["comma","separator","bracket-separator"].includes(b.arrayFormat)?v:N(v,b),y(N(c,b),v,_)}for(const d of Object.keys(_)){const c=_[d];if(typeof c=="object"&&c!==null)for(const v of Object.keys(c))c[v]=K(c[v],b);else _[d]=K(c,b)}return b.sort===!1?_:(b.sort===!0?Object.keys(_).sort():Object.keys(_).sort(b.sort)).reduce((d,c)=>{const v=_[c];return v&&typeof v=="object"&&!Array.isArray(v)?d[c]=j(v):d[c]=v,d},Object.create(null))}n.extract=H,n.parse=ie,n.stringify=(p,b)=>{if(!p)return"";b=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},b),O(b.arrayFormatSeparator);const y=v=>b.skipNull&&f(p[v])||b.skipEmptyString&&p[v]==="",_=l(b),d={};for(const v of Object.keys(p))y(v)||(d[v]=p[v]);const c=Object.keys(d);return b.sort!==!1&&c.sort(b.sort),c.map(v=>{const z=p[v];return z===void 0?"":z===null?I(v,b):Array.isArray(z)?z.length===0&&b.arrayFormat==="bracket-separator"?I(v,b)+"[]":z.reduce(_(v),[]).join("&"):I(v,b)+"="+I(z,b)}).filter(v=>v.length>0).join("&")},n.parseUrl=(p,b)=>{b=Object.assign({decode:!0},b);const[y,_]=s(p,"#");return Object.assign({url:y.split("?")[0]||"",query:ie(H(p),b)},b&&b.parseFragmentIdentifier&&_?{fragmentIdentifier:N(_,b)}:{})},n.stringifyUrl=(p,b)=>{b=Object.assign({encode:!0,strict:!0,[m]:!0},b);const y=R(p.url).split("?")[0]||"",_=n.extract(p.url),d=n.parse(_,{sort:!1}),c=Object.assign(d,p.query);let v=n.stringify(c,b);v&&(v=`?${v}`);let z=U(p.url);return p.fragmentIdentifier&&(z=`#${b[m]?I(p.fragmentIdentifier,b):p.fragmentIdentifier}`),`${y}${v}${z}`},n.pick=(p,b,y)=>{y=Object.assign({parseFragmentIdentifier:!0,[m]:!1},y);const{url:_,query:d,fragmentIdentifier:c}=n.parseUrl(p,y);return n.stringifyUrl({url:_,query:o(d,b),fragmentIdentifier:c},y)},n.exclude=(p,b,y)=>{const _=Array.isArray(b)?d=>!b.includes(d):(d,c)=>!b(d,c);return n.pick(p,_,y)}})(v2);function Rc(n=[],t=[]){return[...new Set([...n,...t])]}function gp(n){return n.includes(":")}function Aa(n){return gp(n)?n.split(":")[0]:n}const _2={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}};function Vl(n,t){const{message:r,code:s}=_2[n];return{message:t?`${r} ${t}`:r,code:s}}function m2(n,t){return Array.isArray(n)?typeof t<"u"&&n.length?n.every(t):!0:!1}function b2(n){return Object.getPrototypeOf(n)===Object.prototype&&Object.keys(n).length}var Qc={exports:{}};(function(n,t){var r=typeof self<"u"?self:Oi,s=function(){function f(){this.fetch=!1,this.DOMException=r.DOMException}return f.prototype=r,new f}();(function(f){(function(m){var l={searchParams:"URLSearchParams"in f,iterable:"Symbol"in f&&"iterator"in Symbol,blob:"FileReader"in f&&"Blob"in f&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in f,arrayBuffer:"ArrayBuffer"in f};function w(S){return S&&DataView.prototype.isPrototypeOf(S)}if(l.arrayBuffer)var O=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],I=ArrayBuffer.isView||function(S){return S&&O.indexOf(Object.prototype.toString.call(S))>-1};function N(S){if(typeof S!="string"&&(S=String(S)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(S))throw new TypeError("Invalid character in header field name");return S.toLowerCase()}function j(S){return typeof S!="string"&&(S=String(S)),S}function R(S){var C={next:function(){var ee=S.shift();return{done:ee===void 0,value:ee}}};return l.iterable&&(C[Symbol.iterator]=function(){return C}),C}function U(S){this.map={},S instanceof U?S.forEach(function(C,ee){this.append(ee,C)},this):Array.isArray(S)?S.forEach(function(C){this.append(C[0],C[1])},this):S&&Object.getOwnPropertyNames(S).forEach(function(C){this.append(C,S[C])},this)}U.prototype.append=function(S,C){S=N(S),C=j(C);var ee=this.map[S];this.map[S]=ee?ee+", "+C:C},U.prototype.delete=function(S){delete this.map[N(S)]},U.prototype.get=function(S){return S=N(S),this.has(S)?this.map[S]:null},U.prototype.has=function(S){return this.map.hasOwnProperty(N(S))},U.prototype.set=function(S,C){this.map[N(S)]=j(C)},U.prototype.forEach=function(S,C){for(var ee in this.map)this.map.hasOwnProperty(ee)&&S.call(C,this.map[ee],ee,this)},U.prototype.keys=function(){var S=[];return this.forEach(function(C,ee){S.push(ee)}),R(S)},U.prototype.values=function(){var S=[];return this.forEach(function(C){S.push(C)}),R(S)},U.prototype.entries=function(){var S=[];return this.forEach(function(C,ee){S.push([ee,C])}),R(S)},l.iterable&&(U.prototype[Symbol.iterator]=U.prototype.entries);function H(S){if(S.bodyUsed)return Promise.reject(new TypeError("Already read"));S.bodyUsed=!0}function K(S){return new Promise(function(C,ee){S.onload=function(){C(S.result)},S.onerror=function(){ee(S.error)}})}function ie(S){var C=new FileReader,ee=K(C);return C.readAsArrayBuffer(S),ee}function p(S){var C=new FileReader,ee=K(C);return C.readAsText(S),ee}function b(S){for(var C=new Uint8Array(S),ee=new Array(C.length),X=0;X<C.length;X++)ee[X]=String.fromCharCode(C[X]);return ee.join("")}function y(S){if(S.slice)return S.slice(0);var C=new Uint8Array(S.byteLength);return C.set(new Uint8Array(S)),C.buffer}function _(){return this.bodyUsed=!1,this._initBody=function(S){this._bodyInit=S,S?typeof S=="string"?this._bodyText=S:l.blob&&Blob.prototype.isPrototypeOf(S)?this._bodyBlob=S:l.formData&&FormData.prototype.isPrototypeOf(S)?this._bodyFormData=S:l.searchParams&&URLSearchParams.prototype.isPrototypeOf(S)?this._bodyText=S.toString():l.arrayBuffer&&l.blob&&w(S)?(this._bodyArrayBuffer=y(S.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):l.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(S)||I(S))?this._bodyArrayBuffer=y(S):this._bodyText=S=Object.prototype.toString.call(S):this._bodyText="",this.headers.get("content-type")||(typeof S=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):l.searchParams&&URLSearchParams.prototype.isPrototypeOf(S)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},l.blob&&(this.blob=function(){var S=H(this);if(S)return S;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?H(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(ie)}),this.text=function(){var S=H(this);if(S)return S;if(this._bodyBlob)return p(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(b(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},l.formData&&(this.formData=function(){return this.text().then(z)}),this.json=function(){return this.text().then(JSON.parse)},this}var d=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function c(S){var C=S.toUpperCase();return d.indexOf(C)>-1?C:S}function v(S,C){C=C||{};var ee=C.body;if(S instanceof v){if(S.bodyUsed)throw new TypeError("Already read");this.url=S.url,this.credentials=S.credentials,C.headers||(this.headers=new U(S.headers)),this.method=S.method,this.mode=S.mode,this.signal=S.signal,!ee&&S._bodyInit!=null&&(ee=S._bodyInit,S.bodyUsed=!0)}else this.url=String(S);if(this.credentials=C.credentials||this.credentials||"same-origin",(C.headers||!this.headers)&&(this.headers=new U(C.headers)),this.method=c(C.method||this.method||"GET"),this.mode=C.mode||this.mode||null,this.signal=C.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&ee)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(ee)}v.prototype.clone=function(){return new v(this,{body:this._bodyInit})};function z(S){var C=new FormData;return S.trim().split("&").forEach(function(ee){if(ee){var X=ee.split("="),k=X.shift().replace(/\+/g," "),W=X.join("=").replace(/\+/g," ");C.append(decodeURIComponent(k),decodeURIComponent(W))}}),C}function G(S){var C=new U,ee=S.replace(/\r?\n[\t ]+/g," ");return ee.split(/\r?\n/).forEach(function(X){var k=X.split(":"),W=k.shift().trim();if(W){var J=k.join(":").trim();C.append(W,J)}}),C}_.call(v.prototype);function se(S,C){C||(C={}),this.type="default",this.status=C.status===void 0?200:C.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in C?C.statusText:"OK",this.headers=new U(C.headers),this.url=C.url||"",this._initBody(S)}_.call(se.prototype),se.prototype.clone=function(){return new se(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new U(this.headers),url:this.url})},se.error=function(){var S=new se(null,{status:0,statusText:""});return S.type="error",S};var ce=[301,302,303,307,308];se.redirect=function(S,C){if(ce.indexOf(C)===-1)throw new RangeError("Invalid status code");return new se(null,{status:C,headers:{location:S}})},m.DOMException=f.DOMException;try{new m.DOMException}catch{m.DOMException=function(C,ee){this.message=C,this.name=ee;var X=Error(C);this.stack=X.stack},m.DOMException.prototype=Object.create(Error.prototype),m.DOMException.prototype.constructor=m.DOMException}function de(S,C){return new Promise(function(ee,X){var k=new v(S,C);if(k.signal&&k.signal.aborted)return X(new m.DOMException("Aborted","AbortError"));var W=new XMLHttpRequest;function J(){W.abort()}W.onload=function(){var re={status:W.status,statusText:W.statusText,headers:G(W.getAllResponseHeaders()||"")};re.url="responseURL"in W?W.responseURL:re.headers.get("X-Request-URL");var be="response"in W?W.response:W.responseText;ee(new se(be,re))},W.onerror=function(){X(new TypeError("Network request failed"))},W.ontimeout=function(){X(new TypeError("Network request failed"))},W.onabort=function(){X(new m.DOMException("Aborted","AbortError"))},W.open(k.method,k.url,!0),k.credentials==="include"?W.withCredentials=!0:k.credentials==="omit"&&(W.withCredentials=!1),"responseType"in W&&l.blob&&(W.responseType="blob"),k.headers.forEach(function(re,be){W.setRequestHeader(be,re)}),k.signal&&(k.signal.addEventListener("abort",J),W.onreadystatechange=function(){W.readyState===4&&k.signal.removeEventListener("abort",J)}),W.send(typeof k._bodyInit>"u"?null:k._bodyInit)})}return de.polyfill=!0,f.fetch||(f.fetch=de,f.Headers=U,f.Request=v,f.Response=se),m.Headers=U,m.Request=v,m.Response=se,m.fetch=de,Object.defineProperty(m,"__esModule",{value:!0}),m})({})})(s),s.fetch.ponyfill=!0,delete s.fetch.polyfill;var o=s;t=o.fetch,t.default=o.fetch,t.fetch=o.fetch,t.Headers=o.Headers,t.Request=o.Request,t.Response=o.Response,n.exports=t})(Qc,Qc.exports);var w2=Qc.exports;const kl=sd(w2),E2={Accept:"application/json","Content-Type":"application/json"},D2="POST",Wl={headers:E2,method:D2},Gl=10;class nn{constructor(t,r=!1){if(this.url=t,this.disableProviderPing=r,this.events=new Lr.EventEmitter,this.isAvailable=!1,this.registering=!1,!Pf(t))throw new Error(`Provided URL is not compatible with HTTP connection: ${t}`);this.url=t,this.disableProviderPing=r}get connected(){return this.isAvailable}get connecting(){return this.registering}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async open(t=this.url){await this.register(t)}async close(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()}async send(t,r){this.isAvailable||await this.register();try{const s=hs(t),f=await(await kl(this.url,Object.assign(Object.assign({},Wl),{body:s}))).json();this.onPayload({data:f})}catch(s){this.onError(t.id,s)}}async register(t=this.url){if(!Pf(t))throw new Error(`Provided URL is not compatible with HTTP connection: ${t}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((s,o)=>{this.events.once("register_error",f=>{this.resetMaxListeners(),o(f)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return o(new Error("HTTP connection is missing or invalid"));s()})})}this.url=t,this.registering=!0;try{if(!this.disableProviderPing){const r=hs({id:1,jsonrpc:"2.0",method:"test",params:[]});await kl(t,Object.assign(Object.assign({},Wl),{body:r}))}this.onOpen()}catch(r){const s=this.parseError(r);throw this.events.emit("register_error",s),this.onClose(),s}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(t){if(typeof t.data>"u")return;const r=typeof t.data=="string"?_u(t.data):t.data;this.events.emit("payload",r)}onError(t,r){const s=this.parseError(r),o=s.message||s.toString(),f=$a(t,o);this.events.emit("payload",f)}parseError(t,r=this.url){return ad(t,r,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>Gl&&this.events.setMaxListeners(Gl)}}const Yl="error",S2="wss://relay.walletconnect.com",I2="wc",x2="universal_provider",Jl=`${I2}@2:${x2}:`,O2="https://rpc.walletconnect.com/v1",Ni={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};var cs=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof Ai<"u"?Ai:typeof self<"u"?self:{},Zc={exports:{}};(function(n,t){(function(){var r,s="4.17.21",o=200,f="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",m="Expected a function",l="Invalid `variable` option passed into `_.template`",w="__lodash_hash_undefined__",O=500,I="__lodash_placeholder__",N=1,j=2,R=4,U=1,H=2,K=1,ie=2,p=4,b=8,y=16,_=32,d=64,c=128,v=256,z=512,G=30,se="...",ce=800,de=16,S=1,C=2,ee=3,X=1/0,k=9007199254740991,W=17976931348623157e292,J=0/0,re=4294967295,be=re-1,ae=re>>>1,we=[["ary",c],["bind",K],["bindKey",ie],["curry",b],["curryRight",y],["flip",z],["partial",_],["partialRight",d],["rearg",v]],fe="[object Arguments]",ve="[object Array]",B="[object AsyncFunction]",q="[object Boolean]",F="[object Date]",h="[object DOMException]",P="[object Error]",oe="[object Function]",le="[object GeneratorFunction]",Ie="[object Map]",ze="[object Number]",Ve="[object Null]",Le="[object Object]",pt="[object Promise]",gt="[object Proxy]",je="[object RegExp]",xe="[object Set]",Ue="[object String]",Re="[object Symbol]",qe="[object Undefined]",Ae="[object WeakMap]",Fe="[object WeakSet]",Se="[object ArrayBuffer]",Ce="[object DataView]",He="[object Float32Array]",Oe="[object Float64Array]",ke="[object Int8Array]",Ge="[object Int16Array]",et="[object Int32Array]",tt="[object Uint8Array]",Je="[object Uint8ClampedArray]",er="[object Uint16Array]",hr="[object Uint32Array]",kr=/\b__p \+= '';/g,tr=/\b(__p \+=) '' \+/g,ri=/(__e\(.*?\)|\b__t\)) \+\n'';/g,gi=/&(?:amp|lt|gt|quot|#39);/g,Ui=/[&<>"']/g,wt=RegExp(gi.source),yt=RegExp(Ui.source),Et=/<%-([\s\S]+?)%>/g,Dt=/<%([\s\S]+?)%>/g,mt=/<%=([\s\S]+?)%>/g,vt=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Rt=/^\w*$/,Ft=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,St=/[\\^$.*+?()[\]{}|]/g,$t=RegExp(St.source),It=/^\s+/,Ct=/\s/,xt=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,ht=/\{\n\/\* \[wrapped with (.+)\] \*/,Lt=/,? & /,Mt=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Wa=/[()=,{}\[\]\/\s]/,Ga=/\\(\\)?/g,Ya=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Ir=/\w*$/,Ja=/^[-+]0x[0-9a-f]+$/i,Xa=/^0b[01]+$/i,Qa=/^\[object .+?Constructor\]$/,Za=/^0o[0-7]+$/i,eo=/^(?:0|[1-9]\d*)$/,ii=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,sn=/($^)/,to=/['\n\r\u2028\u2029\\]/g,an="\\ud800-\\udfff",ro="\\u0300-\\u036f",io="\\ufe20-\\ufe2f",on="\\u20d0-\\u20ff",ms=ro+io+on,bs="\\u2700-\\u27bf",Mr="a-z\\xdf-\\xf6\\xf8-\\xff",no="\\xac\\xb1\\xd7\\xf7",so="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",ao="\\u2000-\\u206f",oo=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",ws="A-Z\\xc0-\\xd6\\xd8-\\xde",Es="\\ufe0e\\ufe0f",Ri=no+so+ao+oo,Nn="['â€™]",Fi="["+an+"]",Un="["+Ri+"]",$i="["+ms+"]",Ds="\\d+",co="["+bs+"]",Ss="["+Mr+"]",Is="[^"+an+Ri+Ds+bs+Mr+ws+"]",cn="\\ud83c[\\udffb-\\udfff]",uo="(?:"+$i+"|"+cn+")",xs="[^"+an+"]",un="(?:\\ud83c[\\udde6-\\uddff]){2}",yi="[\\ud800-\\udbff][\\udc00-\\udfff]",_r="["+ws+"]",Os="\\u200d",As="(?:"+Ss+"|"+Is+")",Wr="(?:"+_r+"|"+Is+")",Cs="(?:"+Nn+"(?:d|ll|m|re|s|t|ve))?",Ps="(?:"+Nn+"(?:D|LL|M|RE|S|T|VE))?",Ts=uo+"?",Ns="["+Es+"]?",ho="(?:"+Os+"(?:"+[xs,un,yi].join("|")+")"+Ns+Ts+")*",ni="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Us="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Rs=Ns+Ts+ho,hn="(?:"+[co,un,yi].join("|")+")"+Rs,fo="(?:"+[xs+$i+"?",$i,un,yi,Fi].join("|")+")",Rn=RegExp(Nn,"g"),lo=RegExp($i,"g"),fn=RegExp(cn+"(?="+cn+")|"+fo+Rs,"g"),Fs=RegExp([_r+"?"+Ss+"+"+Cs+"(?="+[Un,_r,"$"].join("|")+")",Wr+"+"+Ps+"(?="+[Un,_r+As,"$"].join("|")+")",_r+"?"+As+"+"+Cs,_r+"+"+Ps,Us,ni,Ds,hn].join("|"),"g"),$s=RegExp("["+Os+an+ms+Es+"]"),Li=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Ls=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],po=-1,at={};at[He]=at[Oe]=at[ke]=at[Ge]=at[et]=at[tt]=at[Je]=at[er]=at[hr]=!0,at[fe]=at[ve]=at[Se]=at[q]=at[Ce]=at[F]=at[P]=at[oe]=at[Ie]=at[ze]=at[Le]=at[je]=at[xe]=at[Ue]=at[Ae]=!1;var st={};st[fe]=st[ve]=st[Se]=st[Ce]=st[q]=st[F]=st[He]=st[Oe]=st[ke]=st[Ge]=st[et]=st[Ie]=st[ze]=st[Le]=st[je]=st[xe]=st[Ue]=st[Re]=st[tt]=st[Je]=st[er]=st[hr]=!0,st[P]=st[oe]=st[Ae]=!1;var x={Ã€:"A",Ã:"A",Ã‚:"A",Ãƒ:"A",Ã„:"A",Ã…:"A",Ã :"a",Ã¡:"a",Ã¢:"a",Ã£:"a",Ã¤:"a",Ã¥:"a",Ã‡:"C",Ã§:"c",Ã:"D",Ã°:"d",Ãˆ:"E",Ã‰:"E",ÃŠ:"E",Ã‹:"E",Ã¨:"e",Ã©:"e",Ãª:"e",Ã«:"e",ÃŒ:"I",Ã:"I",ÃŽ:"I",Ã:"I",Ã¬:"i",Ã­:"i",Ã®:"i",Ã¯:"i",Ã‘:"N",Ã±:"n",Ã’:"O",Ã“:"O",Ã”:"O",Ã•:"O",Ã–:"O",Ã˜:"O",Ã²:"o",Ã³:"o",Ã´:"o",Ãµ:"o",Ã¶:"o",Ã¸:"o",Ã™:"U",Ãš:"U",Ã›:"U",Ãœ:"U",Ã¹:"u",Ãº:"u",Ã»:"u",Ã¼:"u",Ã:"Y",Ã½:"y",Ã¿:"y",Ã†:"Ae",Ã¦:"ae",Ãž:"Th",Ã¾:"th",ÃŸ:"ss",Ä€:"A",Ä‚:"A",Ä„:"A",Ä:"a",Äƒ:"a",Ä…:"a",Ä†:"C",Äˆ:"C",ÄŠ:"C",ÄŒ:"C",Ä‡:"c",Ä‰:"c",Ä‹:"c",Ä:"c",ÄŽ:"D",Ä:"D",Ä:"d",Ä‘:"d",Ä’:"E",Ä”:"E",Ä–:"E",Ä˜:"E",Äš:"E",Ä“:"e",Ä•:"e",Ä—:"e",Ä™:"e",Ä›:"e",Äœ:"G",Äž:"G",Ä :"G",Ä¢:"G",Ä:"g",ÄŸ:"g",Ä¡:"g",Ä£:"g",Ä¤:"H",Ä¦:"H",Ä¥:"h",Ä§:"h",Ä¨:"I",Äª:"I",Ä¬:"I",Ä®:"I",Ä°:"I",Ä©:"i",Ä«:"i",Ä­:"i",Ä¯:"i",Ä±:"i",Ä´:"J",Äµ:"j",Ä¶:"K",Ä·:"k",Ä¸:"k",Ä¹:"L",Ä»:"L",Ä½:"L",Ä¿:"L",Å:"L",Äº:"l",Ä¼:"l",Ä¾:"l",Å€:"l",Å‚:"l",Åƒ:"N",Å…:"N",Å‡:"N",ÅŠ:"N",Å„:"n",Å†:"n",Åˆ:"n",Å‹:"n",ÅŒ:"O",ÅŽ:"O",Å:"O",Å:"o",Å:"o",Å‘:"o",Å”:"R",Å–:"R",Å˜:"R",Å•:"r",Å—:"r",Å™:"r",Åš:"S",Åœ:"S",Åž:"S",Å :"S",Å›:"s",Å:"s",ÅŸ:"s",Å¡:"s",Å¢:"T",Å¤:"T",Å¦:"T",Å£:"t",Å¥:"t",Å§:"t",Å¨:"U",Åª:"U",Å¬:"U",Å®:"U",Å°:"U",Å²:"U",Å©:"u",Å«:"u",Å­:"u",Å¯:"u",Å±:"u",Å³:"u",Å´:"W",Åµ:"w",Å¶:"Y",Å·:"y",Å¸:"Y",Å¹:"Z",Å»:"Z",Å½:"Z",Åº:"z",Å¼:"z",Å¾:"z",Ä²:"IJ",Ä³:"ij",Å’:"Oe",Å“:"oe",Å‰:"'n",Å¿:"s"},$={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},te={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},pe={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},ot=parseFloat,Te=parseInt,lt=typeof cs=="object"&&cs&&cs.Object===Object&&cs,jt=typeof self=="object"&&self&&self.Object===Object&&self,Xe=lt||jt||Function("return this")(),ct=t&&!t.nodeType&&t,Pt=ct&&!0&&n&&!n.nodeType&&n,fr=Pt&&Pt.exports===ct,qt=fr&&lt.process,dt=function(){try{var L=Pt&&Pt.require&&Pt.require("util").types;return L||qt&&qt.binding&&qt.binding("util")}catch{}}(),rr=dt&&dt.isArrayBuffer,jr=dt&&dt.isDate,xr=dt&&dt.isMap,Gr=dt&&dt.isRegExp,Fn=dt&&dt.isSet,Mi=dt&&dt.isTypedArray;function Kt(L,Y,V){switch(V.length){case 0:return L.call(Y);case 1:return L.call(Y,V[0]);case 2:return L.call(Y,V[0],V[1]);case 3:return L.call(Y,V[0],V[1],V[2])}return L.apply(Y,V)}function vp(L,Y,V,ge){for(var Pe=-1,rt=L==null?0:L.length;++Pe<rt;){var zt=L[Pe];Y(ge,zt,V(zt),L)}return ge}function Or(L,Y){for(var V=-1,ge=L==null?0:L.length;++V<ge&&Y(L[V],V,L)!==!1;);return L}function _p(L,Y){for(var V=L==null?0:L.length;V--&&Y(L[V],V,L)!==!1;);return L}function Pu(L,Y){for(var V=-1,ge=L==null?0:L.length;++V<ge;)if(!Y(L[V],V,L))return!1;return!0}function vi(L,Y){for(var V=-1,ge=L==null?0:L.length,Pe=0,rt=[];++V<ge;){var zt=L[V];Y(zt,V,L)&&(rt[Pe++]=zt)}return rt}function Ms(L,Y){var V=L==null?0:L.length;return!!V&&ln(L,Y,0)>-1}function go(L,Y,V){for(var ge=-1,Pe=L==null?0:L.length;++ge<Pe;)if(V(Y,L[ge]))return!0;return!1}function _t(L,Y){for(var V=-1,ge=L==null?0:L.length,Pe=Array(ge);++V<ge;)Pe[V]=Y(L[V],V,L);return Pe}function _i(L,Y){for(var V=-1,ge=Y.length,Pe=L.length;++V<ge;)L[Pe+V]=Y[V];return L}function yo(L,Y,V,ge){var Pe=-1,rt=L==null?0:L.length;for(ge&&rt&&(V=L[++Pe]);++Pe<rt;)V=Y(V,L[Pe],Pe,L);return V}function mp(L,Y,V,ge){var Pe=L==null?0:L.length;for(ge&&Pe&&(V=L[--Pe]);Pe--;)V=Y(V,L[Pe],Pe,L);return V}function vo(L,Y){for(var V=-1,ge=L==null?0:L.length;++V<ge;)if(Y(L[V],V,L))return!0;return!1}var bp=_o("length");function wp(L){return L.split("")}function Ep(L){return L.match(Mt)||[]}function Tu(L,Y,V){var ge;return V(L,function(Pe,rt,zt){if(Y(Pe,rt,zt))return ge=rt,!1}),ge}function js(L,Y,V,ge){for(var Pe=L.length,rt=V+(ge?1:-1);ge?rt--:++rt<Pe;)if(Y(L[rt],rt,L))return rt;return-1}function ln(L,Y,V){return Y===Y?Rp(L,Y,V):js(L,Nu,V)}function Dp(L,Y,V,ge){for(var Pe=V-1,rt=L.length;++Pe<rt;)if(ge(L[Pe],Y))return Pe;return-1}function Nu(L){return L!==L}function Uu(L,Y){var V=L==null?0:L.length;return V?bo(L,Y)/V:J}function _o(L){return function(Y){return Y==null?r:Y[L]}}function mo(L){return function(Y){return L==null?r:L[Y]}}function Ru(L,Y,V,ge,Pe){return Pe(L,function(rt,zt,ut){V=ge?(ge=!1,rt):Y(V,rt,zt,ut)}),V}function Sp(L,Y){var V=L.length;for(L.sort(Y);V--;)L[V]=L[V].value;return L}function bo(L,Y){for(var V,ge=-1,Pe=L.length;++ge<Pe;){var rt=Y(L[ge]);rt!==r&&(V=V===r?rt:V+rt)}return V}function wo(L,Y){for(var V=-1,ge=Array(L);++V<L;)ge[V]=Y(V);return ge}function Ip(L,Y){return _t(Y,function(V){return[V,L[V]]})}function Fu(L){return L&&L.slice(0,ju(L)+1).replace(It,"")}function mr(L){return function(Y){return L(Y)}}function Eo(L,Y){return _t(Y,function(V){return L[V]})}function $n(L,Y){return L.has(Y)}function $u(L,Y){for(var V=-1,ge=L.length;++V<ge&&ln(Y,L[V],0)>-1;);return V}function Lu(L,Y){for(var V=L.length;V--&&ln(Y,L[V],0)>-1;);return V}function xp(L,Y){for(var V=L.length,ge=0;V--;)L[V]===Y&&++ge;return ge}var Op=mo(x),Ap=mo($);function Cp(L){return"\\"+pe[L]}function Pp(L,Y){return L==null?r:L[Y]}function dn(L){return $s.test(L)}function Tp(L){return Li.test(L)}function Np(L){for(var Y,V=[];!(Y=L.next()).done;)V.push(Y.value);return V}function Do(L){var Y=-1,V=Array(L.size);return L.forEach(function(ge,Pe){V[++Y]=[Pe,ge]}),V}function Mu(L,Y){return function(V){return L(Y(V))}}function mi(L,Y){for(var V=-1,ge=L.length,Pe=0,rt=[];++V<ge;){var zt=L[V];(zt===Y||zt===I)&&(L[V]=I,rt[Pe++]=V)}return rt}function qs(L){var Y=-1,V=Array(L.size);return L.forEach(function(ge){V[++Y]=ge}),V}function Up(L){var Y=-1,V=Array(L.size);return L.forEach(function(ge){V[++Y]=[ge,ge]}),V}function Rp(L,Y,V){for(var ge=V-1,Pe=L.length;++ge<Pe;)if(L[ge]===Y)return ge;return-1}function Fp(L,Y,V){for(var ge=V+1;ge--;)if(L[ge]===Y)return ge;return ge}function pn(L){return dn(L)?Lp(L):bp(L)}function qr(L){return dn(L)?Mp(L):wp(L)}function ju(L){for(var Y=L.length;Y--&&Ct.test(L.charAt(Y)););return Y}var $p=mo(te);function Lp(L){for(var Y=fn.lastIndex=0;fn.test(L);)++Y;return Y}function Mp(L){return L.match(fn)||[]}function jp(L){return L.match(Fs)||[]}var qp=function L(Y){Y=Y==null?Xe:gn.defaults(Xe.Object(),Y,gn.pick(Xe,Ls));var V=Y.Array,ge=Y.Date,Pe=Y.Error,rt=Y.Function,zt=Y.Math,ut=Y.Object,So=Y.RegExp,Bp=Y.String,Ar=Y.TypeError,Bs=V.prototype,zp=rt.prototype,yn=ut.prototype,zs=Y["__core-js_shared__"],Hs=zp.toString,nt=yn.hasOwnProperty,Hp=0,qu=function(){var e=/[^.]+$/.exec(zs&&zs.keys&&zs.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),Ks=yn.toString,Kp=Hs.call(ut),Vp=Xe._,kp=So("^"+Hs.call(nt).replace(St,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Vs=fr?Y.Buffer:r,bi=Y.Symbol,ks=Y.Uint8Array,Bu=Vs?Vs.allocUnsafe:r,Ws=Mu(ut.getPrototypeOf,ut),zu=ut.create,Hu=yn.propertyIsEnumerable,Gs=Bs.splice,Ku=bi?bi.isConcatSpreadable:r,Ln=bi?bi.iterator:r,ji=bi?bi.toStringTag:r,Ys=function(){try{var e=Ki(ut,"defineProperty");return e({},"",{}),e}catch{}}(),Wp=Y.clearTimeout!==Xe.clearTimeout&&Y.clearTimeout,Gp=ge&&ge.now!==Xe.Date.now&&ge.now,Yp=Y.setTimeout!==Xe.setTimeout&&Y.setTimeout,Js=zt.ceil,Xs=zt.floor,Io=ut.getOwnPropertySymbols,Jp=Vs?Vs.isBuffer:r,Vu=Y.isFinite,Xp=Bs.join,Qp=Mu(ut.keys,ut),Ht=zt.max,Xt=zt.min,Zp=ge.now,eg=Y.parseInt,ku=zt.random,tg=Bs.reverse,xo=Ki(Y,"DataView"),Mn=Ki(Y,"Map"),Oo=Ki(Y,"Promise"),vn=Ki(Y,"Set"),jn=Ki(Y,"WeakMap"),qn=Ki(ut,"create"),Qs=jn&&new jn,_n={},rg=Vi(xo),ig=Vi(Mn),ng=Vi(Oo),sg=Vi(vn),ag=Vi(jn),Zs=bi?bi.prototype:r,Bn=Zs?Zs.valueOf:r,Wu=Zs?Zs.toString:r;function E(e){if(Ot(e)&&!Ne(e)&&!(e instanceof Ye)){if(e instanceof Cr)return e;if(nt.call(e,"__wrapped__"))return Gh(e)}return new Cr(e)}var mn=function(){function e(){}return function(i){if(!bt(i))return{};if(zu)return zu(i);e.prototype=i;var a=new e;return e.prototype=r,a}}();function ea(){}function Cr(e,i){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!i,this.__index__=0,this.__values__=r}E.templateSettings={escape:Et,evaluate:Dt,interpolate:mt,variable:"",imports:{_:E}},E.prototype=ea.prototype,E.prototype.constructor=E,Cr.prototype=mn(ea.prototype),Cr.prototype.constructor=Cr;function Ye(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=re,this.__views__=[]}function og(){var e=new Ye(this.__wrapped__);return e.__actions__=lr(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=lr(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=lr(this.__views__),e}function cg(){if(this.__filtered__){var e=new Ye(this);e.__dir__=-1,e.__filtered__=!0}else e=this.clone(),e.__dir__*=-1;return e}function ug(){var e=this.__wrapped__.value(),i=this.__dir__,a=Ne(e),u=i<0,g=a?e.length:0,D=w0(0,g,this.__views__),A=D.start,T=D.end,M=T-A,Q=u?T:A-1,Z=this.__iteratees__,ne=Z.length,ue=0,ye=Xt(M,this.__takeCount__);if(!a||!u&&g==M&&ye==M)return vh(e,this.__actions__);var Ee=[];e:for(;M--&&ue<ye;){Q+=i;for(var Be=-1,De=e[Q];++Be<ne;){var We=Z[Be],Qe=We.iteratee,Er=We.type,sr=Qe(De);if(Er==C)De=sr;else if(!sr){if(Er==S)continue e;break e}}Ee[ue++]=De}return Ee}Ye.prototype=mn(ea.prototype),Ye.prototype.constructor=Ye;function qi(e){var i=-1,a=e==null?0:e.length;for(this.clear();++i<a;){var u=e[i];this.set(u[0],u[1])}}function hg(){this.__data__=qn?qn(null):{},this.size=0}function fg(e){var i=this.has(e)&&delete this.__data__[e];return this.size-=i?1:0,i}function lg(e){var i=this.__data__;if(qn){var a=i[e];return a===w?r:a}return nt.call(i,e)?i[e]:r}function dg(e){var i=this.__data__;return qn?i[e]!==r:nt.call(i,e)}function pg(e,i){var a=this.__data__;return this.size+=this.has(e)?0:1,a[e]=qn&&i===r?w:i,this}qi.prototype.clear=hg,qi.prototype.delete=fg,qi.prototype.get=lg,qi.prototype.has=dg,qi.prototype.set=pg;function si(e){var i=-1,a=e==null?0:e.length;for(this.clear();++i<a;){var u=e[i];this.set(u[0],u[1])}}function gg(){this.__data__=[],this.size=0}function yg(e){var i=this.__data__,a=ta(i,e);if(a<0)return!1;var u=i.length-1;return a==u?i.pop():Gs.call(i,a,1),--this.size,!0}function vg(e){var i=this.__data__,a=ta(i,e);return a<0?r:i[a][1]}function _g(e){return ta(this.__data__,e)>-1}function mg(e,i){var a=this.__data__,u=ta(a,e);return u<0?(++this.size,a.push([e,i])):a[u][1]=i,this}si.prototype.clear=gg,si.prototype.delete=yg,si.prototype.get=vg,si.prototype.has=_g,si.prototype.set=mg;function ai(e){var i=-1,a=e==null?0:e.length;for(this.clear();++i<a;){var u=e[i];this.set(u[0],u[1])}}function bg(){this.size=0,this.__data__={hash:new qi,map:new(Mn||si),string:new qi}}function wg(e){var i=da(this,e).delete(e);return this.size-=i?1:0,i}function Eg(e){return da(this,e).get(e)}function Dg(e){return da(this,e).has(e)}function Sg(e,i){var a=da(this,e),u=a.size;return a.set(e,i),this.size+=a.size==u?0:1,this}ai.prototype.clear=bg,ai.prototype.delete=wg,ai.prototype.get=Eg,ai.prototype.has=Dg,ai.prototype.set=Sg;function Bi(e){var i=-1,a=e==null?0:e.length;for(this.__data__=new ai;++i<a;)this.add(e[i])}function Ig(e){return this.__data__.set(e,w),this}function xg(e){return this.__data__.has(e)}Bi.prototype.add=Bi.prototype.push=Ig,Bi.prototype.has=xg;function Br(e){var i=this.__data__=new si(e);this.size=i.size}function Og(){this.__data__=new si,this.size=0}function Ag(e){var i=this.__data__,a=i.delete(e);return this.size=i.size,a}function Cg(e){return this.__data__.get(e)}function Pg(e){return this.__data__.has(e)}function Tg(e,i){var a=this.__data__;if(a instanceof si){var u=a.__data__;if(!Mn||u.length<o-1)return u.push([e,i]),this.size=++a.size,this;a=this.__data__=new ai(u)}return a.set(e,i),this.size=a.size,this}Br.prototype.clear=Og,Br.prototype.delete=Ag,Br.prototype.get=Cg,Br.prototype.has=Pg,Br.prototype.set=Tg;function Gu(e,i){var a=Ne(e),u=!a&&ki(e),g=!a&&!u&&Ii(e),D=!a&&!u&&!g&&Dn(e),A=a||u||g||D,T=A?wo(e.length,Bp):[],M=T.length;for(var Q in e)(i||nt.call(e,Q))&&!(A&&(Q=="length"||g&&(Q=="offset"||Q=="parent")||D&&(Q=="buffer"||Q=="byteLength"||Q=="byteOffset")||hi(Q,M)))&&T.push(Q);return T}function Yu(e){var i=e.length;return i?e[Mo(0,i-1)]:r}function Ng(e,i){return pa(lr(e),zi(i,0,e.length))}function Ug(e){return pa(lr(e))}function Ao(e,i,a){(a!==r&&!zr(e[i],a)||a===r&&!(i in e))&&oi(e,i,a)}function zn(e,i,a){var u=e[i];(!(nt.call(e,i)&&zr(u,a))||a===r&&!(i in e))&&oi(e,i,a)}function ta(e,i){for(var a=e.length;a--;)if(zr(e[a][0],i))return a;return-1}function Rg(e,i,a,u){return wi(e,function(g,D,A){i(u,g,a(g),A)}),u}function Ju(e,i){return e&&Jr(i,Vt(i),e)}function Fg(e,i){return e&&Jr(i,pr(i),e)}function oi(e,i,a){i=="__proto__"&&Ys?Ys(e,i,{configurable:!0,enumerable:!0,value:a,writable:!0}):e[i]=a}function Co(e,i){for(var a=-1,u=i.length,g=V(u),D=e==null;++a<u;)g[a]=D?r:uc(e,i[a]);return g}function zi(e,i,a){return e===e&&(a!==r&&(e=e<=a?e:a),i!==r&&(e=e>=i?e:i)),e}function Pr(e,i,a,u,g,D){var A,T=i&N,M=i&j,Q=i&R;if(a&&(A=g?a(e,u,g,D):a(e)),A!==r)return A;if(!bt(e))return e;var Z=Ne(e);if(Z){if(A=D0(e),!T)return lr(e,A)}else{var ne=Qt(e),ue=ne==oe||ne==le;if(Ii(e))return bh(e,T);if(ne==Le||ne==fe||ue&&!g){if(A=M||ue?{}:jh(e),!T)return M?l0(e,Fg(A,e)):f0(e,Ju(A,e))}else{if(!st[ne])return g?e:{};A=S0(e,ne,T)}}D||(D=new Br);var ye=D.get(e);if(ye)return ye;D.set(e,A),gf(e)?e.forEach(function(De){A.add(Pr(De,i,a,De,e,D))}):df(e)&&e.forEach(function(De,We){A.set(We,Pr(De,i,a,We,e,D))});var Ee=Q?M?Yo:Go:M?pr:Vt,Be=Z?r:Ee(e);return Or(Be||e,function(De,We){Be&&(We=De,De=e[We]),zn(A,We,Pr(De,i,a,We,e,D))}),A}function $g(e){var i=Vt(e);return function(a){return Xu(a,e,i)}}function Xu(e,i,a){var u=a.length;if(e==null)return!u;for(e=ut(e);u--;){var g=a[u],D=i[g],A=e[g];if(A===r&&!(g in e)||!D(A))return!1}return!0}function Qu(e,i,a){if(typeof e!="function")throw new Ar(m);return Yn(function(){e.apply(r,a)},i)}function Hn(e,i,a,u){var g=-1,D=Ms,A=!0,T=e.length,M=[],Q=i.length;if(!T)return M;a&&(i=_t(i,mr(a))),u?(D=go,A=!1):i.length>=o&&(D=$n,A=!1,i=new Bi(i));e:for(;++g<T;){var Z=e[g],ne=a==null?Z:a(Z);if(Z=u||Z!==0?Z:0,A&&ne===ne){for(var ue=Q;ue--;)if(i[ue]===ne)continue e;M.push(Z)}else D(i,ne,u)||M.push(Z)}return M}var wi=Ih(Yr),Zu=Ih(To,!0);function Lg(e,i){var a=!0;return wi(e,function(u,g,D){return a=!!i(u,g,D),a}),a}function ra(e,i,a){for(var u=-1,g=e.length;++u<g;){var D=e[u],A=i(D);if(A!=null&&(T===r?A===A&&!wr(A):a(A,T)))var T=A,M=D}return M}function Mg(e,i,a,u){var g=e.length;for(a=Me(a),a<0&&(a=-a>g?0:g+a),u=u===r||u>g?g:Me(u),u<0&&(u+=g),u=a>u?0:vf(u);a<u;)e[a++]=i;return e}function eh(e,i){var a=[];return wi(e,function(u,g,D){i(u,g,D)&&a.push(u)}),a}function Gt(e,i,a,u,g){var D=-1,A=e.length;for(a||(a=x0),g||(g=[]);++D<A;){var T=e[D];i>0&&a(T)?i>1?Gt(T,i-1,a,u,g):_i(g,T):u||(g[g.length]=T)}return g}var Po=xh(),th=xh(!0);function Yr(e,i){return e&&Po(e,i,Vt)}function To(e,i){return e&&th(e,i,Vt)}function ia(e,i){return vi(i,function(a){return fi(e[a])})}function Hi(e,i){i=Di(i,e);for(var a=0,u=i.length;e!=null&&a<u;)e=e[Xr(i[a++])];return a&&a==u?e:r}function rh(e,i,a){var u=i(e);return Ne(e)?u:_i(u,a(e))}function ir(e){return e==null?e===r?qe:Ve:ji&&ji in ut(e)?b0(e):U0(e)}function No(e,i){return e>i}function jg(e,i){return e!=null&&nt.call(e,i)}function qg(e,i){return e!=null&&i in ut(e)}function Bg(e,i,a){return e>=Xt(i,a)&&e<Ht(i,a)}function Uo(e,i,a){for(var u=a?go:Ms,g=e[0].length,D=e.length,A=D,T=V(D),M=1/0,Q=[];A--;){var Z=e[A];A&&i&&(Z=_t(Z,mr(i))),M=Xt(Z.length,M),T[A]=!a&&(i||g>=120&&Z.length>=120)?new Bi(A&&Z):r}Z=e[0];var ne=-1,ue=T[0];e:for(;++ne<g&&Q.length<M;){var ye=Z[ne],Ee=i?i(ye):ye;if(ye=a||ye!==0?ye:0,!(ue?$n(ue,Ee):u(Q,Ee,a))){for(A=D;--A;){var Be=T[A];if(!(Be?$n(Be,Ee):u(e[A],Ee,a)))continue e}ue&&ue.push(Ee),Q.push(ye)}}return Q}function zg(e,i,a,u){return Yr(e,function(g,D,A){i(u,a(g),D,A)}),u}function Kn(e,i,a){i=Di(i,e),e=Hh(e,i);var u=e==null?e:e[Xr(Nr(i))];return u==null?r:Kt(u,e,a)}function ih(e){return Ot(e)&&ir(e)==fe}function Hg(e){return Ot(e)&&ir(e)==Se}function Kg(e){return Ot(e)&&ir(e)==F}function Vn(e,i,a,u,g){return e===i?!0:e==null||i==null||!Ot(e)&&!Ot(i)?e!==e&&i!==i:Vg(e,i,a,u,Vn,g)}function Vg(e,i,a,u,g,D){var A=Ne(e),T=Ne(i),M=A?ve:Qt(e),Q=T?ve:Qt(i);M=M==fe?Le:M,Q=Q==fe?Le:Q;var Z=M==Le,ne=Q==Le,ue=M==Q;if(ue&&Ii(e)){if(!Ii(i))return!1;A=!0,Z=!1}if(ue&&!Z)return D||(D=new Br),A||Dn(e)?$h(e,i,a,u,g,D):_0(e,i,M,a,u,g,D);if(!(a&U)){var ye=Z&&nt.call(e,"__wrapped__"),Ee=ne&&nt.call(i,"__wrapped__");if(ye||Ee){var Be=ye?e.value():e,De=Ee?i.value():i;return D||(D=new Br),g(Be,De,a,u,D)}}return ue?(D||(D=new Br),m0(e,i,a,u,g,D)):!1}function kg(e){return Ot(e)&&Qt(e)==Ie}function Ro(e,i,a,u){var g=a.length,D=g,A=!u;if(e==null)return!D;for(e=ut(e);g--;){var T=a[g];if(A&&T[2]?T[1]!==e[T[0]]:!(T[0]in e))return!1}for(;++g<D;){T=a[g];var M=T[0],Q=e[M],Z=T[1];if(A&&T[2]){if(Q===r&&!(M in e))return!1}else{var ne=new Br;if(u)var ue=u(Q,Z,M,e,i,ne);if(!(ue===r?Vn(Z,Q,U|H,u,ne):ue))return!1}}return!0}function nh(e){if(!bt(e)||A0(e))return!1;var i=fi(e)?kp:Qa;return i.test(Vi(e))}function Wg(e){return Ot(e)&&ir(e)==je}function Gg(e){return Ot(e)&&Qt(e)==xe}function Yg(e){return Ot(e)&&ba(e.length)&&!!at[ir(e)]}function sh(e){return typeof e=="function"?e:e==null?gr:typeof e=="object"?Ne(e)?ch(e[0],e[1]):oh(e):Af(e)}function Fo(e){if(!Gn(e))return Qp(e);var i=[];for(var a in ut(e))nt.call(e,a)&&a!="constructor"&&i.push(a);return i}function Jg(e){if(!bt(e))return N0(e);var i=Gn(e),a=[];for(var u in e)u=="constructor"&&(i||!nt.call(e,u))||a.push(u);return a}function $o(e,i){return e<i}function ah(e,i){var a=-1,u=dr(e)?V(e.length):[];return wi(e,function(g,D,A){u[++a]=i(g,D,A)}),u}function oh(e){var i=Xo(e);return i.length==1&&i[0][2]?Bh(i[0][0],i[0][1]):function(a){return a===e||Ro(a,e,i)}}function ch(e,i){return Zo(e)&&qh(i)?Bh(Xr(e),i):function(a){var u=uc(a,e);return u===r&&u===i?hc(a,e):Vn(i,u,U|H)}}function na(e,i,a,u,g){e!==i&&Po(i,function(D,A){if(g||(g=new Br),bt(D))Xg(e,i,A,a,na,u,g);else{var T=u?u(tc(e,A),D,A+"",e,i,g):r;T===r&&(T=D),Ao(e,A,T)}},pr)}function Xg(e,i,a,u,g,D,A){var T=tc(e,a),M=tc(i,a),Q=A.get(M);if(Q){Ao(e,a,Q);return}var Z=D?D(T,M,a+"",e,i,A):r,ne=Z===r;if(ne){var ue=Ne(M),ye=!ue&&Ii(M),Ee=!ue&&!ye&&Dn(M);Z=M,ue||ye||Ee?Ne(T)?Z=T:Tt(T)?Z=lr(T):ye?(ne=!1,Z=bh(M,!0)):Ee?(ne=!1,Z=wh(M,!0)):Z=[]:Jn(M)||ki(M)?(Z=T,ki(T)?Z=_f(T):(!bt(T)||fi(T))&&(Z=jh(M))):ne=!1}ne&&(A.set(M,Z),g(Z,M,u,D,A),A.delete(M)),Ao(e,a,Z)}function uh(e,i){var a=e.length;if(a)return i+=i<0?a:0,hi(i,a)?e[i]:r}function hh(e,i,a){i.length?i=_t(i,function(D){return Ne(D)?function(A){return Hi(A,D.length===1?D[0]:D)}:D}):i=[gr];var u=-1;i=_t(i,mr(me()));var g=ah(e,function(D,A,T){var M=_t(i,function(Q){return Q(D)});return{criteria:M,index:++u,value:D}});return Sp(g,function(D,A){return h0(D,A,a)})}function Qg(e,i){return fh(e,i,function(a,u){return hc(e,u)})}function fh(e,i,a){for(var u=-1,g=i.length,D={};++u<g;){var A=i[u],T=Hi(e,A);a(T,A)&&kn(D,Di(A,e),T)}return D}function Zg(e){return function(i){return Hi(i,e)}}function Lo(e,i,a,u){var g=u?Dp:ln,D=-1,A=i.length,T=e;for(e===i&&(i=lr(i)),a&&(T=_t(e,mr(a)));++D<A;)for(var M=0,Q=i[D],Z=a?a(Q):Q;(M=g(T,Z,M,u))>-1;)T!==e&&Gs.call(T,M,1),Gs.call(e,M,1);return e}function lh(e,i){for(var a=e?i.length:0,u=a-1;a--;){var g=i[a];if(a==u||g!==D){var D=g;hi(g)?Gs.call(e,g,1):Bo(e,g)}}return e}function Mo(e,i){return e+Xs(ku()*(i-e+1))}function e0(e,i,a,u){for(var g=-1,D=Ht(Js((i-e)/(a||1)),0),A=V(D);D--;)A[u?D:++g]=e,e+=a;return A}function jo(e,i){var a="";if(!e||i<1||i>k)return a;do i%2&&(a+=e),i=Xs(i/2),i&&(e+=e);while(i);return a}function Ke(e,i){return rc(zh(e,i,gr),e+"")}function t0(e){return Yu(Sn(e))}function r0(e,i){var a=Sn(e);return pa(a,zi(i,0,a.length))}function kn(e,i,a,u){if(!bt(e))return e;i=Di(i,e);for(var g=-1,D=i.length,A=D-1,T=e;T!=null&&++g<D;){var M=Xr(i[g]),Q=a;if(M==="__proto__"||M==="constructor"||M==="prototype")return e;if(g!=A){var Z=T[M];Q=u?u(Z,M,T):r,Q===r&&(Q=bt(Z)?Z:hi(i[g+1])?[]:{})}zn(T,M,Q),T=T[M]}return e}var dh=Qs?function(e,i){return Qs.set(e,i),e}:gr,i0=Ys?function(e,i){return Ys(e,"toString",{configurable:!0,enumerable:!1,value:lc(i),writable:!0})}:gr;function n0(e){return pa(Sn(e))}function Tr(e,i,a){var u=-1,g=e.length;i<0&&(i=-i>g?0:g+i),a=a>g?g:a,a<0&&(a+=g),g=i>a?0:a-i>>>0,i>>>=0;for(var D=V(g);++u<g;)D[u]=e[u+i];return D}function s0(e,i){var a;return wi(e,function(u,g,D){return a=i(u,g,D),!a}),!!a}function sa(e,i,a){var u=0,g=e==null?u:e.length;if(typeof i=="number"&&i===i&&g<=ae){for(;u<g;){var D=u+g>>>1,A=e[D];A!==null&&!wr(A)&&(a?A<=i:A<i)?u=D+1:g=D}return g}return qo(e,i,gr,a)}function qo(e,i,a,u){var g=0,D=e==null?0:e.length;if(D===0)return 0;i=a(i);for(var A=i!==i,T=i===null,M=wr(i),Q=i===r;g<D;){var Z=Xs((g+D)/2),ne=a(e[Z]),ue=ne!==r,ye=ne===null,Ee=ne===ne,Be=wr(ne);if(A)var De=u||Ee;else Q?De=Ee&&(u||ue):T?De=Ee&&ue&&(u||!ye):M?De=Ee&&ue&&!ye&&(u||!Be):ye||Be?De=!1:De=u?ne<=i:ne<i;De?g=Z+1:D=Z}return Xt(D,be)}function ph(e,i){for(var a=-1,u=e.length,g=0,D=[];++a<u;){var A=e[a],T=i?i(A):A;if(!a||!zr(T,M)){var M=T;D[g++]=A===0?0:A}}return D}function gh(e){return typeof e=="number"?e:wr(e)?J:+e}function br(e){if(typeof e=="string")return e;if(Ne(e))return _t(e,br)+"";if(wr(e))return Wu?Wu.call(e):"";var i=e+"";return i=="0"&&1/e==-X?"-0":i}function Ei(e,i,a){var u=-1,g=Ms,D=e.length,A=!0,T=[],M=T;if(a)A=!1,g=go;else if(D>=o){var Q=i?null:y0(e);if(Q)return qs(Q);A=!1,g=$n,M=new Bi}else M=i?[]:T;e:for(;++u<D;){var Z=e[u],ne=i?i(Z):Z;if(Z=a||Z!==0?Z:0,A&&ne===ne){for(var ue=M.length;ue--;)if(M[ue]===ne)continue e;i&&M.push(ne),T.push(Z)}else g(M,ne,a)||(M!==T&&M.push(ne),T.push(Z))}return T}function Bo(e,i){return i=Di(i,e),e=Hh(e,i),e==null||delete e[Xr(Nr(i))]}function yh(e,i,a,u){return kn(e,i,a(Hi(e,i)),u)}function aa(e,i,a,u){for(var g=e.length,D=u?g:-1;(u?D--:++D<g)&&i(e[D],D,e););return a?Tr(e,u?0:D,u?D+1:g):Tr(e,u?D+1:0,u?g:D)}function vh(e,i){var a=e;return a instanceof Ye&&(a=a.value()),yo(i,function(u,g){return g.func.apply(g.thisArg,_i([u],g.args))},a)}function zo(e,i,a){var u=e.length;if(u<2)return u?Ei(e[0]):[];for(var g=-1,D=V(u);++g<u;)for(var A=e[g],T=-1;++T<u;)T!=g&&(D[g]=Hn(D[g]||A,e[T],i,a));return Ei(Gt(D,1),i,a)}function _h(e,i,a){for(var u=-1,g=e.length,D=i.length,A={};++u<g;){var T=u<D?i[u]:r;a(A,e[u],T)}return A}function Ho(e){return Tt(e)?e:[]}function Ko(e){return typeof e=="function"?e:gr}function Di(e,i){return Ne(e)?e:Zo(e,i)?[e]:Wh(it(e))}var a0=Ke;function Si(e,i,a){var u=e.length;return a=a===r?u:a,!i&&a>=u?e:Tr(e,i,a)}var mh=Wp||function(e){return Xe.clearTimeout(e)};function bh(e,i){if(i)return e.slice();var a=e.length,u=Bu?Bu(a):new e.constructor(a);return e.copy(u),u}function Vo(e){var i=new e.constructor(e.byteLength);return new ks(i).set(new ks(e)),i}function o0(e,i){var a=i?Vo(e.buffer):e.buffer;return new e.constructor(a,e.byteOffset,e.byteLength)}function c0(e){var i=new e.constructor(e.source,Ir.exec(e));return i.lastIndex=e.lastIndex,i}function u0(e){return Bn?ut(Bn.call(e)):{}}function wh(e,i){var a=i?Vo(e.buffer):e.buffer;return new e.constructor(a,e.byteOffset,e.length)}function Eh(e,i){if(e!==i){var a=e!==r,u=e===null,g=e===e,D=wr(e),A=i!==r,T=i===null,M=i===i,Q=wr(i);if(!T&&!Q&&!D&&e>i||D&&A&&M&&!T&&!Q||u&&A&&M||!a&&M||!g)return 1;if(!u&&!D&&!Q&&e<i||Q&&a&&g&&!u&&!D||T&&a&&g||!A&&g||!M)return-1}return 0}function h0(e,i,a){for(var u=-1,g=e.criteria,D=i.criteria,A=g.length,T=a.length;++u<A;){var M=Eh(g[u],D[u]);if(M){if(u>=T)return M;var Q=a[u];return M*(Q=="desc"?-1:1)}}return e.index-i.index}function Dh(e,i,a,u){for(var g=-1,D=e.length,A=a.length,T=-1,M=i.length,Q=Ht(D-A,0),Z=V(M+Q),ne=!u;++T<M;)Z[T]=i[T];for(;++g<A;)(ne||g<D)&&(Z[a[g]]=e[g]);for(;Q--;)Z[T++]=e[g++];return Z}function Sh(e,i,a,u){for(var g=-1,D=e.length,A=-1,T=a.length,M=-1,Q=i.length,Z=Ht(D-T,0),ne=V(Z+Q),ue=!u;++g<Z;)ne[g]=e[g];for(var ye=g;++M<Q;)ne[ye+M]=i[M];for(;++A<T;)(ue||g<D)&&(ne[ye+a[A]]=e[g++]);return ne}function lr(e,i){var a=-1,u=e.length;for(i||(i=V(u));++a<u;)i[a]=e[a];return i}function Jr(e,i,a,u){var g=!a;a||(a={});for(var D=-1,A=i.length;++D<A;){var T=i[D],M=u?u(a[T],e[T],T,a,e):r;M===r&&(M=e[T]),g?oi(a,T,M):zn(a,T,M)}return a}function f0(e,i){return Jr(e,Qo(e),i)}function l0(e,i){return Jr(e,Lh(e),i)}function oa(e,i){return function(a,u){var g=Ne(a)?vp:Rg,D=i?i():{};return g(a,e,me(u,2),D)}}function bn(e){return Ke(function(i,a){var u=-1,g=a.length,D=g>1?a[g-1]:r,A=g>2?a[2]:r;for(D=e.length>3&&typeof D=="function"?(g--,D):r,A&&nr(a[0],a[1],A)&&(D=g<3?r:D,g=1),i=ut(i);++u<g;){var T=a[u];T&&e(i,T,u,D)}return i})}function Ih(e,i){return function(a,u){if(a==null)return a;if(!dr(a))return e(a,u);for(var g=a.length,D=i?g:-1,A=ut(a);(i?D--:++D<g)&&u(A[D],D,A)!==!1;);return a}}function xh(e){return function(i,a,u){for(var g=-1,D=ut(i),A=u(i),T=A.length;T--;){var M=A[e?T:++g];if(a(D[M],M,D)===!1)break}return i}}function d0(e,i,a){var u=i&K,g=Wn(e);function D(){var A=this&&this!==Xe&&this instanceof D?g:e;return A.apply(u?a:this,arguments)}return D}function Oh(e){return function(i){i=it(i);var a=dn(i)?qr(i):r,u=a?a[0]:i.charAt(0),g=a?Si(a,1).join(""):i.slice(1);return u[e]()+g}}function wn(e){return function(i){return yo(xf(If(i).replace(Rn,"")),e,"")}}function Wn(e){return function(){var i=arguments;switch(i.length){case 0:return new e;case 1:return new e(i[0]);case 2:return new e(i[0],i[1]);case 3:return new e(i[0],i[1],i[2]);case 4:return new e(i[0],i[1],i[2],i[3]);case 5:return new e(i[0],i[1],i[2],i[3],i[4]);case 6:return new e(i[0],i[1],i[2],i[3],i[4],i[5]);case 7:return new e(i[0],i[1],i[2],i[3],i[4],i[5],i[6])}var a=mn(e.prototype),u=e.apply(a,i);return bt(u)?u:a}}function p0(e,i,a){var u=Wn(e);function g(){for(var D=arguments.length,A=V(D),T=D,M=En(g);T--;)A[T]=arguments[T];var Q=D<3&&A[0]!==M&&A[D-1]!==M?[]:mi(A,M);if(D-=Q.length,D<a)return Nh(e,i,ca,g.placeholder,r,A,Q,r,r,a-D);var Z=this&&this!==Xe&&this instanceof g?u:e;return Kt(Z,this,A)}return g}function Ah(e){return function(i,a,u){var g=ut(i);if(!dr(i)){var D=me(a,3);i=Vt(i),a=function(T){return D(g[T],T,g)}}var A=e(i,a,u);return A>-1?g[D?i[A]:A]:r}}function Ch(e){return ui(function(i){var a=i.length,u=a,g=Cr.prototype.thru;for(e&&i.reverse();u--;){var D=i[u];if(typeof D!="function")throw new Ar(m);if(g&&!A&&la(D)=="wrapper")var A=new Cr([],!0)}for(u=A?u:a;++u<a;){D=i[u];var T=la(D),M=T=="wrapper"?Jo(D):r;M&&ec(M[0])&&M[1]==(c|b|_|v)&&!M[4].length&&M[9]==1?A=A[la(M[0])].apply(A,M[3]):A=D.length==1&&ec(D)?A[T]():A.thru(D)}return function(){var Q=arguments,Z=Q[0];if(A&&Q.length==1&&Ne(Z))return A.plant(Z).value();for(var ne=0,ue=a?i[ne].apply(this,Q):Z;++ne<a;)ue=i[ne].call(this,ue);return ue}})}function ca(e,i,a,u,g,D,A,T,M,Q){var Z=i&c,ne=i&K,ue=i&ie,ye=i&(b|y),Ee=i&z,Be=ue?r:Wn(e);function De(){for(var We=arguments.length,Qe=V(We),Er=We;Er--;)Qe[Er]=arguments[Er];if(ye)var sr=En(De),Dr=xp(Qe,sr);if(u&&(Qe=Dh(Qe,u,g,ye)),D&&(Qe=Sh(Qe,D,A,ye)),We-=Dr,ye&&We<Q){var Nt=mi(Qe,sr);return Nh(e,i,ca,De.placeholder,a,Qe,Nt,T,M,Q-We)}var Hr=ne?a:this,di=ue?Hr[e]:e;return We=Qe.length,T?Qe=R0(Qe,T):Ee&&We>1&&Qe.reverse(),Z&&M<We&&(Qe.length=M),this&&this!==Xe&&this instanceof De&&(di=Be||Wn(di)),di.apply(Hr,Qe)}return De}function Ph(e,i){return function(a,u){return zg(a,e,i(u),{})}}function ua(e,i){return function(a,u){var g;if(a===r&&u===r)return i;if(a!==r&&(g=a),u!==r){if(g===r)return u;typeof a=="string"||typeof u=="string"?(a=br(a),u=br(u)):(a=gh(a),u=gh(u)),g=e(a,u)}return g}}function ko(e){return ui(function(i){return i=_t(i,mr(me())),Ke(function(a){var u=this;return e(i,function(g){return Kt(g,u,a)})})})}function ha(e,i){i=i===r?" ":br(i);var a=i.length;if(a<2)return a?jo(i,e):i;var u=jo(i,Js(e/pn(i)));return dn(i)?Si(qr(u),0,e).join(""):u.slice(0,e)}function g0(e,i,a,u){var g=i&K,D=Wn(e);function A(){for(var T=-1,M=arguments.length,Q=-1,Z=u.length,ne=V(Z+M),ue=this&&this!==Xe&&this instanceof A?D:e;++Q<Z;)ne[Q]=u[Q];for(;M--;)ne[Q++]=arguments[++T];return Kt(ue,g?a:this,ne)}return A}function Th(e){return function(i,a,u){return u&&typeof u!="number"&&nr(i,a,u)&&(a=u=r),i=li(i),a===r?(a=i,i=0):a=li(a),u=u===r?i<a?1:-1:li(u),e0(i,a,u,e)}}function fa(e){return function(i,a){return typeof i=="string"&&typeof a=="string"||(i=Ur(i),a=Ur(a)),e(i,a)}}function Nh(e,i,a,u,g,D,A,T,M,Q){var Z=i&b,ne=Z?A:r,ue=Z?r:A,ye=Z?D:r,Ee=Z?r:D;i|=Z?_:d,i&=~(Z?d:_),i&p||(i&=~(K|ie));var Be=[e,i,g,ye,ne,Ee,ue,T,M,Q],De=a.apply(r,Be);return ec(e)&&Kh(De,Be),De.placeholder=u,Vh(De,e,i)}function Wo(e){var i=zt[e];return function(a,u){if(a=Ur(a),u=u==null?0:Xt(Me(u),292),u&&Vu(a)){var g=(it(a)+"e").split("e"),D=i(g[0]+"e"+(+g[1]+u));return g=(it(D)+"e").split("e"),+(g[0]+"e"+(+g[1]-u))}return i(a)}}var y0=vn&&1/qs(new vn([,-0]))[1]==X?function(e){return new vn(e)}:gc;function Uh(e){return function(i){var a=Qt(i);return a==Ie?Do(i):a==xe?Up(i):Ip(i,e(i))}}function ci(e,i,a,u,g,D,A,T){var M=i&ie;if(!M&&typeof e!="function")throw new Ar(m);var Q=u?u.length:0;if(Q||(i&=~(_|d),u=g=r),A=A===r?A:Ht(Me(A),0),T=T===r?T:Me(T),Q-=g?g.length:0,i&d){var Z=u,ne=g;u=g=r}var ue=M?r:Jo(e),ye=[e,i,a,u,g,Z,ne,D,A,T];if(ue&&T0(ye,ue),e=ye[0],i=ye[1],a=ye[2],u=ye[3],g=ye[4],T=ye[9]=ye[9]===r?M?0:e.length:Ht(ye[9]-Q,0),!T&&i&(b|y)&&(i&=~(b|y)),!i||i==K)var Ee=d0(e,i,a);else i==b||i==y?Ee=p0(e,i,T):(i==_||i==(K|_))&&!g.length?Ee=g0(e,i,a,u):Ee=ca.apply(r,ye);var Be=ue?dh:Kh;return Vh(Be(Ee,ye),e,i)}function Rh(e,i,a,u){return e===r||zr(e,yn[a])&&!nt.call(u,a)?i:e}function Fh(e,i,a,u,g,D){return bt(e)&&bt(i)&&(D.set(i,e),na(e,i,r,Fh,D),D.delete(i)),e}function v0(e){return Jn(e)?r:e}function $h(e,i,a,u,g,D){var A=a&U,T=e.length,M=i.length;if(T!=M&&!(A&&M>T))return!1;var Q=D.get(e),Z=D.get(i);if(Q&&Z)return Q==i&&Z==e;var ne=-1,ue=!0,ye=a&H?new Bi:r;for(D.set(e,i),D.set(i,e);++ne<T;){var Ee=e[ne],Be=i[ne];if(u)var De=A?u(Be,Ee,ne,i,e,D):u(Ee,Be,ne,e,i,D);if(De!==r){if(De)continue;ue=!1;break}if(ye){if(!vo(i,function(We,Qe){if(!$n(ye,Qe)&&(Ee===We||g(Ee,We,a,u,D)))return ye.push(Qe)})){ue=!1;break}}else if(!(Ee===Be||g(Ee,Be,a,u,D))){ue=!1;break}}return D.delete(e),D.delete(i),ue}function _0(e,i,a,u,g,D,A){switch(a){case Ce:if(e.byteLength!=i.byteLength||e.byteOffset!=i.byteOffset)return!1;e=e.buffer,i=i.buffer;case Se:return!(e.byteLength!=i.byteLength||!D(new ks(e),new ks(i)));case q:case F:case ze:return zr(+e,+i);case P:return e.name==i.name&&e.message==i.message;case je:case Ue:return e==i+"";case Ie:var T=Do;case xe:var M=u&U;if(T||(T=qs),e.size!=i.size&&!M)return!1;var Q=A.get(e);if(Q)return Q==i;u|=H,A.set(e,i);var Z=$h(T(e),T(i),u,g,D,A);return A.delete(e),Z;case Re:if(Bn)return Bn.call(e)==Bn.call(i)}return!1}function m0(e,i,a,u,g,D){var A=a&U,T=Go(e),M=T.length,Q=Go(i),Z=Q.length;if(M!=Z&&!A)return!1;for(var ne=M;ne--;){var ue=T[ne];if(!(A?ue in i:nt.call(i,ue)))return!1}var ye=D.get(e),Ee=D.get(i);if(ye&&Ee)return ye==i&&Ee==e;var Be=!0;D.set(e,i),D.set(i,e);for(var De=A;++ne<M;){ue=T[ne];var We=e[ue],Qe=i[ue];if(u)var Er=A?u(Qe,We,ue,i,e,D):u(We,Qe,ue,e,i,D);if(!(Er===r?We===Qe||g(We,Qe,a,u,D):Er)){Be=!1;break}De||(De=ue=="constructor")}if(Be&&!De){var sr=e.constructor,Dr=i.constructor;sr!=Dr&&"constructor"in e&&"constructor"in i&&!(typeof sr=="function"&&sr instanceof sr&&typeof Dr=="function"&&Dr instanceof Dr)&&(Be=!1)}return D.delete(e),D.delete(i),Be}function ui(e){return rc(zh(e,r,Xh),e+"")}function Go(e){return rh(e,Vt,Qo)}function Yo(e){return rh(e,pr,Lh)}var Jo=Qs?function(e){return Qs.get(e)}:gc;function la(e){for(var i=e.name+"",a=_n[i],u=nt.call(_n,i)?a.length:0;u--;){var g=a[u],D=g.func;if(D==null||D==e)return g.name}return i}function En(e){var i=nt.call(E,"placeholder")?E:e;return i.placeholder}function me(){var e=E.iteratee||dc;return e=e===dc?sh:e,arguments.length?e(arguments[0],arguments[1]):e}function da(e,i){var a=e.__data__;return O0(i)?a[typeof i=="string"?"string":"hash"]:a.map}function Xo(e){for(var i=Vt(e),a=i.length;a--;){var u=i[a],g=e[u];i[a]=[u,g,qh(g)]}return i}function Ki(e,i){var a=Pp(e,i);return nh(a)?a:r}function b0(e){var i=nt.call(e,ji),a=e[ji];try{e[ji]=r;var u=!0}catch{}var g=Ks.call(e);return u&&(i?e[ji]=a:delete e[ji]),g}var Qo=Io?function(e){return e==null?[]:(e=ut(e),vi(Io(e),function(i){return Hu.call(e,i)}))}:yc,Lh=Io?function(e){for(var i=[];e;)_i(i,Qo(e)),e=Ws(e);return i}:yc,Qt=ir;(xo&&Qt(new xo(new ArrayBuffer(1)))!=Ce||Mn&&Qt(new Mn)!=Ie||Oo&&Qt(Oo.resolve())!=pt||vn&&Qt(new vn)!=xe||jn&&Qt(new jn)!=Ae)&&(Qt=function(e){var i=ir(e),a=i==Le?e.constructor:r,u=a?Vi(a):"";if(u)switch(u){case rg:return Ce;case ig:return Ie;case ng:return pt;case sg:return xe;case ag:return Ae}return i});function w0(e,i,a){for(var u=-1,g=a.length;++u<g;){var D=a[u],A=D.size;switch(D.type){case"drop":e+=A;break;case"dropRight":i-=A;break;case"take":i=Xt(i,e+A);break;case"takeRight":e=Ht(e,i-A);break}}return{start:e,end:i}}function E0(e){var i=e.match(ht);return i?i[1].split(Lt):[]}function Mh(e,i,a){i=Di(i,e);for(var u=-1,g=i.length,D=!1;++u<g;){var A=Xr(i[u]);if(!(D=e!=null&&a(e,A)))break;e=e[A]}return D||++u!=g?D:(g=e==null?0:e.length,!!g&&ba(g)&&hi(A,g)&&(Ne(e)||ki(e)))}function D0(e){var i=e.length,a=new e.constructor(i);return i&&typeof e[0]=="string"&&nt.call(e,"index")&&(a.index=e.index,a.input=e.input),a}function jh(e){return typeof e.constructor=="function"&&!Gn(e)?mn(Ws(e)):{}}function S0(e,i,a){var u=e.constructor;switch(i){case Se:return Vo(e);case q:case F:return new u(+e);case Ce:return o0(e,a);case He:case Oe:case ke:case Ge:case et:case tt:case Je:case er:case hr:return wh(e,a);case Ie:return new u;case ze:case Ue:return new u(e);case je:return c0(e);case xe:return new u;case Re:return u0(e)}}function I0(e,i){var a=i.length;if(!a)return e;var u=a-1;return i[u]=(a>1?"& ":"")+i[u],i=i.join(a>2?", ":" "),e.replace(xt,`{
/* [wrapped with `+i+`] */
`)}function x0(e){return Ne(e)||ki(e)||!!(Ku&&e&&e[Ku])}function hi(e,i){var a=typeof e;return i=i??k,!!i&&(a=="number"||a!="symbol"&&eo.test(e))&&e>-1&&e%1==0&&e<i}function nr(e,i,a){if(!bt(a))return!1;var u=typeof i;return(u=="number"?dr(a)&&hi(i,a.length):u=="string"&&i in a)?zr(a[i],e):!1}function Zo(e,i){if(Ne(e))return!1;var a=typeof e;return a=="number"||a=="symbol"||a=="boolean"||e==null||wr(e)?!0:Rt.test(e)||!vt.test(e)||i!=null&&e in ut(i)}function O0(e){var i=typeof e;return i=="string"||i=="number"||i=="symbol"||i=="boolean"?e!=="__proto__":e===null}function ec(e){var i=la(e),a=E[i];if(typeof a!="function"||!(i in Ye.prototype))return!1;if(e===a)return!0;var u=Jo(a);return!!u&&e===u[0]}function A0(e){return!!qu&&qu in e}var C0=zs?fi:vc;function Gn(e){var i=e&&e.constructor,a=typeof i=="function"&&i.prototype||yn;return e===a}function qh(e){return e===e&&!bt(e)}function Bh(e,i){return function(a){return a==null?!1:a[e]===i&&(i!==r||e in ut(a))}}function P0(e){var i=_a(e,function(u){return a.size===O&&a.clear(),u}),a=i.cache;return i}function T0(e,i){var a=e[1],u=i[1],g=a|u,D=g<(K|ie|c),A=u==c&&a==b||u==c&&a==v&&e[7].length<=i[8]||u==(c|v)&&i[7].length<=i[8]&&a==b;if(!(D||A))return e;u&K&&(e[2]=i[2],g|=a&K?0:p);var T=i[3];if(T){var M=e[3];e[3]=M?Dh(M,T,i[4]):T,e[4]=M?mi(e[3],I):i[4]}return T=i[5],T&&(M=e[5],e[5]=M?Sh(M,T,i[6]):T,e[6]=M?mi(e[5],I):i[6]),T=i[7],T&&(e[7]=T),u&c&&(e[8]=e[8]==null?i[8]:Xt(e[8],i[8])),e[9]==null&&(e[9]=i[9]),e[0]=i[0],e[1]=g,e}function N0(e){var i=[];if(e!=null)for(var a in ut(e))i.push(a);return i}function U0(e){return Ks.call(e)}function zh(e,i,a){return i=Ht(i===r?e.length-1:i,0),function(){for(var u=arguments,g=-1,D=Ht(u.length-i,0),A=V(D);++g<D;)A[g]=u[i+g];g=-1;for(var T=V(i+1);++g<i;)T[g]=u[g];return T[i]=a(A),Kt(e,this,T)}}function Hh(e,i){return i.length<2?e:Hi(e,Tr(i,0,-1))}function R0(e,i){for(var a=e.length,u=Xt(i.length,a),g=lr(e);u--;){var D=i[u];e[u]=hi(D,a)?g[D]:r}return e}function tc(e,i){if(!(i==="constructor"&&typeof e[i]=="function")&&i!="__proto__")return e[i]}var Kh=kh(dh),Yn=Yp||function(e,i){return Xe.setTimeout(e,i)},rc=kh(i0);function Vh(e,i,a){var u=i+"";return rc(e,I0(u,F0(E0(u),a)))}function kh(e){var i=0,a=0;return function(){var u=Zp(),g=de-(u-a);if(a=u,g>0){if(++i>=ce)return arguments[0]}else i=0;return e.apply(r,arguments)}}function pa(e,i){var a=-1,u=e.length,g=u-1;for(i=i===r?u:i;++a<i;){var D=Mo(a,g),A=e[D];e[D]=e[a],e[a]=A}return e.length=i,e}var Wh=P0(function(e){var i=[];return e.charCodeAt(0)===46&&i.push(""),e.replace(Ft,function(a,u,g,D){i.push(g?D.replace(Ga,"$1"):u||a)}),i});function Xr(e){if(typeof e=="string"||wr(e))return e;var i=e+"";return i=="0"&&1/e==-X?"-0":i}function Vi(e){if(e!=null){try{return Hs.call(e)}catch{}try{return e+""}catch{}}return""}function F0(e,i){return Or(we,function(a){var u="_."+a[0];i&a[1]&&!Ms(e,u)&&e.push(u)}),e.sort()}function Gh(e){if(e instanceof Ye)return e.clone();var i=new Cr(e.__wrapped__,e.__chain__);return i.__actions__=lr(e.__actions__),i.__index__=e.__index__,i.__values__=e.__values__,i}function $0(e,i,a){(a?nr(e,i,a):i===r)?i=1:i=Ht(Me(i),0);var u=e==null?0:e.length;if(!u||i<1)return[];for(var g=0,D=0,A=V(Js(u/i));g<u;)A[D++]=Tr(e,g,g+=i);return A}function L0(e){for(var i=-1,a=e==null?0:e.length,u=0,g=[];++i<a;){var D=e[i];D&&(g[u++]=D)}return g}function M0(){var e=arguments.length;if(!e)return[];for(var i=V(e-1),a=arguments[0],u=e;u--;)i[u-1]=arguments[u];return _i(Ne(a)?lr(a):[a],Gt(i,1))}var j0=Ke(function(e,i){return Tt(e)?Hn(e,Gt(i,1,Tt,!0)):[]}),q0=Ke(function(e,i){var a=Nr(i);return Tt(a)&&(a=r),Tt(e)?Hn(e,Gt(i,1,Tt,!0),me(a,2)):[]}),B0=Ke(function(e,i){var a=Nr(i);return Tt(a)&&(a=r),Tt(e)?Hn(e,Gt(i,1,Tt,!0),r,a):[]});function z0(e,i,a){var u=e==null?0:e.length;return u?(i=a||i===r?1:Me(i),Tr(e,i<0?0:i,u)):[]}function H0(e,i,a){var u=e==null?0:e.length;return u?(i=a||i===r?1:Me(i),i=u-i,Tr(e,0,i<0?0:i)):[]}function K0(e,i){return e&&e.length?aa(e,me(i,3),!0,!0):[]}function V0(e,i){return e&&e.length?aa(e,me(i,3),!0):[]}function k0(e,i,a,u){var g=e==null?0:e.length;return g?(a&&typeof a!="number"&&nr(e,i,a)&&(a=0,u=g),Mg(e,i,a,u)):[]}function Yh(e,i,a){var u=e==null?0:e.length;if(!u)return-1;var g=a==null?0:Me(a);return g<0&&(g=Ht(u+g,0)),js(e,me(i,3),g)}function Jh(e,i,a){var u=e==null?0:e.length;if(!u)return-1;var g=u-1;return a!==r&&(g=Me(a),g=a<0?Ht(u+g,0):Xt(g,u-1)),js(e,me(i,3),g,!0)}function Xh(e){var i=e==null?0:e.length;return i?Gt(e,1):[]}function W0(e){var i=e==null?0:e.length;return i?Gt(e,X):[]}function G0(e,i){var a=e==null?0:e.length;return a?(i=i===r?1:Me(i),Gt(e,i)):[]}function Y0(e){for(var i=-1,a=e==null?0:e.length,u={};++i<a;){var g=e[i];u[g[0]]=g[1]}return u}function Qh(e){return e&&e.length?e[0]:r}function J0(e,i,a){var u=e==null?0:e.length;if(!u)return-1;var g=a==null?0:Me(a);return g<0&&(g=Ht(u+g,0)),ln(e,i,g)}function X0(e){var i=e==null?0:e.length;return i?Tr(e,0,-1):[]}var Q0=Ke(function(e){var i=_t(e,Ho);return i.length&&i[0]===e[0]?Uo(i):[]}),Z0=Ke(function(e){var i=Nr(e),a=_t(e,Ho);return i===Nr(a)?i=r:a.pop(),a.length&&a[0]===e[0]?Uo(a,me(i,2)):[]}),e1=Ke(function(e){var i=Nr(e),a=_t(e,Ho);return i=typeof i=="function"?i:r,i&&a.pop(),a.length&&a[0]===e[0]?Uo(a,r,i):[]});function t1(e,i){return e==null?"":Xp.call(e,i)}function Nr(e){var i=e==null?0:e.length;return i?e[i-1]:r}function r1(e,i,a){var u=e==null?0:e.length;if(!u)return-1;var g=u;return a!==r&&(g=Me(a),g=g<0?Ht(u+g,0):Xt(g,u-1)),i===i?Fp(e,i,g):js(e,Nu,g,!0)}function i1(e,i){return e&&e.length?uh(e,Me(i)):r}var n1=Ke(Zh);function Zh(e,i){return e&&e.length&&i&&i.length?Lo(e,i):e}function s1(e,i,a){return e&&e.length&&i&&i.length?Lo(e,i,me(a,2)):e}function a1(e,i,a){return e&&e.length&&i&&i.length?Lo(e,i,r,a):e}var o1=ui(function(e,i){var a=e==null?0:e.length,u=Co(e,i);return lh(e,_t(i,function(g){return hi(g,a)?+g:g}).sort(Eh)),u});function c1(e,i){var a=[];if(!(e&&e.length))return a;var u=-1,g=[],D=e.length;for(i=me(i,3);++u<D;){var A=e[u];i(A,u,e)&&(a.push(A),g.push(u))}return lh(e,g),a}function ic(e){return e==null?e:tg.call(e)}function u1(e,i,a){var u=e==null?0:e.length;return u?(a&&typeof a!="number"&&nr(e,i,a)?(i=0,a=u):(i=i==null?0:Me(i),a=a===r?u:Me(a)),Tr(e,i,a)):[]}function h1(e,i){return sa(e,i)}function f1(e,i,a){return qo(e,i,me(a,2))}function l1(e,i){var a=e==null?0:e.length;if(a){var u=sa(e,i);if(u<a&&zr(e[u],i))return u}return-1}function d1(e,i){return sa(e,i,!0)}function p1(e,i,a){return qo(e,i,me(a,2),!0)}function g1(e,i){var a=e==null?0:e.length;if(a){var u=sa(e,i,!0)-1;if(zr(e[u],i))return u}return-1}function y1(e){return e&&e.length?ph(e):[]}function v1(e,i){return e&&e.length?ph(e,me(i,2)):[]}function _1(e){var i=e==null?0:e.length;return i?Tr(e,1,i):[]}function m1(e,i,a){return e&&e.length?(i=a||i===r?1:Me(i),Tr(e,0,i<0?0:i)):[]}function b1(e,i,a){var u=e==null?0:e.length;return u?(i=a||i===r?1:Me(i),i=u-i,Tr(e,i<0?0:i,u)):[]}function w1(e,i){return e&&e.length?aa(e,me(i,3),!1,!0):[]}function E1(e,i){return e&&e.length?aa(e,me(i,3)):[]}var D1=Ke(function(e){return Ei(Gt(e,1,Tt,!0))}),S1=Ke(function(e){var i=Nr(e);return Tt(i)&&(i=r),Ei(Gt(e,1,Tt,!0),me(i,2))}),I1=Ke(function(e){var i=Nr(e);return i=typeof i=="function"?i:r,Ei(Gt(e,1,Tt,!0),r,i)});function x1(e){return e&&e.length?Ei(e):[]}function O1(e,i){return e&&e.length?Ei(e,me(i,2)):[]}function A1(e,i){return i=typeof i=="function"?i:r,e&&e.length?Ei(e,r,i):[]}function nc(e){if(!(e&&e.length))return[];var i=0;return e=vi(e,function(a){if(Tt(a))return i=Ht(a.length,i),!0}),wo(i,function(a){return _t(e,_o(a))})}function ef(e,i){if(!(e&&e.length))return[];var a=nc(e);return i==null?a:_t(a,function(u){return Kt(i,r,u)})}var C1=Ke(function(e,i){return Tt(e)?Hn(e,i):[]}),P1=Ke(function(e){return zo(vi(e,Tt))}),T1=Ke(function(e){var i=Nr(e);return Tt(i)&&(i=r),zo(vi(e,Tt),me(i,2))}),N1=Ke(function(e){var i=Nr(e);return i=typeof i=="function"?i:r,zo(vi(e,Tt),r,i)}),U1=Ke(nc);function R1(e,i){return _h(e||[],i||[],zn)}function F1(e,i){return _h(e||[],i||[],kn)}var $1=Ke(function(e){var i=e.length,a=i>1?e[i-1]:r;return a=typeof a=="function"?(e.pop(),a):r,ef(e,a)});function tf(e){var i=E(e);return i.__chain__=!0,i}function L1(e,i){return i(e),e}function ga(e,i){return i(e)}var M1=ui(function(e){var i=e.length,a=i?e[0]:0,u=this.__wrapped__,g=function(D){return Co(D,e)};return i>1||this.__actions__.length||!(u instanceof Ye)||!hi(a)?this.thru(g):(u=u.slice(a,+a+(i?1:0)),u.__actions__.push({func:ga,args:[g],thisArg:r}),new Cr(u,this.__chain__).thru(function(D){return i&&!D.length&&D.push(r),D}))});function j1(){return tf(this)}function q1(){return new Cr(this.value(),this.__chain__)}function B1(){this.__values__===r&&(this.__values__=yf(this.value()));var e=this.__index__>=this.__values__.length,i=e?r:this.__values__[this.__index__++];return{done:e,value:i}}function z1(){return this}function H1(e){for(var i,a=this;a instanceof ea;){var u=Gh(a);u.__index__=0,u.__values__=r,i?g.__wrapped__=u:i=u;var g=u;a=a.__wrapped__}return g.__wrapped__=e,i}function K1(){var e=this.__wrapped__;if(e instanceof Ye){var i=e;return this.__actions__.length&&(i=new Ye(this)),i=i.reverse(),i.__actions__.push({func:ga,args:[ic],thisArg:r}),new Cr(i,this.__chain__)}return this.thru(ic)}function V1(){return vh(this.__wrapped__,this.__actions__)}var k1=oa(function(e,i,a){nt.call(e,a)?++e[a]:oi(e,a,1)});function W1(e,i,a){var u=Ne(e)?Pu:Lg;return a&&nr(e,i,a)&&(i=r),u(e,me(i,3))}function G1(e,i){var a=Ne(e)?vi:eh;return a(e,me(i,3))}var Y1=Ah(Yh),J1=Ah(Jh);function X1(e,i){return Gt(ya(e,i),1)}function Q1(e,i){return Gt(ya(e,i),X)}function Z1(e,i,a){return a=a===r?1:Me(a),Gt(ya(e,i),a)}function rf(e,i){var a=Ne(e)?Or:wi;return a(e,me(i,3))}function nf(e,i){var a=Ne(e)?_p:Zu;return a(e,me(i,3))}var ey=oa(function(e,i,a){nt.call(e,a)?e[a].push(i):oi(e,a,[i])});function ty(e,i,a,u){e=dr(e)?e:Sn(e),a=a&&!u?Me(a):0;var g=e.length;return a<0&&(a=Ht(g+a,0)),wa(e)?a<=g&&e.indexOf(i,a)>-1:!!g&&ln(e,i,a)>-1}var ry=Ke(function(e,i,a){var u=-1,g=typeof i=="function",D=dr(e)?V(e.length):[];return wi(e,function(A){D[++u]=g?Kt(i,A,a):Kn(A,i,a)}),D}),iy=oa(function(e,i,a){oi(e,a,i)});function ya(e,i){var a=Ne(e)?_t:ah;return a(e,me(i,3))}function ny(e,i,a,u){return e==null?[]:(Ne(i)||(i=i==null?[]:[i]),a=u?r:a,Ne(a)||(a=a==null?[]:[a]),hh(e,i,a))}var sy=oa(function(e,i,a){e[a?0:1].push(i)},function(){return[[],[]]});function ay(e,i,a){var u=Ne(e)?yo:Ru,g=arguments.length<3;return u(e,me(i,4),a,g,wi)}function oy(e,i,a){var u=Ne(e)?mp:Ru,g=arguments.length<3;return u(e,me(i,4),a,g,Zu)}function cy(e,i){var a=Ne(e)?vi:eh;return a(e,ma(me(i,3)))}function uy(e){var i=Ne(e)?Yu:t0;return i(e)}function hy(e,i,a){(a?nr(e,i,a):i===r)?i=1:i=Me(i);var u=Ne(e)?Ng:r0;return u(e,i)}function fy(e){var i=Ne(e)?Ug:n0;return i(e)}function ly(e){if(e==null)return 0;if(dr(e))return wa(e)?pn(e):e.length;var i=Qt(e);return i==Ie||i==xe?e.size:Fo(e).length}function dy(e,i,a){var u=Ne(e)?vo:s0;return a&&nr(e,i,a)&&(i=r),u(e,me(i,3))}var py=Ke(function(e,i){if(e==null)return[];var a=i.length;return a>1&&nr(e,i[0],i[1])?i=[]:a>2&&nr(i[0],i[1],i[2])&&(i=[i[0]]),hh(e,Gt(i,1),[])}),va=Gp||function(){return Xe.Date.now()};function gy(e,i){if(typeof i!="function")throw new Ar(m);return e=Me(e),function(){if(--e<1)return i.apply(this,arguments)}}function sf(e,i,a){return i=a?r:i,i=e&&i==null?e.length:i,ci(e,c,r,r,r,r,i)}function af(e,i){var a;if(typeof i!="function")throw new Ar(m);return e=Me(e),function(){return--e>0&&(a=i.apply(this,arguments)),e<=1&&(i=r),a}}var sc=Ke(function(e,i,a){var u=K;if(a.length){var g=mi(a,En(sc));u|=_}return ci(e,u,i,a,g)}),of=Ke(function(e,i,a){var u=K|ie;if(a.length){var g=mi(a,En(of));u|=_}return ci(i,u,e,a,g)});function cf(e,i,a){i=a?r:i;var u=ci(e,b,r,r,r,r,r,i);return u.placeholder=cf.placeholder,u}function uf(e,i,a){i=a?r:i;var u=ci(e,y,r,r,r,r,r,i);return u.placeholder=uf.placeholder,u}function hf(e,i,a){var u,g,D,A,T,M,Q=0,Z=!1,ne=!1,ue=!0;if(typeof e!="function")throw new Ar(m);i=Ur(i)||0,bt(a)&&(Z=!!a.leading,ne="maxWait"in a,D=ne?Ht(Ur(a.maxWait)||0,i):D,ue="trailing"in a?!!a.trailing:ue);function ye(Nt){var Hr=u,di=g;return u=g=r,Q=Nt,A=e.apply(di,Hr),A}function Ee(Nt){return Q=Nt,T=Yn(We,i),Z?ye(Nt):A}function Be(Nt){var Hr=Nt-M,di=Nt-Q,Cf=i-Hr;return ne?Xt(Cf,D-di):Cf}function De(Nt){var Hr=Nt-M,di=Nt-Q;return M===r||Hr>=i||Hr<0||ne&&di>=D}function We(){var Nt=va();if(De(Nt))return Qe(Nt);T=Yn(We,Be(Nt))}function Qe(Nt){return T=r,ue&&u?ye(Nt):(u=g=r,A)}function Er(){T!==r&&mh(T),Q=0,u=M=g=T=r}function sr(){return T===r?A:Qe(va())}function Dr(){var Nt=va(),Hr=De(Nt);if(u=arguments,g=this,M=Nt,Hr){if(T===r)return Ee(M);if(ne)return mh(T),T=Yn(We,i),ye(M)}return T===r&&(T=Yn(We,i)),A}return Dr.cancel=Er,Dr.flush=sr,Dr}var yy=Ke(function(e,i){return Qu(e,1,i)}),vy=Ke(function(e,i,a){return Qu(e,Ur(i)||0,a)});function _y(e){return ci(e,z)}function _a(e,i){if(typeof e!="function"||i!=null&&typeof i!="function")throw new Ar(m);var a=function(){var u=arguments,g=i?i.apply(this,u):u[0],D=a.cache;if(D.has(g))return D.get(g);var A=e.apply(this,u);return a.cache=D.set(g,A)||D,A};return a.cache=new(_a.Cache||ai),a}_a.Cache=ai;function ma(e){if(typeof e!="function")throw new Ar(m);return function(){var i=arguments;switch(i.length){case 0:return!e.call(this);case 1:return!e.call(this,i[0]);case 2:return!e.call(this,i[0],i[1]);case 3:return!e.call(this,i[0],i[1],i[2])}return!e.apply(this,i)}}function my(e){return af(2,e)}var by=a0(function(e,i){i=i.length==1&&Ne(i[0])?_t(i[0],mr(me())):_t(Gt(i,1),mr(me()));var a=i.length;return Ke(function(u){for(var g=-1,D=Xt(u.length,a);++g<D;)u[g]=i[g].call(this,u[g]);return Kt(e,this,u)})}),ac=Ke(function(e,i){var a=mi(i,En(ac));return ci(e,_,r,i,a)}),ff=Ke(function(e,i){var a=mi(i,En(ff));return ci(e,d,r,i,a)}),wy=ui(function(e,i){return ci(e,v,r,r,r,i)});function Ey(e,i){if(typeof e!="function")throw new Ar(m);return i=i===r?i:Me(i),Ke(e,i)}function Dy(e,i){if(typeof e!="function")throw new Ar(m);return i=i==null?0:Ht(Me(i),0),Ke(function(a){var u=a[i],g=Si(a,0,i);return u&&_i(g,u),Kt(e,this,g)})}function Sy(e,i,a){var u=!0,g=!0;if(typeof e!="function")throw new Ar(m);return bt(a)&&(u="leading"in a?!!a.leading:u,g="trailing"in a?!!a.trailing:g),hf(e,i,{leading:u,maxWait:i,trailing:g})}function Iy(e){return sf(e,1)}function xy(e,i){return ac(Ko(i),e)}function Oy(){if(!arguments.length)return[];var e=arguments[0];return Ne(e)?e:[e]}function Ay(e){return Pr(e,R)}function Cy(e,i){return i=typeof i=="function"?i:r,Pr(e,R,i)}function Py(e){return Pr(e,N|R)}function Ty(e,i){return i=typeof i=="function"?i:r,Pr(e,N|R,i)}function Ny(e,i){return i==null||Xu(e,i,Vt(i))}function zr(e,i){return e===i||e!==e&&i!==i}var Uy=fa(No),Ry=fa(function(e,i){return e>=i}),ki=ih(function(){return arguments}())?ih:function(e){return Ot(e)&&nt.call(e,"callee")&&!Hu.call(e,"callee")},Ne=V.isArray,Fy=rr?mr(rr):Hg;function dr(e){return e!=null&&ba(e.length)&&!fi(e)}function Tt(e){return Ot(e)&&dr(e)}function $y(e){return e===!0||e===!1||Ot(e)&&ir(e)==q}var Ii=Jp||vc,Ly=jr?mr(jr):Kg;function My(e){return Ot(e)&&e.nodeType===1&&!Jn(e)}function jy(e){if(e==null)return!0;if(dr(e)&&(Ne(e)||typeof e=="string"||typeof e.splice=="function"||Ii(e)||Dn(e)||ki(e)))return!e.length;var i=Qt(e);if(i==Ie||i==xe)return!e.size;if(Gn(e))return!Fo(e).length;for(var a in e)if(nt.call(e,a))return!1;return!0}function qy(e,i){return Vn(e,i)}function By(e,i,a){a=typeof a=="function"?a:r;var u=a?a(e,i):r;return u===r?Vn(e,i,r,a):!!u}function oc(e){if(!Ot(e))return!1;var i=ir(e);return i==P||i==h||typeof e.message=="string"&&typeof e.name=="string"&&!Jn(e)}function zy(e){return typeof e=="number"&&Vu(e)}function fi(e){if(!bt(e))return!1;var i=ir(e);return i==oe||i==le||i==B||i==gt}function lf(e){return typeof e=="number"&&e==Me(e)}function ba(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=k}function bt(e){var i=typeof e;return e!=null&&(i=="object"||i=="function")}function Ot(e){return e!=null&&typeof e=="object"}var df=xr?mr(xr):kg;function Hy(e,i){return e===i||Ro(e,i,Xo(i))}function Ky(e,i,a){return a=typeof a=="function"?a:r,Ro(e,i,Xo(i),a)}function Vy(e){return pf(e)&&e!=+e}function ky(e){if(C0(e))throw new Pe(f);return nh(e)}function Wy(e){return e===null}function Gy(e){return e==null}function pf(e){return typeof e=="number"||Ot(e)&&ir(e)==ze}function Jn(e){if(!Ot(e)||ir(e)!=Le)return!1;var i=Ws(e);if(i===null)return!0;var a=nt.call(i,"constructor")&&i.constructor;return typeof a=="function"&&a instanceof a&&Hs.call(a)==Kp}var cc=Gr?mr(Gr):Wg;function Yy(e){return lf(e)&&e>=-k&&e<=k}var gf=Fn?mr(Fn):Gg;function wa(e){return typeof e=="string"||!Ne(e)&&Ot(e)&&ir(e)==Ue}function wr(e){return typeof e=="symbol"||Ot(e)&&ir(e)==Re}var Dn=Mi?mr(Mi):Yg;function Jy(e){return e===r}function Xy(e){return Ot(e)&&Qt(e)==Ae}function Qy(e){return Ot(e)&&ir(e)==Fe}var Zy=fa($o),ev=fa(function(e,i){return e<=i});function yf(e){if(!e)return[];if(dr(e))return wa(e)?qr(e):lr(e);if(Ln&&e[Ln])return Np(e[Ln]());var i=Qt(e),a=i==Ie?Do:i==xe?qs:Sn;return a(e)}function li(e){if(!e)return e===0?e:0;if(e=Ur(e),e===X||e===-X){var i=e<0?-1:1;return i*W}return e===e?e:0}function Me(e){var i=li(e),a=i%1;return i===i?a?i-a:i:0}function vf(e){return e?zi(Me(e),0,re):0}function Ur(e){if(typeof e=="number")return e;if(wr(e))return J;if(bt(e)){var i=typeof e.valueOf=="function"?e.valueOf():e;e=bt(i)?i+"":i}if(typeof e!="string")return e===0?e:+e;e=Fu(e);var a=Xa.test(e);return a||Za.test(e)?Te(e.slice(2),a?2:8):Ja.test(e)?J:+e}function _f(e){return Jr(e,pr(e))}function tv(e){return e?zi(Me(e),-k,k):e===0?e:0}function it(e){return e==null?"":br(e)}var rv=bn(function(e,i){if(Gn(i)||dr(i)){Jr(i,Vt(i),e);return}for(var a in i)nt.call(i,a)&&zn(e,a,i[a])}),mf=bn(function(e,i){Jr(i,pr(i),e)}),Ea=bn(function(e,i,a,u){Jr(i,pr(i),e,u)}),iv=bn(function(e,i,a,u){Jr(i,Vt(i),e,u)}),nv=ui(Co);function sv(e,i){var a=mn(e);return i==null?a:Ju(a,i)}var av=Ke(function(e,i){e=ut(e);var a=-1,u=i.length,g=u>2?i[2]:r;for(g&&nr(i[0],i[1],g)&&(u=1);++a<u;)for(var D=i[a],A=pr(D),T=-1,M=A.length;++T<M;){var Q=A[T],Z=e[Q];(Z===r||zr(Z,yn[Q])&&!nt.call(e,Q))&&(e[Q]=D[Q])}return e}),ov=Ke(function(e){return e.push(r,Fh),Kt(bf,r,e)});function cv(e,i){return Tu(e,me(i,3),Yr)}function uv(e,i){return Tu(e,me(i,3),To)}function hv(e,i){return e==null?e:Po(e,me(i,3),pr)}function fv(e,i){return e==null?e:th(e,me(i,3),pr)}function lv(e,i){return e&&Yr(e,me(i,3))}function dv(e,i){return e&&To(e,me(i,3))}function pv(e){return e==null?[]:ia(e,Vt(e))}function gv(e){return e==null?[]:ia(e,pr(e))}function uc(e,i,a){var u=e==null?r:Hi(e,i);return u===r?a:u}function yv(e,i){return e!=null&&Mh(e,i,jg)}function hc(e,i){return e!=null&&Mh(e,i,qg)}var vv=Ph(function(e,i,a){i!=null&&typeof i.toString!="function"&&(i=Ks.call(i)),e[i]=a},lc(gr)),_v=Ph(function(e,i,a){i!=null&&typeof i.toString!="function"&&(i=Ks.call(i)),nt.call(e,i)?e[i].push(a):e[i]=[a]},me),mv=Ke(Kn);function Vt(e){return dr(e)?Gu(e):Fo(e)}function pr(e){return dr(e)?Gu(e,!0):Jg(e)}function bv(e,i){var a={};return i=me(i,3),Yr(e,function(u,g,D){oi(a,i(u,g,D),u)}),a}function wv(e,i){var a={};return i=me(i,3),Yr(e,function(u,g,D){oi(a,g,i(u,g,D))}),a}var Ev=bn(function(e,i,a){na(e,i,a)}),bf=bn(function(e,i,a,u){na(e,i,a,u)}),Dv=ui(function(e,i){var a={};if(e==null)return a;var u=!1;i=_t(i,function(D){return D=Di(D,e),u||(u=D.length>1),D}),Jr(e,Yo(e),a),u&&(a=Pr(a,N|j|R,v0));for(var g=i.length;g--;)Bo(a,i[g]);return a});function Sv(e,i){return wf(e,ma(me(i)))}var Iv=ui(function(e,i){return e==null?{}:Qg(e,i)});function wf(e,i){if(e==null)return{};var a=_t(Yo(e),function(u){return[u]});return i=me(i),fh(e,a,function(u,g){return i(u,g[0])})}function xv(e,i,a){i=Di(i,e);var u=-1,g=i.length;for(g||(g=1,e=r);++u<g;){var D=e==null?r:e[Xr(i[u])];D===r&&(u=g,D=a),e=fi(D)?D.call(e):D}return e}function Ov(e,i,a){return e==null?e:kn(e,i,a)}function Av(e,i,a,u){return u=typeof u=="function"?u:r,e==null?e:kn(e,i,a,u)}var Ef=Uh(Vt),Df=Uh(pr);function Cv(e,i,a){var u=Ne(e),g=u||Ii(e)||Dn(e);if(i=me(i,4),a==null){var D=e&&e.constructor;g?a=u?new D:[]:bt(e)?a=fi(D)?mn(Ws(e)):{}:a={}}return(g?Or:Yr)(e,function(A,T,M){return i(a,A,T,M)}),a}function Pv(e,i){return e==null?!0:Bo(e,i)}function Tv(e,i,a){return e==null?e:yh(e,i,Ko(a))}function Nv(e,i,a,u){return u=typeof u=="function"?u:r,e==null?e:yh(e,i,Ko(a),u)}function Sn(e){return e==null?[]:Eo(e,Vt(e))}function Uv(e){return e==null?[]:Eo(e,pr(e))}function Rv(e,i,a){return a===r&&(a=i,i=r),a!==r&&(a=Ur(a),a=a===a?a:0),i!==r&&(i=Ur(i),i=i===i?i:0),zi(Ur(e),i,a)}function Fv(e,i,a){return i=li(i),a===r?(a=i,i=0):a=li(a),e=Ur(e),Bg(e,i,a)}function $v(e,i,a){if(a&&typeof a!="boolean"&&nr(e,i,a)&&(i=a=r),a===r&&(typeof i=="boolean"?(a=i,i=r):typeof e=="boolean"&&(a=e,e=r)),e===r&&i===r?(e=0,i=1):(e=li(e),i===r?(i=e,e=0):i=li(i)),e>i){var u=e;e=i,i=u}if(a||e%1||i%1){var g=ku();return Xt(e+g*(i-e+ot("1e-"+((g+"").length-1))),i)}return Mo(e,i)}var Lv=wn(function(e,i,a){return i=i.toLowerCase(),e+(a?Sf(i):i)});function Sf(e){return fc(it(e).toLowerCase())}function If(e){return e=it(e),e&&e.replace(ii,Op).replace(lo,"")}function Mv(e,i,a){e=it(e),i=br(i);var u=e.length;a=a===r?u:zi(Me(a),0,u);var g=a;return a-=i.length,a>=0&&e.slice(a,g)==i}function jv(e){return e=it(e),e&&yt.test(e)?e.replace(Ui,Ap):e}function qv(e){return e=it(e),e&&$t.test(e)?e.replace(St,"\\$&"):e}var Bv=wn(function(e,i,a){return e+(a?"-":"")+i.toLowerCase()}),zv=wn(function(e,i,a){return e+(a?" ":"")+i.toLowerCase()}),Hv=Oh("toLowerCase");function Kv(e,i,a){e=it(e),i=Me(i);var u=i?pn(e):0;if(!i||u>=i)return e;var g=(i-u)/2;return ha(Xs(g),a)+e+ha(Js(g),a)}function Vv(e,i,a){e=it(e),i=Me(i);var u=i?pn(e):0;return i&&u<i?e+ha(i-u,a):e}function kv(e,i,a){e=it(e),i=Me(i);var u=i?pn(e):0;return i&&u<i?ha(i-u,a)+e:e}function Wv(e,i,a){return a||i==null?i=0:i&&(i=+i),eg(it(e).replace(It,""),i||0)}function Gv(e,i,a){return(a?nr(e,i,a):i===r)?i=1:i=Me(i),jo(it(e),i)}function Yv(){var e=arguments,i=it(e[0]);return e.length<3?i:i.replace(e[1],e[2])}var Jv=wn(function(e,i,a){return e+(a?"_":"")+i.toLowerCase()});function Xv(e,i,a){return a&&typeof a!="number"&&nr(e,i,a)&&(i=a=r),a=a===r?re:a>>>0,a?(e=it(e),e&&(typeof i=="string"||i!=null&&!cc(i))&&(i=br(i),!i&&dn(e))?Si(qr(e),0,a):e.split(i,a)):[]}var Qv=wn(function(e,i,a){return e+(a?" ":"")+fc(i)});function Zv(e,i,a){return e=it(e),a=a==null?0:zi(Me(a),0,e.length),i=br(i),e.slice(a,a+i.length)==i}function e_(e,i,a){var u=E.templateSettings;a&&nr(e,i,a)&&(i=r),e=it(e),i=Ea({},i,u,Rh);var g=Ea({},i.imports,u.imports,Rh),D=Vt(g),A=Eo(g,D),T,M,Q=0,Z=i.interpolate||sn,ne="__p += '",ue=So((i.escape||sn).source+"|"+Z.source+"|"+(Z===mt?Ya:sn).source+"|"+(i.evaluate||sn).source+"|$","g"),ye="//# sourceURL="+(nt.call(i,"sourceURL")?(i.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++po+"]")+`
`;e.replace(ue,function(De,We,Qe,Er,sr,Dr){return Qe||(Qe=Er),ne+=e.slice(Q,Dr).replace(to,Cp),We&&(T=!0,ne+=`' +
__e(`+We+`) +
'`),sr&&(M=!0,ne+=`';
`+sr+`;
__p += '`),Qe&&(ne+=`' +
((__t = (`+Qe+`)) == null ? '' : __t) +
'`),Q=Dr+De.length,De}),ne+=`';
`;var Ee=nt.call(i,"variable")&&i.variable;if(!Ee)ne=`with (obj) {
`+ne+`
}
`;else if(Wa.test(Ee))throw new Pe(l);ne=(M?ne.replace(kr,""):ne).replace(tr,"$1").replace(ri,"$1;"),ne="function("+(Ee||"obj")+`) {
`+(Ee?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(T?", __e = _.escape":"")+(M?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+ne+`return __p
}`;var Be=Of(function(){return rt(D,ye+"return "+ne).apply(r,A)});if(Be.source=ne,oc(Be))throw Be;return Be}function t_(e){return it(e).toLowerCase()}function r_(e){return it(e).toUpperCase()}function i_(e,i,a){if(e=it(e),e&&(a||i===r))return Fu(e);if(!e||!(i=br(i)))return e;var u=qr(e),g=qr(i),D=$u(u,g),A=Lu(u,g)+1;return Si(u,D,A).join("")}function n_(e,i,a){if(e=it(e),e&&(a||i===r))return e.slice(0,ju(e)+1);if(!e||!(i=br(i)))return e;var u=qr(e),g=Lu(u,qr(i))+1;return Si(u,0,g).join("")}function s_(e,i,a){if(e=it(e),e&&(a||i===r))return e.replace(It,"");if(!e||!(i=br(i)))return e;var u=qr(e),g=$u(u,qr(i));return Si(u,g).join("")}function a_(e,i){var a=G,u=se;if(bt(i)){var g="separator"in i?i.separator:g;a="length"in i?Me(i.length):a,u="omission"in i?br(i.omission):u}e=it(e);var D=e.length;if(dn(e)){var A=qr(e);D=A.length}if(a>=D)return e;var T=a-pn(u);if(T<1)return u;var M=A?Si(A,0,T).join(""):e.slice(0,T);if(g===r)return M+u;if(A&&(T+=M.length-T),cc(g)){if(e.slice(T).search(g)){var Q,Z=M;for(g.global||(g=So(g.source,it(Ir.exec(g))+"g")),g.lastIndex=0;Q=g.exec(Z);)var ne=Q.index;M=M.slice(0,ne===r?T:ne)}}else if(e.indexOf(br(g),T)!=T){var ue=M.lastIndexOf(g);ue>-1&&(M=M.slice(0,ue))}return M+u}function o_(e){return e=it(e),e&&wt.test(e)?e.replace(gi,$p):e}var c_=wn(function(e,i,a){return e+(a?" ":"")+i.toUpperCase()}),fc=Oh("toUpperCase");function xf(e,i,a){return e=it(e),i=a?r:i,i===r?Tp(e)?jp(e):Ep(e):e.match(i)||[]}var Of=Ke(function(e,i){try{return Kt(e,r,i)}catch(a){return oc(a)?a:new Pe(a)}}),u_=ui(function(e,i){return Or(i,function(a){a=Xr(a),oi(e,a,sc(e[a],e))}),e});function h_(e){var i=e==null?0:e.length,a=me();return e=i?_t(e,function(u){if(typeof u[1]!="function")throw new Ar(m);return[a(u[0]),u[1]]}):[],Ke(function(u){for(var g=-1;++g<i;){var D=e[g];if(Kt(D[0],this,u))return Kt(D[1],this,u)}})}function f_(e){return $g(Pr(e,N))}function lc(e){return function(){return e}}function l_(e,i){return e==null||e!==e?i:e}var d_=Ch(),p_=Ch(!0);function gr(e){return e}function dc(e){return sh(typeof e=="function"?e:Pr(e,N))}function g_(e){return oh(Pr(e,N))}function y_(e,i){return ch(e,Pr(i,N))}var v_=Ke(function(e,i){return function(a){return Kn(a,e,i)}}),__=Ke(function(e,i){return function(a){return Kn(e,a,i)}});function pc(e,i,a){var u=Vt(i),g=ia(i,u);a==null&&!(bt(i)&&(g.length||!u.length))&&(a=i,i=e,e=this,g=ia(i,Vt(i)));var D=!(bt(a)&&"chain"in a)||!!a.chain,A=fi(e);return Or(g,function(T){var M=i[T];e[T]=M,A&&(e.prototype[T]=function(){var Q=this.__chain__;if(D||Q){var Z=e(this.__wrapped__),ne=Z.__actions__=lr(this.__actions__);return ne.push({func:M,args:arguments,thisArg:e}),Z.__chain__=Q,Z}return M.apply(e,_i([this.value()],arguments))})}),e}function m_(){return Xe._===this&&(Xe._=Vp),this}function gc(){}function b_(e){return e=Me(e),Ke(function(i){return uh(i,e)})}var w_=ko(_t),E_=ko(Pu),D_=ko(vo);function Af(e){return Zo(e)?_o(Xr(e)):Zg(e)}function S_(e){return function(i){return e==null?r:Hi(e,i)}}var I_=Th(),x_=Th(!0);function yc(){return[]}function vc(){return!1}function O_(){return{}}function A_(){return""}function C_(){return!0}function P_(e,i){if(e=Me(e),e<1||e>k)return[];var a=re,u=Xt(e,re);i=me(i),e-=re;for(var g=wo(u,i);++a<e;)i(a);return g}function T_(e){return Ne(e)?_t(e,Xr):wr(e)?[e]:lr(Wh(it(e)))}function N_(e){var i=++Hp;return it(e)+i}var U_=ua(function(e,i){return e+i},0),R_=Wo("ceil"),F_=ua(function(e,i){return e/i},1),$_=Wo("floor");function L_(e){return e&&e.length?ra(e,gr,No):r}function M_(e,i){return e&&e.length?ra(e,me(i,2),No):r}function j_(e){return Uu(e,gr)}function q_(e,i){return Uu(e,me(i,2))}function B_(e){return e&&e.length?ra(e,gr,$o):r}function z_(e,i){return e&&e.length?ra(e,me(i,2),$o):r}var H_=ua(function(e,i){return e*i},1),K_=Wo("round"),V_=ua(function(e,i){return e-i},0);function k_(e){return e&&e.length?bo(e,gr):0}function W_(e,i){return e&&e.length?bo(e,me(i,2)):0}return E.after=gy,E.ary=sf,E.assign=rv,E.assignIn=mf,E.assignInWith=Ea,E.assignWith=iv,E.at=nv,E.before=af,E.bind=sc,E.bindAll=u_,E.bindKey=of,E.castArray=Oy,E.chain=tf,E.chunk=$0,E.compact=L0,E.concat=M0,E.cond=h_,E.conforms=f_,E.constant=lc,E.countBy=k1,E.create=sv,E.curry=cf,E.curryRight=uf,E.debounce=hf,E.defaults=av,E.defaultsDeep=ov,E.defer=yy,E.delay=vy,E.difference=j0,E.differenceBy=q0,E.differenceWith=B0,E.drop=z0,E.dropRight=H0,E.dropRightWhile=K0,E.dropWhile=V0,E.fill=k0,E.filter=G1,E.flatMap=X1,E.flatMapDeep=Q1,E.flatMapDepth=Z1,E.flatten=Xh,E.flattenDeep=W0,E.flattenDepth=G0,E.flip=_y,E.flow=d_,E.flowRight=p_,E.fromPairs=Y0,E.functions=pv,E.functionsIn=gv,E.groupBy=ey,E.initial=X0,E.intersection=Q0,E.intersectionBy=Z0,E.intersectionWith=e1,E.invert=vv,E.invertBy=_v,E.invokeMap=ry,E.iteratee=dc,E.keyBy=iy,E.keys=Vt,E.keysIn=pr,E.map=ya,E.mapKeys=bv,E.mapValues=wv,E.matches=g_,E.matchesProperty=y_,E.memoize=_a,E.merge=Ev,E.mergeWith=bf,E.method=v_,E.methodOf=__,E.mixin=pc,E.negate=ma,E.nthArg=b_,E.omit=Dv,E.omitBy=Sv,E.once=my,E.orderBy=ny,E.over=w_,E.overArgs=by,E.overEvery=E_,E.overSome=D_,E.partial=ac,E.partialRight=ff,E.partition=sy,E.pick=Iv,E.pickBy=wf,E.property=Af,E.propertyOf=S_,E.pull=n1,E.pullAll=Zh,E.pullAllBy=s1,E.pullAllWith=a1,E.pullAt=o1,E.range=I_,E.rangeRight=x_,E.rearg=wy,E.reject=cy,E.remove=c1,E.rest=Ey,E.reverse=ic,E.sampleSize=hy,E.set=Ov,E.setWith=Av,E.shuffle=fy,E.slice=u1,E.sortBy=py,E.sortedUniq=y1,E.sortedUniqBy=v1,E.split=Xv,E.spread=Dy,E.tail=_1,E.take=m1,E.takeRight=b1,E.takeRightWhile=w1,E.takeWhile=E1,E.tap=L1,E.throttle=Sy,E.thru=ga,E.toArray=yf,E.toPairs=Ef,E.toPairsIn=Df,E.toPath=T_,E.toPlainObject=_f,E.transform=Cv,E.unary=Iy,E.union=D1,E.unionBy=S1,E.unionWith=I1,E.uniq=x1,E.uniqBy=O1,E.uniqWith=A1,E.unset=Pv,E.unzip=nc,E.unzipWith=ef,E.update=Tv,E.updateWith=Nv,E.values=Sn,E.valuesIn=Uv,E.without=C1,E.words=xf,E.wrap=xy,E.xor=P1,E.xorBy=T1,E.xorWith=N1,E.zip=U1,E.zipObject=R1,E.zipObjectDeep=F1,E.zipWith=$1,E.entries=Ef,E.entriesIn=Df,E.extend=mf,E.extendWith=Ea,pc(E,E),E.add=U_,E.attempt=Of,E.camelCase=Lv,E.capitalize=Sf,E.ceil=R_,E.clamp=Rv,E.clone=Ay,E.cloneDeep=Py,E.cloneDeepWith=Ty,E.cloneWith=Cy,E.conformsTo=Ny,E.deburr=If,E.defaultTo=l_,E.divide=F_,E.endsWith=Mv,E.eq=zr,E.escape=jv,E.escapeRegExp=qv,E.every=W1,E.find=Y1,E.findIndex=Yh,E.findKey=cv,E.findLast=J1,E.findLastIndex=Jh,E.findLastKey=uv,E.floor=$_,E.forEach=rf,E.forEachRight=nf,E.forIn=hv,E.forInRight=fv,E.forOwn=lv,E.forOwnRight=dv,E.get=uc,E.gt=Uy,E.gte=Ry,E.has=yv,E.hasIn=hc,E.head=Qh,E.identity=gr,E.includes=ty,E.indexOf=J0,E.inRange=Fv,E.invoke=mv,E.isArguments=ki,E.isArray=Ne,E.isArrayBuffer=Fy,E.isArrayLike=dr,E.isArrayLikeObject=Tt,E.isBoolean=$y,E.isBuffer=Ii,E.isDate=Ly,E.isElement=My,E.isEmpty=jy,E.isEqual=qy,E.isEqualWith=By,E.isError=oc,E.isFinite=zy,E.isFunction=fi,E.isInteger=lf,E.isLength=ba,E.isMap=df,E.isMatch=Hy,E.isMatchWith=Ky,E.isNaN=Vy,E.isNative=ky,E.isNil=Gy,E.isNull=Wy,E.isNumber=pf,E.isObject=bt,E.isObjectLike=Ot,E.isPlainObject=Jn,E.isRegExp=cc,E.isSafeInteger=Yy,E.isSet=gf,E.isString=wa,E.isSymbol=wr,E.isTypedArray=Dn,E.isUndefined=Jy,E.isWeakMap=Xy,E.isWeakSet=Qy,E.join=t1,E.kebabCase=Bv,E.last=Nr,E.lastIndexOf=r1,E.lowerCase=zv,E.lowerFirst=Hv,E.lt=Zy,E.lte=ev,E.max=L_,E.maxBy=M_,E.mean=j_,E.meanBy=q_,E.min=B_,E.minBy=z_,E.stubArray=yc,E.stubFalse=vc,E.stubObject=O_,E.stubString=A_,E.stubTrue=C_,E.multiply=H_,E.nth=i1,E.noConflict=m_,E.noop=gc,E.now=va,E.pad=Kv,E.padEnd=Vv,E.padStart=kv,E.parseInt=Wv,E.random=$v,E.reduce=ay,E.reduceRight=oy,E.repeat=Gv,E.replace=Yv,E.result=xv,E.round=K_,E.runInContext=L,E.sample=uy,E.size=ly,E.snakeCase=Jv,E.some=dy,E.sortedIndex=h1,E.sortedIndexBy=f1,E.sortedIndexOf=l1,E.sortedLastIndex=d1,E.sortedLastIndexBy=p1,E.sortedLastIndexOf=g1,E.startCase=Qv,E.startsWith=Zv,E.subtract=V_,E.sum=k_,E.sumBy=W_,E.template=e_,E.times=P_,E.toFinite=li,E.toInteger=Me,E.toLength=vf,E.toLower=t_,E.toNumber=Ur,E.toSafeInteger=tv,E.toString=it,E.toUpper=r_,E.trim=i_,E.trimEnd=n_,E.trimStart=s_,E.truncate=a_,E.unescape=o_,E.uniqueId=N_,E.upperCase=c_,E.upperFirst=fc,E.each=rf,E.eachRight=nf,E.first=Qh,pc(E,function(){var e={};return Yr(E,function(i,a){nt.call(E.prototype,a)||(e[a]=i)}),e}(),{chain:!1}),E.VERSION=s,Or(["bind","bindKey","curry","curryRight","partial","partialRight"],function(e){E[e].placeholder=E}),Or(["drop","take"],function(e,i){Ye.prototype[e]=function(a){a=a===r?1:Ht(Me(a),0);var u=this.__filtered__&&!i?new Ye(this):this.clone();return u.__filtered__?u.__takeCount__=Xt(a,u.__takeCount__):u.__views__.push({size:Xt(a,re),type:e+(u.__dir__<0?"Right":"")}),u},Ye.prototype[e+"Right"]=function(a){return this.reverse()[e](a).reverse()}}),Or(["filter","map","takeWhile"],function(e,i){var a=i+1,u=a==S||a==ee;Ye.prototype[e]=function(g){var D=this.clone();return D.__iteratees__.push({iteratee:me(g,3),type:a}),D.__filtered__=D.__filtered__||u,D}}),Or(["head","last"],function(e,i){var a="take"+(i?"Right":"");Ye.prototype[e]=function(){return this[a](1).value()[0]}}),Or(["initial","tail"],function(e,i){var a="drop"+(i?"":"Right");Ye.prototype[e]=function(){return this.__filtered__?new Ye(this):this[a](1)}}),Ye.prototype.compact=function(){return this.filter(gr)},Ye.prototype.find=function(e){return this.filter(e).head()},Ye.prototype.findLast=function(e){return this.reverse().find(e)},Ye.prototype.invokeMap=Ke(function(e,i){return typeof e=="function"?new Ye(this):this.map(function(a){return Kn(a,e,i)})}),Ye.prototype.reject=function(e){return this.filter(ma(me(e)))},Ye.prototype.slice=function(e,i){e=Me(e);var a=this;return a.__filtered__&&(e>0||i<0)?new Ye(a):(e<0?a=a.takeRight(-e):e&&(a=a.drop(e)),i!==r&&(i=Me(i),a=i<0?a.dropRight(-i):a.take(i-e)),a)},Ye.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},Ye.prototype.toArray=function(){return this.take(re)},Yr(Ye.prototype,function(e,i){var a=/^(?:filter|find|map|reject)|While$/.test(i),u=/^(?:head|last)$/.test(i),g=E[u?"take"+(i=="last"?"Right":""):i],D=u||/^find/.test(i);g&&(E.prototype[i]=function(){var A=this.__wrapped__,T=u?[1]:arguments,M=A instanceof Ye,Q=T[0],Z=M||Ne(A),ne=function(We){var Qe=g.apply(E,_i([We],T));return u&&ue?Qe[0]:Qe};Z&&a&&typeof Q=="function"&&Q.length!=1&&(M=Z=!1);var ue=this.__chain__,ye=!!this.__actions__.length,Ee=D&&!ue,Be=M&&!ye;if(!D&&Z){A=Be?A:new Ye(this);var De=e.apply(A,T);return De.__actions__.push({func:ga,args:[ne],thisArg:r}),new Cr(De,ue)}return Ee&&Be?e.apply(this,T):(De=this.thru(ne),Ee?u?De.value()[0]:De.value():De)})}),Or(["pop","push","shift","sort","splice","unshift"],function(e){var i=Bs[e],a=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",u=/^(?:pop|shift)$/.test(e);E.prototype[e]=function(){var g=arguments;if(u&&!this.__chain__){var D=this.value();return i.apply(Ne(D)?D:[],g)}return this[a](function(A){return i.apply(Ne(A)?A:[],g)})}}),Yr(Ye.prototype,function(e,i){var a=E[i];if(a){var u=a.name+"";nt.call(_n,u)||(_n[u]=[]),_n[u].push({name:i,func:a})}}),_n[ca(r,ie).name]=[{name:"wrapper",func:r}],Ye.prototype.clone=og,Ye.prototype.reverse=cg,Ye.prototype.value=ug,E.prototype.at=M1,E.prototype.chain=j1,E.prototype.commit=q1,E.prototype.next=B1,E.prototype.plant=H1,E.prototype.reverse=K1,E.prototype.toJSON=E.prototype.valueOf=E.prototype.value=V1,E.prototype.first=E.prototype.head,Ln&&(E.prototype[Ln]=z1),E},gn=qp();Pt?((Pt.exports=gn)._=gn,ct._=gn):Xe._=gn}).call(cs)})(Zc,Zc.exports);var A2=Object.defineProperty,C2=Object.defineProperties,P2=Object.getOwnPropertyDescriptors,Xl=Object.getOwnPropertySymbols,T2=Object.prototype.hasOwnProperty,N2=Object.prototype.propertyIsEnumerable,Ql=(n,t,r)=>t in n?A2(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,Sa=(n,t)=>{for(var r in t||(t={}))T2.call(t,r)&&Ql(n,r,t[r]);if(Xl)for(var r of Xl(t))N2.call(t,r)&&Ql(n,r,t[r]);return n},U2=(n,t)=>C2(n,P2(t));function $r(n,t,r){let s;const o=eu(n);return t.rpcMap&&(s=t.rpcMap[o]),s||(s=`${O2}?chainId=eip155:${o}&projectId=${r}`),s}function eu(n){return n.includes("eip155")?Number(n.split(":")[1]):Number(n)}function R2(n,t){if(!t.includes(n))throw new Error(`Chain '${n}' not approved. Please use one of the following: ${t.toString()}`)}function F2(n){return n.map(t=>`${t.split(":")[0]}:${t.split(":")[1]}`)}function $2(n,t){const r=Object.keys(t.namespaces).filter(o=>o.includes(n));if(!r.length)return[];const s=[];return r.forEach(o=>{const f=t.namespaces[o].accounts;s.push(...f)}),s}function L2(n,t={}){const r=Zl(n),s=Zl(t);return Zc.exports.merge(r,s)}function Zl(n){var t,r,s,o;const f={};if(!b2(n))return f;for(const[m,l]of Object.entries(n)){const w=gp(m)?[m]:l.chains,O=l.methods||[],I=l.events||[],N=l.rpcMap||{},j=Aa(m);f[j]=U2(Sa(Sa({},f[j]),l),{chains:Rc(w,(t=f[j])==null?void 0:t.chains),methods:Rc(O,(r=f[j])==null?void 0:r.methods),events:Rc(I,(s=f[j])==null?void 0:s.events),rpcMap:Sa(Sa({},N),(o=f[j])==null?void 0:o.rpcMap)})}return f}const yp={},Ut=n=>yp[n],Fc=(n,t)=>{yp[n]=t};class M2{constructor(t){this.name="polkadot",this.namespace=t.namespace,this.events=Ut("events"),this.client=Ut("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){if(this.chainId=t,!this.httpProviders[t]){const s=r||$r(`${this.name}:${t}`,this.namespace);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);this.setHttpProvider(t,s)}this.events.emit(Ni.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2])||[]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;t[r]=this.createHttpProvider(r,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||$r(t,this.namespace);return typeof s>"u"?void 0:new Ti(new nn(s,Ut("disableProviderPing")))}}class j2{constructor(t){this.name="eip155",this.namespace=t.namespace,this.events=Ut("events"),this.client=Ut("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(t){var r;switch(t.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return this.handleSwitchChain(t.request.params?(r=t.request.params[0])==null?void 0:r.chainId:"0x0"),null;case"eth_chainId":return parseInt(this.getDefaultChain())}return this.namespace.methods.includes(t.request.method)?await this.client.request(t):this.getHttpProvider().request(t.request)}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}setDefaultChain(t,r){const s=eu(t);if(!this.httpProviders[s]){const o=r||$r(`${this.name}:${s}`,this.namespace,this.client.core.projectId);if(!o)throw new Error(`No RPC url provided for chainId: ${s}`);this.setHttpProvider(s,o)}this.chainId=s,this.events.emit(Ni.DEFAULT_CHAIN_CHANGED,`${this.name}:${s}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}createHttpProvider(t,r){const s=r||$r(`${this.name}:${t}`,this.namespace,this.client.core.projectId);return typeof s>"u"?void 0:new Ti(new nn(s,Ut("disableProviderPing")))}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;const o=eu(r);t[o]=this.createHttpProvider(o,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}getHttpProvider(){const t=this.chainId,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}handleSwitchChain(t){const r=parseInt(t,16),s=`${this.name}:${r}`;R2(s,this.namespace.chains),this.setDefaultChain(`${r}`)}}class q2{constructor(t){this.name="solana",this.namespace=t.namespace,this.events=Ut("events"),this.client=Ut("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){if(!this.httpProviders[t]){const s=r||$r(`${this.name}:${t}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);this.setHttpProvider(t,s)}this.chainId=t,this.events.emit(Ni.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;t[r]=this.createHttpProvider(r,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||$r(t,this.namespace,this.client.core.projectId);return typeof s>"u"?void 0:new Ti(new nn(s,Ut("disableProviderPing")))}}class B2{constructor(t){this.name="cosmos",this.namespace=t.namespace,this.events=Ut("events"),this.client=Ut("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){if(this.chainId=t,!this.httpProviders[t]){const s=r||$r(`${this.name}:${t}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);this.setHttpProvider(t,s)}this.events.emit(Ni.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;t[r]=this.createHttpProvider(r,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||$r(t,this.namespace,this.client.core.projectId);return typeof s>"u"?void 0:new Ti(new nn(s,Ut("disableProviderPing")))}}class z2{constructor(t){this.name="cip34",this.namespace=t.namespace,this.events=Ut("events"),this.client=Ut("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){if(this.chainId=t,!this.httpProviders[t]){const s=r||this.getCardanoRPCUrl(t);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);this.setHttpProvider(t,s)}this.events.emit(Ni.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{const s=this.getCardanoRPCUrl(r);t[r]=this.createHttpProvider(r,s)}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}getCardanoRPCUrl(t){const r=this.namespace.rpcMap;if(r)return r[t]}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||this.getCardanoRPCUrl(t);return typeof s>"u"?void 0:new Ti(new nn(s,Ut("disableProviderPing")))}}class H2{constructor(t){this.name="elrond",this.namespace=t.namespace,this.events=Ut("events"),this.client=Ut("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){if(!this.httpProviders[t]){const s=r||$r(`${this.name}:${t}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);this.setHttpProvider(t,s)}this.chainId=t,this.events.emit(Ni.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;t[r]=this.createHttpProvider(r,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||$r(t,this.namespace,this.client.core.projectId);return typeof s>"u"?void 0:new Ti(new nn(s,Ut("disableProviderPing")))}}class K2{constructor(t){this.name="multiversx",this.namespace=t.namespace,this.events=Ut("events"),this.client=Ut("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){if(!this.httpProviders[t]){const s=r||$r(`${this.name}:${t}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);this.setHttpProvider(t,s)}this.chainId=t,this.events.emit(Ni.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;t[r]=this.createHttpProvider(r,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||$r(t,this.namespace,this.client.core.projectId);return typeof s>"u"?void 0:new Ti(new nn(s,Ut("disableProviderPing")))}}var V2=Object.defineProperty,k2=Object.defineProperties,W2=Object.getOwnPropertyDescriptors,ed=Object.getOwnPropertySymbols,G2=Object.prototype.hasOwnProperty,Y2=Object.prototype.propertyIsEnumerable,td=(n,t,r)=>t in n?V2(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,Ia=(n,t)=>{for(var r in t||(t={}))G2.call(t,r)&&td(n,r,t[r]);if(ed)for(var r of ed(t))Y2.call(t,r)&&td(n,r,t[r]);return n},$c=(n,t)=>k2(n,W2(t));class Au{constructor(t){this.events=new nu,this.rpcProviders={},this.shouldAbortPairingAttempt=!1,this.maxPairingAttempts=10,this.disableProviderPing=!1,this.providerOpts=t,this.logger=typeof(t==null?void 0:t.logger)<"u"&&typeof(t==null?void 0:t.logger)!="string"?t.logger:Ze.pino(Ze.getDefaultLoggerOptions({level:(t==null?void 0:t.logger)||Yl})),this.disableProviderPing=(t==null?void 0:t.disableProviderPing)||!1}static async init(t){const r=new Au(t);return await r.initialize(),r}async request(t,r){const[s,o]=this.validateChain(r);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(s).request({request:Ia({},t),chainId:`${s}:${o}`,topic:this.session.topic})}sendAsync(t,r,s){this.request(t,s).then(o=>r(null,o)).catch(o=>r(o,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties}),await this.requestAccounts()}async disconnect(){var t;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(t=this.session)==null?void 0:t.topic,reason:Vl("USER_DISCONNECTED")}),await this.cleanup()}async connect(t){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(t),await this.cleanupPendingPairings(),!t.skipPairing)return await this.pair(t.pairingTopic)}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}removeListener(t,r){this.events.removeListener(t,r)}off(t,r){this.events.off(t,r)}get isWalletConnect(){return!0}async pair(t){this.shouldAbortPairingAttempt=!1;let r=0;do{if(this.shouldAbortPairingAttempt)throw new Error("Pairing aborted");if(r>=this.maxPairingAttempts)throw new Error("Max auto pairing attempts reached");const{uri:s,approval:o}=await this.client.connect({pairingTopic:t,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties});s&&(this.uri=s,this.events.emit("display_uri",s)),await o().then(f=>{this.session=f}).catch(f=>{if(f.message!==dp)throw f;r++})}while(!this.session);return this.onConnect(),this.session}setDefaultChain(t,r){try{const[s,o]=this.validateChain(t);this.getProvider(s).setDefaultChain(o,r)}catch(s){if(!/Please call connect/.test(s.message))throw s}}async cleanupPendingPairings(t={}){this.logger.info("Cleaning up inactive pairings...");const r=this.client.pairing.getAll();if(m2(r)){for(const s of r)t.deletePairings?this.client.core.expirer.set(s.topic,0):await this.client.core.relayer.subscriber.unsubscribe(s.topic);this.logger.info(`Inactive pairings cleared: ${r.length}`)}}abortPairingAttempt(){this.shouldAbortPairingAttempt=!0}async checkStorage(){if(this.namespaces=await this.getFromStore("namespaces")||{},this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.client.session.length){const t=this.client.session.keys.length-1;this.session=this.client.session.get(this.client.session.keys[t]),this.createProviders()}}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){this.client=this.providerOpts.client||await y2.init({logger:this.providerOpts.logger||Yl,relayUrl:this.providerOpts.relayUrl||S2,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,name:this.providerOpts.name}),this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");const t=[...new Set(Object.keys(this.session.namespaces).map(r=>Aa(r)))];Fc("client",this.client),Fc("events",this.events),Fc("disableProviderPing",this.disableProviderPing),t.forEach(r=>{if(!this.session)return;const s=$2(r,this.session),o=F2(s),f=L2(this.namespaces,this.optionalNamespaces),m=$c(Ia({},f[r]),{accounts:s,chains:o});switch(r){case"eip155":this.rpcProviders[r]=new j2({namespace:m});break;case"solana":this.rpcProviders[r]=new q2({namespace:m});break;case"cosmos":this.rpcProviders[r]=new B2({namespace:m});break;case"polkadot":this.rpcProviders[r]=new M2({namespace:m});break;case"cip34":this.rpcProviders[r]=new z2({namespace:m});break;case"elrond":this.rpcProviders[r]=new H2({namespace:m});break;case"multiversx":this.rpcProviders[r]=new K2({namespace:m});break}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",t=>{this.events.emit("session_ping",t)}),this.client.on("session_event",t=>{const{params:r}=t,{event:s}=r;s.name==="accountsChanged"?this.events.emit("accountsChanged",s.data):s.name==="chainChanged"?this.onChainChanged(r.chainId):this.events.emit(s.name,s.data),this.events.emit("session_event",t)}),this.client.on("session_update",({topic:t,params:r})=>{var s;const{namespaces:o}=r,f=(s=this.client)==null?void 0:s.session.get(t);this.session=$c(Ia({},f),{namespaces:o}),this.onSessionUpdate(),this.events.emit("session_update",{topic:t,params:r})}),this.client.on("session_delete",async t=>{await this.cleanup(),this.events.emit("session_delete",t),this.events.emit("disconnect",$c(Ia({},Vl("USER_DISCONNECTED")),{data:t.topic}))}),this.on(Ni.DEFAULT_CHAIN_CHANGED,t=>{this.onChainChanged(t,!0)})}getProvider(t){if(!this.rpcProviders[t])throw new Error(`Provider not found: ${t}`);return this.rpcProviders[t]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(t=>{var r;this.getProvider(t).updateNamespace((r=this.session)==null?void 0:r.namespaces[t])})}setNamespaces(t){const{namespaces:r,optionalNamespaces:s,sessionProperties:o}=t;if(!r||!Object.keys(r).length)throw new Error("Namespaces must be not empty");this.namespaces=r,this.optionalNamespaces=s,this.sessionProperties=o,this.persist("namespaces",r),this.persist("optionalNamespaces",s)}validateChain(t){const[r,s]=(t==null?void 0:t.split(":"))||["",""];if(r&&!Object.keys(this.namespaces).map(m=>Aa(m)).includes(r))throw new Error(`Namespace '${r}' is not configured. Please call connect() first with namespace config.`);if(r&&s)return[r,s];const o=Aa(Object.keys(this.namespaces)[0]),f=this.rpcProviders[o].getDefaultChain();return[o,f]}async requestAccounts(){const[t]=this.validateChain();return await this.getProvider(t).requestAccounts()}onChainChanged(t,r=!1){var s;const[o,f]=this.validateChain(t);r||this.getProvider(o).setDefaultChain(f),((s=this.namespaces[o])!=null?s:this.namespaces[`${o}:${f}`]).defaultChain=f,this.persist("namespaces",this.namespaces),this.events.emit("chainChanged",f)}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.session=void 0,await this.cleanupPendingPairings({deletePairings:!0})}persist(t,r){this.client.core.storage.setItem(`${Jl}/${t}`,r)}async getFromStore(t){return await this.client.core.storage.getItem(`${Jl}/${t}`)}}const J2=Au,X2="wc",Q2="ethereum_provider",Z2=`${X2}@2:${Q2}:`,eS="https://rpc.walletconnect.com/v1/",tu=["eth_sendTransaction","personal_sign"],ES=["eth_accounts","eth_requestAccounts","eth_call","eth_getBalance","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode"],ru=["chainChanged","accountsChanged"],DS=["message","disconnect","connect"];var tS=Object.defineProperty,rS=Object.defineProperties,iS=Object.getOwnPropertyDescriptors,rd=Object.getOwnPropertySymbols,nS=Object.prototype.hasOwnProperty,sS=Object.prototype.propertyIsEnumerable,id=(n,t,r)=>t in n?tS(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,Lc=(n,t)=>{for(var r in t||(t={}))nS.call(t,r)&&id(n,r,t[r]);if(rd)for(var r of rd(t))sS.call(t,r)&&id(n,r,t[r]);return n},nd=(n,t)=>rS(n,iS(t));function iu(n){return Number(n[0].split(":")[1])}function Mc(n){return`0x${n.toString(16)}`}function aS(n){const{chains:t,optionalChains:r,methods:s,optionalMethods:o,events:f,optionalEvents:m,rpcMap:l}=n;if(!Vc(t))throw new Error("Invalid chains");const w=t,O=s||tu,I=f||ru,N={[iu(w)]:l[iu(w)]},j={chains:w,methods:O,events:I,rpcMap:N},R=f==null?void 0:f.filter(ie=>!ru.includes(ie)),U=s==null?void 0:s.filter(ie=>!tu.includes(ie));if(!r&&!m&&!o&&!(R!=null&&R.length)&&!(U!=null&&U.length))return{required:j};const H=(R==null?void 0:R.length)&&(U==null?void 0:U.length)||!r,K={chains:[...new Set(H?w.concat(r||[]):r)],methods:[...new Set(O.concat(o||[]))],events:[...new Set(I.concat(m||[]))],rpcMap:l};return{required:j,optional:K}}class Cu{constructor(){this.events=new Lr.EventEmitter,this.namespace="eip155",this.accounts=[],this.chainId=1,this.STORAGE_KEY=Z2,this.on=(t,r)=>(this.events.on(t,r),this),this.once=(t,r)=>(this.events.once(t,r),this),this.removeListener=(t,r)=>(this.events.removeListener(t,r),this),this.off=(t,r)=>(this.events.off(t,r),this),this.parseAccount=t=>this.isCompatibleChainId(t)?this.parseAccountId(t).address:t,this.signer={},this.rpc={}}static async init(t){const r=new Cu;return await r.initialize(t),r}async request(t){return await this.signer.request(t,this.formatChainId(this.chainId))}sendAsync(t,r){this.signer.sendAsync(t,r,this.formatChainId(this.chainId))}get connected(){return this.signer.client?this.signer.client.core.relayer.connected:!1}get connecting(){return this.signer.client?this.signer.client.core.relayer.connecting:!1}async enable(){return this.session||await this.connect(),await this.request({method:"eth_requestAccounts"})}async connect(t){if(!this.signer.client)throw new Error("Provider not initialized. Call init() first");this.loadConnectOpts(t);const{required:r,optional:s}=aS(this.rpc);try{const o=await new Promise(async(m,l)=>{var w;this.rpc.showQrModal&&((w=this.modal)==null||w.subscribeModal(O=>{!O.open&&!this.signer.session&&(this.signer.abortPairingAttempt(),l(new Error("Connection request reset. Please try again.")))})),await this.signer.connect(nd(Lc({namespaces:{[this.namespace]:r}},s&&{optionalNamespaces:{[this.namespace]:s}}),{pairingTopic:t==null?void 0:t.pairingTopic})).then(O=>{m(O)}).catch(O=>{l(new Error(O.message))})});if(!o)return;this.setChainIds(this.rpc.chains);const f=Ew(o.namespaces,[this.namespace]);this.setAccounts(f),this.events.emit("connect",{chainId:Mc(this.chainId)})}catch(o){throw this.signer.logger.error(o),o}finally{this.modal&&this.modal.closeModal()}}async disconnect(){this.session&&await this.signer.disconnect(),this.reset()}get isWalletConnect(){return!0}get session(){return this.signer.session}registerEventListeners(){this.signer.on("session_event",t=>{const{params:r}=t,{event:s}=r;s.name==="accountsChanged"?(this.accounts=this.parseAccounts(s.data),this.events.emit("accountsChanged",this.accounts)):s.name==="chainChanged"?this.setChainId(this.formatChainId(s.data)):this.events.emit(s.name,s.data),this.events.emit("session_event",t)}),this.signer.on("chainChanged",t=>{const r=parseInt(t);this.chainId=r,this.events.emit("chainChanged",Mc(this.chainId)),this.persist()}),this.signer.on("session_update",t=>{this.events.emit("session_update",t)}),this.signer.on("session_delete",t=>{this.reset(),this.events.emit("session_delete",t),this.events.emit("disconnect",nd(Lc({},Sw("USER_DISCONNECTED")),{data:t.topic,name:"USER_DISCONNECTED"}))}),this.signer.on("display_uri",t=>{var r,s;this.rpc.showQrModal&&((r=this.modal)==null||r.closeModal(),(s=this.modal)==null||s.openModal({uri:t})),this.events.emit("display_uri",t)})}setHttpProvider(t){this.request({method:"wallet_switchEthereumChain",params:[{chainId:t.toString(16)}]})}isCompatibleChainId(t){return typeof t=="string"?t.startsWith(`${this.namespace}:`):!1}formatChainId(t){return`${this.namespace}:${t}`}parseChainId(t){return Number(t.split(":")[1])}setChainIds(t){const r=t.filter(s=>this.isCompatibleChainId(s)).map(s=>this.parseChainId(s));r.length&&(this.chainId=r[0],this.events.emit("chainChanged",Mc(this.chainId)),this.persist())}setChainId(t){if(this.isCompatibleChainId(t)){const r=this.parseChainId(t);this.chainId=r,this.setHttpProvider(r)}}parseAccountId(t){const[r,s,o]=t.split(":");return{chainId:`${r}:${s}`,address:o}}setAccounts(t){this.accounts=t.filter(r=>this.parseChainId(this.parseAccountId(r).chainId)===this.chainId).map(r=>this.parseAccountId(r).address),this.events.emit("accountsChanged",this.accounts)}getRpcConfig(t){var r,s;return{chains:((r=t.chains)==null?void 0:r.map(o=>this.formatChainId(o)))||[`${this.namespace}:1`],optionalChains:t.optionalChains?t.optionalChains.map(o=>this.formatChainId(o)):void 0,methods:(t==null?void 0:t.methods)||tu,events:(t==null?void 0:t.events)||ru,optionalMethods:(t==null?void 0:t.optionalMethods)||[],optionalEvents:(t==null?void 0:t.optionalEvents)||[],rpcMap:(t==null?void 0:t.rpcMap)||this.buildRpcMap(t.chains.concat(t.optionalChains||[]),t.projectId),showQrModal:!!(t!=null&&t.showQrModal),qrModalOptions:(s=t==null?void 0:t.qrModalOptions)!=null?s:void 0,projectId:t.projectId,metadata:t.metadata}}buildRpcMap(t,r){const s={};return t.forEach(o=>{s[o]=this.getRpcUrl(o,r)}),s}async initialize(t){if(this.rpc=this.getRpcConfig(t),this.chainId=iu(this.rpc.chains),this.signer=await J2.init({projectId:this.rpc.projectId,metadata:this.rpc.metadata,disableProviderPing:t.disableProviderPing}),this.registerEventListeners(),await this.loadPersistedSession(),this.rpc.showQrModal){let r;try{const{WalletConnectModal:s}=await Y_(()=>import("./index.es-1c00e085.js").then(o=>o.i),["assets/index.es-1c00e085.js","assets/index-6e351ba0.js","assets/index-beb0ac43.css","assets/index-c5029c40.js","assets/index-8e8f804b.js"]);r=s}catch{throw new Error("To use QR modal, please install @walletconnect/modal package")}if(r)try{this.modal=new r(Lc({walletConnectVersion:2,projectId:this.rpc.projectId,standaloneChains:this.rpc.chains},this.rpc.qrModalOptions))}catch(s){throw this.signer.logger.error(s),new Error("Could not generate WalletConnectModal Instance")}}}loadConnectOpts(t){if(!t)return;const{chains:r,optionalChains:s,rpcMap:o}=t;r&&Vc(r)&&(this.rpc.chains=r.map(f=>this.formatChainId(f)),r.forEach(f=>{this.rpc.rpcMap[f]=(o==null?void 0:o[f])||this.getRpcUrl(f)})),s&&Vc(s)&&(this.rpc.optionalChains=[],this.rpc.optionalChains=s==null?void 0:s.map(f=>this.formatChainId(f)),s.forEach(f=>{this.rpc.rpcMap[f]=(o==null?void 0:o[f])||this.getRpcUrl(f)}))}getRpcUrl(t,r){var s;return((s=this.rpc.rpcMap)==null?void 0:s[t])||`${eS}?chainId=eip155:${t}&projectId=${r||this.rpc.projectId}`}async loadPersistedSession(){if(!this.session)return;const t=await this.signer.client.core.storage.getItem(`${this.STORAGE_KEY}/chainId`);this.setChainIds(t?[this.formatChainId(t)]:this.session.namespaces[this.namespace].accounts),this.setAccounts(this.session.namespaces[this.namespace].accounts)}reset(){this.chainId=1,this.accounts=[]}persist(){this.session&&this.signer.client.core.storage.setItem(`${this.STORAGE_KEY}/chainId`,this.chainId)}parseAccounts(t){return typeof t=="string"||t instanceof String?[this.parseAccount(t)]:t.map(r=>this.parseAccount(r))}}const SS=Cu;export{SS as EthereumProvider,DS as OPTIONAL_EVENTS,ES as OPTIONAL_METHODS,ru as REQUIRED_EVENTS,tu as REQUIRED_METHODS,Cu as default};
